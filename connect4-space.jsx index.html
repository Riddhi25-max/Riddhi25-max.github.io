import { useState, useEffect, useCallback, useMemo, useRef } from "react";

const MILKYWAY_IMG = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAQDAwQDAwQEBAQFBQQFBwsHBwYGBw4KCggLEA4RERAOEA8SFBoWEhMYEw8QFh8XGBsbHR0dERYgIh8cIhocHRz/2wBDAQUFBQcGBw0HBw0cEhASHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBz/wAARCAK8BXgDASIAAhEBAxEB/8QAHQABAQEBAQEBAQEBAAAAAAAAAAIBAwQFBwYICf/EAE4QAAICAQIDBAIKDgkDBQEBAAABAhEDBBIFITEGE0FhIlEUFVJUcXORsbLRByMyMzRCU3J0k5Sh0uEWJDU2VYGSs8ElYqNjgqLw8SZD/8QAGQEBAQEBAQEAAAAAAAAAAAAAAAECAwQF/8QAHxEBAQEBAQADAQEBAQAAAAAAABEBAhIDIUExUQQi/9oADAMBAAIRAxEAPwD/AJ/gAAAAAAAAAAAAABcMrxxnFJVJU7QEAAAAAAAAHWOWK088bxRcpNNT8UZmxxxySjNTTSdo5gAAAAAAAADrLUZZYY4XOTxRdqN8kzkAAAAAAAAAAAAA2nV1yfiYAAAAAAAAAAAAAAAAAAAA9Oh12Xh+bvcVXVNNcmjzADtqtTPWZ55slb5eo4gAAAAAAAAAXh++w/OR7uP/ANt8Q+On854cP32H5yPdx/8AtviHx0/nJ+j5wAKAAAAAAAAOmF445YvLFyxp80nTIlTk9qajfJMwAAAAAAAAAAbtk4uVPauTZgAvFj72ahujFvo5dCABU4SxycZJqS5NMk9ia1C7nN6OePKM5cr8n9Z5Zwljk4yTUlyaYEn1dP8A3d1v6Ri+jM+XGLk6SbfkffwcL1vtBrI+xc256jE0tj5rbMD+fBWTHPFJxnFxknTTVEpW6XUAlbpdTpmwvBJRk1uq2l+L5M78tCvB6l/+P+fzHkbt2+oAAAACljbg52qTrqBIAAAAAAAAAAAAAAAAAAAAAAAALyrGpLu5Nql1XiQAAAAAAAAAAAAAAAAAAAAAAAAAAAA6QilB5Ny3RaqL8TmALy5HlySm6TfqRAAAAAAAAAAAAAAAAAAAArGlLJBPo2gJB7uM6fHpeK6zBijtx48soxXqSZ4QAAAAAAAABUJyxyUoumvEkAa22227bMNo2gMo0GpFgw1IpRNCMUTTth1EsMMsIqLWRbXcbr4DiFAbQoQYCqASvOACKAAAAAAAAAAAAAAAAGxi5SUVVt1zMAF5sTwZZY5NNxdcnaIp1fgD6unS/o9rX4+yMX0ZgfKAAAAAAAAAAAAAAAAAAAAAAABTyScFBt7VzSJAAAAAAAAAAAHWOeUcEsKUdsmm3XP5QOQAAAAAAAAAAAAAAAAB6ceOGoxqEFtzx6L3f8wPMA1Tp9QBeH77D85Hu4//AG3xD46fznhw/fYfnI93H/7b4h8dP5yfo+cACgD091DBi3ZVeSa9GHqXrZ5gAAAAAAAABSxtwc7VJ11JAAAAAAB0WfJHFLEptY5O3E5gADYycZKUXTXNMwAXkyzzTc5ybk+rZ9XhXD8nHZrDTTx1eaui9T/4Pj9T9R7O8PXD+F4YU1kmt87VO2B24fwbR8NglhxR3Vzm+bZ9eH4Dl/Pj8zP6Hsn2VnxeXs3Pjc+H4Z1OMX6UvgR+66P7EOq1OHQ5tNwHFPRajR5dTjtRucIOKcqfN/dfDzA/ytreG6XiGPZqMMZrwdc1/mfwnGODy4DN5MalOM3UMjXKH8z997Ydj1o45uI8PwuGgg1GUZPnfS1fgfnvEtFDiGizaefSceT9T8APyRu3b6grJjliyShJNSi6aaokAAAAAAAAAAAAAAHXFijkhllLLGDgrSf4xyAAAAAAAAAAAAAds2olmhihJRSxraqVWcQAAAAAAAAKioNS3Np1ypEgAAAAAAAAAAAAAAAAAAAAAAHbURwxmlhnKcNqtyVc/EjK8bku7i0qXV+JAAA7aeWGM288JThtdKLrn4HEAAAAAA6PBkjjWV45LG+kq5M5n1M3GpZuGx0fdRVJJyvwR8sugACAAABeH77D85EF4fvsPzkB7+0P9ucQ+Pn8580+l2h/tziHx8/nPmgDpgzywTcoqLbTXpKwscXhlN5IqSaSh4s50ABtCgMNo03awJo0rabSCJo1RKBVZSNNo1RCJNoqjQJ2NdV8ptFynKbuTt9CQQoFY1Ft720q8EZQisBtARHkABFAAAB0UsXcyTjLvbVO+VHMAAAAAAGuLSTaaT6GHbLqHlio0lQHEAAAAAPq6f8Au7rf0jF9GZ8o+rp/7u639IxfRmB8oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdO11AA9fLWrwWpX/k/n85z02jz6vL3WHFKc/Ul0Gj02TV6nFgxfdzlS8vM/TuG8Nx8Pw7VUssq35K5yZN2K/ltD2K1E3GWfPHG7TUYq3/AJns472NzZuIavNh1EXKeWUtslVc/Wf3vCuAcR4u3LSaWeSEesukflZ6OL9nuJaLdq82lmtPkbkprmq866GPX2sfhmt4fqeH5NmoxSg/Bvo/8xCEdLFZMiTyvnCD8PN/UfqGs0WLXYXjyxTXVOuj9Z+Z8X0OXh+uy4csnJ3am/xl6zWbUeOc5ZJOUm3J822SAaQAAAAAAABsYuclGKbk3SS8Ss2GenySx5IuM4ummQnTtGylKcnKTbk+bb8QEnFv0U0vMwAAFV8+gAH1VqODUr0Wrv8ASI/wD2Rwb3lrP2iP8B8oAfV9kcG95az9oj/APZHBveWs/aI/wHygB9eGo4Nvj/UtZ198R/gP1bHPSOEaxZapf/6L6j8SP0vsvxKOu4Zjg2llwrZJfMwP9K/YnzwhpuD5VqNLi0mLUJ5e/wATyqC329yTVqvA/e+IcP7S63tjotdodbpMnZjJp8+WcMOkkseaClj7yccW+3BtwbSkt22Tp36X+J+znaPLwbMsWVznw/JK8uFP7r/7+8/XcH2WMEMeneLjGrxaTFgnh7pSmlBTabhS5U9v7gP6T7L+sxanXce1OHX8P1Ginja7zSYHixze1J7U5Px+Hmf5q36X8ll/1r6j+g7VdrHxfJkwaLvMPD5Pc8b/ABpeL8vgP4fjPEIcN4flzSa3VUU/FgfxHFM/CPbHVbtHq3LvJW1qI0+f5p5PZHBveWs/aI/wHy5Nyk2+rdmAfV9kcG95az9oj/APZHBveWs/aI/wHzs2GWCSjJxbaT5OzmB9X2Rwb3lrP2iP8B83K4PJJ44yjjb9FSdtL4SAALninjjGUotKStN+JBrk2km20unkBgAAAAAupskoyaTtLxRgAAAADvpNJPWZZY4NJqEp8/VFNv5jgAAAAG8tr5PcYABWOKm2nJR5XzJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG7ZOLlT2rk2YdFnyRwyxKbWOTtxA5gAAAAAPThyRywWHM6ivuJ+5/kcsuGWGbhNU1+8Dn1OmKLjngmmmpK0yYtwkpRdNdGdo5J5tTGc25SclbYHr7QL/AK5xD4+fznzaPqdoI3xviHx8/nPnbQJNSbOkMbnJRjG5Pkkj0zlHSwePG1LLJVOa8PJAePabtRtG0UVOONRhsbcmvStdCCtptERFG7SwVWbRRptBGA3aVtEEG0VRoE7TdpVCgJo0qhRRIO+TFGEcbWSMnJW0vAAfKABlQAAAABaytYpY6VN3dcyAAAAAAAAXjxyyzUIK5PovWQE6drqAap0+oPXy1y8FqV/5P5/OeRqnT6gD6un/ALu639IxfRmfKPr6eEv6Pa30X+EYvD/tmB8gBquoAF5MU8W3eqclaXkeiEI6SKyZEnlfOEH4eb+o4LfqMvOVzk+rYHMGtbW16jAAAA64pYVDKskJSm16DTqmcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFRhKf3MW/gRJ6dLxDVaHd7G1GXDu67JNWBx7nJ7iXyDucnuJfIe72/4p/iGp/WMe3/ABT/ABDU/rGT7Hh7nJ7iXyDucnuJfIe72/4p/iGp/WMe3/FP8Q1P6xj7H2+xWhc9Xnzzi7xxSScfX4/uP0rgHCvbfi+m0knthkl6TfLkub/cfwPY3juszajUYc2rzzk4qUd020q6/OfovZ3i/sLjGlzauTyadSqak7ST5X/kY6rWP9MfY9+x7pnosut1uWWDsvp28c54pJzxTq7d/iW1b51fqtquO9g9Nq+x2h4nwbUPPwmOnxx1+TJKPOclzjjfik3T9XTrdOwfHezWr0ep4NxLQ6OPCdQ3OfEY4FPI/R544vqk6XpLpzrnzWcY4x2Z4L2M0HCuFaDS6nT6nBjyajU5MH2zST6ySk+bTfPy5+HTy/db/H+bO2HA8fBOMTw6fnp8kVOCu6T8PlPzTttoXPBp9So+nGWx1Hm0/P8AyP1PtnxnFq+MzWgko6fFFQ3Y3Sk/Fn5v2x43q9NpcGPHqc0Mk5XcZNcl/wDp6eaxr8/7nJ7iXyDucnuJfIe72/4p/iGp/WMe3/FP8Q1P6xnT7ZeV6PNHDHLs9GTarxOfc5PcS+Q9/wDSDin+Ian9YzPb/in+Ian9Yx9jwSxyirlFpeaNnNSjFKKTSpteJ6NVxTW62ChqNVmywTtRnNtWeQoAAAAAAAAAAAAAAASt0uoBK3S6n09Hq58FyrJjd6l9Y3yivU/M8/LQrwepf/j/AJ/MeRu3b6gfpfDe1Gh10Ep5Fhy1zjN0v8mf0WPJF6HK9yrfHx8mfiR9fTzl/R7W+k/wjF4/9swP7riHaLQcPi92ZTmuWyHN2fw3EeKy45mffPu2n9qV+ivJ/WfHbvqAKnCWOTjJNSXJpknrhOOriseRpZVyhN+Pk/rPNOEscnGSakuTTAkAAAAABTUdiab3XzVEgAAAAAA6KOLuZNyl3tqlXKjmABUISm6irfUlVavofV4ji0WHT4ZaWd5H1qV2q8QJ4F+GZf0fN/tyPBiyvBljkik3F3zVo9/AvwzL+j5v9uR8xlRspOUnJ1bd8jACKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFzxxhGDU1JyVtLwAgAAAAAAAAAUB0wZI4c0JyxrJGLtxl0ZE2pSbUVFN3S8BRtASbRtG7WBNGl7TaAimz1YpxywWHM6S+4n7n+RwPdwnh8uJa7FgSe1u5P1LxA9HDezuq4hllFJQxw6zfT/L1n9ZouyOgwOPeKWafLm3ST8qPs6fT49LhhhxRUYRVJI/tezfYLVcb0q1mTPHBgd7eW6TryA/POM9l+H6vWamWyWPJLI5OUZdefmfx3FezOp4c1KH27E3ScVzXwo/fONfY/1ODQy4lg1EcsXF5Zwa2tLry9Z/DZManGUJxtPk0wPyyTWli8eNp5XynNeHkvrPNtPr9oOF+1muagmsOT0ofUfJAUDaN2lRJeFwWSLyRcoXzSFG0FTJJye1NR8LG0o2giaNK2m7QIo2i9pu0CNpqiXtNoojabtLoATtNo02gJoFbWBB8gAGVAAAAAAAAAAAAAAAAE6drqfV0mhycalGONJai+cvCS9b9TPlH6X2X4bHQ8MxzaTy5lvk/mRNDhvZfQ6GCc8azZa5ymrX+SP6HHjitDlW1Vvj4eTPr9nezuXjOZZcqnDh8JVlzJfc//AH9x+t4PsUYZ49P3XB9Xl0mXBPN3qjNqag0nO1ypX+8xuj/OXEOzug4hF7sKhN898OTs/huIcKlwPM+9XeNv7U69F+b+o/du1PZR8IyZM+i7zNw+L2vI/wAWXivP4T+I4zw+HEtBlwyS3VcW/Bms0flU5SyScpNuT5tsyipJxbT6rkYWrCgKNoLGA2hQIwG0KBGCjaFAiaFG0BSJoFChUiTpgxxy5oQlkWOMnTk+iIowqNmlGTSakk+q8TAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD1cP1s+H6zFqIdYPmvWvFH6hotZj12COXG3TXNPqvhPy+EI6WKyZEnlfOEH4eb+o6aHi+r4fnllxZXcn6SfNSM7lV+68D7YcS4Ji9j4Zxyad9MeRWlfqO/Ge2fE9XgloFOGLTxTxtY1TkvNn5boe22KbjHU6eUZ8lcOab/4PXxvtjg02u1WPHgnPJDJKL3Ol1Mefta+3mzQ0+OWTJKoo/M+OcSfFNfPNTjBejCL6pDiXHNXxSS72dQi7UI8kjhy1q8FqV/5P5/ObzIjyFSUEo7W2652iWqdPqDSAAAAAAAAAAAAAAAAAAAF48ksU1ODqS6P1EAA3bt9QAAPq6f+7ut/SMX0Znyj6un/ALu639IxfRmB8oAAdIyxdzJOMu9tVK+VGZMs8u3e7cVSfkQAOmTHGEYNZFJyVtLwOYAAAAAAAAAAAAdMeGWWOSScUoK3bo5g75sKUVlxNvE/X1i/UwOAAA+nwL8My/o+b/bkfMZ9PgX4Zl/R83+3I+YwgCmo7E03uvmqJSt0uoUNUkk04p3+465cUcMFGTbzPm0ukV6vhOIAAAAAAAAAAAAAAAAAAAAAAAKeNqCnapuuoEgAAAAAAAAG0BgK2m0BNDaXRtATtFF0KAnabRVDaB6dHw/Lrt/dywx29e8yxh87PX7Qar8rpP2nH9Z81RNoD6P9H9V+V0n7Tj+s1dntV+V0n7Tj+s+aAPprs/qfyuk/acf1n9N2Q4JkwZdTknLTudJJxzxlS8ejP4bmf0nY/V9zrcmCTSWaPL12gP1nstwuGo47o46nbLCpbnGDUm6V1Suz/VHYLQ8E4ZwrX9qtVo9Tq3pXKGTRS0OSWGcFHnLco7VNXyvly59U1/kXg3E58H4np9ZjVvFK2vWvFfIf6X+xt9kzJgg9Q4LV8FcnP2unkpd6lSnLzXKlzXR9aoP6DiWm4F2o+x/w/j+HRanRPQYcWGGLFocmzPJPbKeSaW276c/DnzdL/NXb3huKPHJZdKlCOaCnKM6hz6ck69R+9dqfsj5cnZjQw0uOOg0GHTYo6zDHJy1UoKlJ+G7p8PK+ir/N3anjr7Q8WyapRccSSjji+qigP43tZwaep0uGSlgWSM6TlmiuVebP5P2g1P5TSftOP6z7XbDVLbg0yau98vWvUfydFH1F2d1jg5qel2Lk37IhXzk+0Op/K6T9px/WfPTltcbe1+AUREr6HtBqfymk/acf1nHVcLzaPGp5JYGm6+15ozfyJnn2m0BG01RKo0CdptGm7WUZQLeJxdSTT8zVEQc6N2s6JFKIHPYbtOm03ahRz2o2vI6UAOe3yB0AH8+ADKgAAAAAAAKxweSagmk36zGqlT8HzowAfVWn4NSvW6u/0eP8Y9j8G9+6z9nj/GfKAH1fY/Bvfus/Z4/xj2Pwb37rP2eP8Z8ovFieWTSaVK+bA+pDT8G3x/rus6+94/xn6rjhpVCNZctUvxF9Z+KK7P1Ds9xBcQ4XhlbeSC2Tt27RnR/o37FGCE9PwfF7H0uXSZdQll7/ACvEprfT3NJ0q8T964hxDtLou2Oi0Oh0Wkx9mcenz4pzw6uTx4YOWPvIRy7LUE1BNqL27pK1Xo/417KdqZ8Il7Cz5HDh+adzlFelH4Gfumj+y9qtNh0OHTcexQ0Wn0eXTY7cbhCbi3G3zX3Pw8jnuKfZe0eLTa7j2mw6Hh+n0UMbfd6XO8uOD2pva3FePwcz/NezS/lcv+hfWf13a/tetZHLw/h+Vz0E2pSlJc760r8D8/4lrIaDRZs8+kI8l634GsxH8NxPT8IfEdU5azVKXeStLTxpc/zjy+x+De/dX+zx/jPmZJyy5JTk25Sdtsk6Nx9X2Pwb37q/2eP8Y9j8G9+6v9nj/GfKo2gsfU9j8H9+6v8AZ4/xnzcqgskljk5Y0/RclTa+AmhQIwG0KBGA2hQIKLabSbS6mFwyzxxlGMmlJU/MgEZRlFAkRINoygkY0YUY0VIwABAAAAAAAAAAAAAAAAAAAAAAAAA9OLu8GNZZVPI/uIdUvN/UeYtuHdxSi9983YGTnLJJyk25Pm2yQALw/fYfnI93H/7b4h8dP5zw4fvsPzke7j/9t8Q+On85P0fOCdO11AKPVKUdXByk1HPFW2+Smvr+c8oAAAAAAAAAAAAAAAAAAAAAAAAAA+rp/wC7ut/SMX0Znyj6una/o9rV4+yMX0ZgfKAAAAAAAAAAAAAAAAAAA6Yc0sMrVOL5Si+jRzAHfNhio97it4n8sX6mZptJm1mRY8GOU5P1I9nBdHm12sWHFW1r093Tafoeh0GHh+COLDBJLq/FsuZU3X8zwPsrroZpZMjxw3YcsdrfNXBo+TrOzHENInLu1lilbeN3+4/VuH8O1efdlxabLPHtlHdGDauuh49Rps2lyPHnxTxzXWM1TNeUr8dcWnVO/Uenlo169Q//AIfz+Y/uON8EjqYy1OmjGOrjHk/X/M/PpWpO+t8zO5Fzaxu3b6gAigAAAAAAAAAAAAAAAAB11GKOGajDLHInFO4/MByAAA2LUZJtJpPo/EwAdM2SOXLKcYKEW+UV4HMUbQGApRNoCaN2l0bQEKJW002gJo0qjaAijaKo0CaNoqjdpRNAvaNpBFG0XtNoojabRdCgJo66eWTHnxyxX3kZJxr1mRhKclGKuT5JI9Mq00XCDTyvlKa8PJAf3PC+LY9fBwlKK1EPu4p8v8j7ej12p0WTdps+TFJ8m4SatH5JByxyUoScZLmmj7ei7Sa7DKMZSjkVpLeuaIP0fimv1Wpzzx5tRlyY8cmoxlJtRXkfD4hxLDw/FuySW6XKMfWz4PHO0etjxHV4sbhBQyyVpc2rP5zLlnmm55JynJ+MnYHTX5c2o1eTJn++Sfh0rwPNtPTjyRyQWLK6S+5n7n+Rznjljm4yVNFRzo01RZSgWCDaZ3y6aenko5IOLaun6ia8gVzUClAvabtAhRKSKo7ZcsZwxxjjjBxVNr8YDnknPM05ybaVcydqNFAKBu03aIJFFqJu0sKijdpdCgVG0HSvIAfzIAMKAAAAAOmF445YvLFyx3zSdMiVOT2pqN8kzAAAAHWMsK084yhJ5m1tlfJI5AADUYUFD7HCuIZOBzWa23kq8N9V63/weKEI6WKyZEnlfOEH4eb+o88pSnJyk25Pm2yLH6lw/jGk4lBPDlW6rcHyaPrw/Asv58fmZ+LKTi7Tafkff0/E9b7QayXsrNuWfEk975Kpkh5f3Gs4jpdBDfnzRivVfN/5H8Nxfi0uPTcMblCMHcMbfKf8z4k5zyycpycpN223ZKdO11LmLmQ206fUHr5a1erUr/yfz+c8u2nzK0wFUKCxNCi6FAiKFF0KBEAujKBEijaFBImjCgBINaPVCenWllGUftvwBI8bRhRjRIjGiTtkwZcUYynjlGMuabVWcmgzrAAVAAAAAAAAAAAAAAAAFPG1BTtU3XUkAAAAAAAA6xli7iScJPM2qlfJI5AXh++w/OR7uP8A9t8Q+On854cP32H5yPdx/wDtviHx0/nJ+j5wBc8jnGKaVRVKkUQAAAAAAAAAAAAAAAAAAAAAAAAAAAt1XgAB0lLF3MUoy723bvlRzAAAAAAAAAAAAAAe7T8Wz6bFHFCGncY9HPBCT+VoDwg+n7e6n8lpP2bH9Q9vdT+S0n7Nj+oI+YD6ft7qfyWk/Zsf1D291P5LSfs2P6gP6nsfo1h4fLO0t2aXVepH6L2Q7NrtBrMiyylHT4Y3Jxq230R/GdmuKy1PCsbrDui2pKOKKSd/AfpX2Pddgnq9VptRLZPJFSg4vYnXVcqvqdeWdfuPBfseZdRwTDPiOeHDJyy6dafG8fLNilljHvI9OStcvrTf8z9kL7HmWWbuc3PQPdLR62MK9kVytX+L8/J9Kb/uMmPs/wBu+ynDsGfiOo0GPh+bT4ms2tnKWVuag5wUntUFFt8l8iXP5v2Q+NcK1OfT8OhnzynwyM1k1L1mWeLMvdQ3SdKlz+Hx5N9tzI5Zu1/lnU6eel1GXBkVZMcnGS80fmvafRrScVybUlHKt6S8z9W4jxHv9fqcuKMe7nklKO6Cbq/Fn5/2q43lx8SWPHHTy2QSluwQbT/zR5+nbH8gD6ft7qfyWk/Zsf1D291P5LSfs2P6jCvmA+n7e6n8lpP2bH9Q9vdT+S0n7Nj+oD5gO+q1eTWZFPJHGmlX2uCgvkSOAUAAAAAAAAAAArGoNve2lXgSbQGCiqNpgTRqRSibQE0VRooDKNNUStoE0bRVG0BNG0UomqJYIo3adFE1RAhRN2l0bQEUKOm03aBzo3adNooojabtLo2hBFCi6N2iC45FixVC1kl91L1L1I40XtKURBzLxL7ZD4UbtOmKH2yHwofQ9HG1fGNf8dL5zyxwp4pTc0pJ1t8WfQ41H/q+u+Ol854tpEclA7xmpY9mRN19y11Xl8BNG0WiFE3aUVDHLI6im2CJk3J3JtvpzBri02mqaN2gSC1E7ZO6cMaxwkpJek2+rLCvPRu0ujaBUbTdpdCgiaNryLUTdoEUbRe02gOe03adKFARtBdAD+SABhoALyKCktjbVeKAgAAAAAAAAA1AEdcUpYpRybE14blys5nTvZvGsbk9kXaRGsZKUpycpNuT5tswArTrpnijng88ZSxJ+koumz6eLb7Q69wTUfZOKk/VUz5J9XT/AN39b+kYvozJqvlG0XLG8bSdc1fJmJFUVp2uR0y5HmkpSS3VTa8fNkG0BgKoATR2lhisEMiyxc5Npw8UcwBlCjQBNAoASZRVGUBLRjRZjQECUGkm01fNeZrRU8s8kYxlJtRVLyCOQTpp+o1owJr6fE+My4hpsWJ4ow2c20+rPlFEk1mMZhRJU0AAQAAAAAak5NJdWXqMGTS58mHLHbkxycZL1NGYfvsPzke7j/8AbWv+On85P0fOABQAAAAAAAAAAAAAVjltnGT6J2enimqhreI6rUY01DLklNJ9abPIAAAAAAAAAAAAAAAAAAAAAAAAAOuDBLPNxi4ppN+k66HIAAAAABeJwWSLyRcoXzSYEA2VOT2pqPgmYAAAAt44rFGe9OTdbfFEAAAAAAAAAAAAAASt0uoH9D2W4tHQ6mWDNKsOXo30Uj++hNxalF8+qaPyrlol69Q//h/P5j6/Ce1OfQxjhzx73Cuj/GRrNTcfu+i+yFqJ6aOn1GlhknCpb4y22o8+n+R8jtH2v1PaBRxPHHDp4vcop22/Nn8ZwrtLw/VTdZJRl3c24yi7SUWfN1nbDR4U1gUs0q5cqRv19Mx9nX67Fw/TTzZZUl0Xi2fmGr1M9ZqcmfI7lN2ezW8b1Ou1He5WnCq7v8WjyZsMVHvcVvE/li/Uznu1rMcADU3Fpp00RRpxbTVNGFTnLJJyk7k/EkAAAABc8U8cYSlCUYzVxbXVXXL5AIANVpp+oDAXOW+Tk6t+oygMo2ilE1JIDIVvW5Nx8UhtV8uhQoDEkjSlE3aBFFKJVADZVJ2oqPLwMo2jVEDKFFqJSiBCiUolpG0USom0UolvG4pNp0+hRzpmqJdChFSom15FqJu0pEUKOiiUogclHyN2nZROueUcs044440klSA8qiUoHTabQ+yuew3aXRu0REbUKL2jaSCaKx/fIfCjdpeOP2yHwoQejjX9ra346Xznho+lxmP/AFbW/Gy+c8W1CDnRtF0bRYiKKi3F3FtP1lbRQGSbnJyk7bMoujdoE0KL2lJBHNRK2l0KAnabRQAyhRtG0FYDaNAk2jQUZQNAg/jwAc1AAAAAA2KUpJNqKb6vwNgouaU21HxaMdW66AXnxxxZZwjNTjF0pLozmAANRhQXAoxdTSY0GoworQfW06//AJ/W/pGL6Mz5SPraf+7+s/SMX0ZgfMAKCgAAAAlWAAIQAAIAApAACjGjCjGVEtEtFksCSWUYwjDGaAykx9TTGTGdYACoAAAC8eSWKanF80dsuKOWDzYVSX3cPc/yA44fvsPzke7j/wDbWv8Ajp/OTw7her12WLwYZSinzl0Xynv7S8J1mn4nrc88Eu6nlk1Jc1Vkv2Pgg74cMdry5bWJfLJ+pEZszzTtpJJVGK6JFGY4KcmnJRVXbIOjxxWKM96cm62+KOYAAAAAAAAAAAAAAAAAAAAAAB0x4MmWM5Qg5Rgrk14HMAAAAAAAAAAAAAAAAAAAAAAAtZWsUsdKm76cyAAAAAAAAAAAAAAAAAB6uWjXr1D/APh/P5jygA3bt9QAB9PgX4Zl/R83+3I+Yz6fAvwzL+j5v9uR8xhA6Yc0sMrVOL5Si+jRzKjJRUk4p2ur8ArrmxRUVlxO8Tdc+sX6mcAAAAoADaNoDKPtcdjijpeELFJyh7G6tU73ys+Oos+vxWP9S4R+jv8A3JkHx6OkKSknFO1yb8CoQUlJuSVLo/EmgMUUXKEoKLcWlJWm11M2nfJny5oY4ZJuUcaqKfggPPRqiXQKMUTQaogYC9pqQEbSqKo1RAlIpRKUSkiiVEpI9MMsVgcHH0mcaLBKRVFKJSiFiEiqbq/AtRKUCjmomqJ1UDdoVzUSlE6UKLERSNo6bTVEQc6G06qJu0o5bTdp6tPppaibjFxTSb9J10Oe0Djt9Ru067TdpBy2jaddo2gc9psVtafqZ0o2iIanLLV6jLnmkpZJOTrpbOO07bTNoHPb5FUVQoImgol0BBNG0bRrVCEZQFG0BgoqgBlG0AWFADYxc5KMU3J9EhBgNprwFFRgNoUSjAbQFH8cADm0AAAXPDPHGEpRaU1ab8SDXJtJNtpcl5AYAABbUO7TTe++aogACiUUTVxqNMRpcaF1KMXU0NNXQ6rJOON41JqEmm43ybX/AOnNdCgrUaYjtHT5ZYJZ1BvFFpOXqYHIAEXA1Iw1dCK2gAAAAGUZ0KMYFZcryyTaSaVclRAANAAaZSYzWYwJZjNZgRIACakx9DWY+hMZ1gAKyuGNzjNpqoq3bIPVo9Xi02/vNJi1G7p3jkq+Ro9Xtrpf8J0n+rJ/ESj5Z9nszw+Wu4jFu+5xrdPz8jl7a6X/AAnSf6sn8R/T9j+KaXJl1OKOh0+KbSaUXPml8LJ1uxcfoPZTsnn7QazFptPB4sUnthKML3S8IpeL8j19q+yOq4LOGXJGWSGaCyzTg08alzV+Tvkz+7+xlx7RT0q4d32TT6icJQ3xjFrTXK+9Vxb5eTTvxR6+2HG9Hw3s5ptBm1mbVZ3p+Wdwj9vcor0X6O70fuecnyXKuh5N769R1mR/lbtdw32JqMefHGsE1W1dIs/mz9F7X8S02DSYYT0eDJKU7UZOfRLryZ/He2ul/wAJ0n+rJ/Eerndjlr5YPqe2ul/wnSf6sn8Rw1etw6nGo49DgwNO92NybflzbNVHiABQOuWWJwxrHGSkl6Tb6s5AAAAAAAAAAAAAAAAADVKUU0m0pcnXiYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvE4LJF5E3C+aQH0OBfhmX9Hzf7cj5jPqcEr2dl2ppdxmq/i5HywgDaFBWG0akUokE0ak2VSRoB4nFRbTSlzT9Yo9GDKtrxZVeJ+rrF+tGZdO8MqbTi+cZLo0BwPrcVj/AFLhH6O/9yZ8/Hilkkowi5SfJJKz7XF9DqYaDhcpYMijDA1JuL5fbJAfCUTaFM9WLDHHBZsytP7iHuv5AeaUJRSbTSkrV+Jh1yTllm5zdt/uMoCFErabRtFGUbRqiUogTReOMXL020q8CoVGcW4qSTun0Z11E45s88kMcccZO1CPRAcEjUitpSiBKiXsceqo1RZ1k5ZGnJ21yKrkolKJaiVRSpUClEpRKUSwQkUkWom7SrEUaonRRKUSjmomqJ1UDdvkUc0jVE67Slibg5cqXLqBy2G7S9ptCEc9pu0uhQiRG03aXtG0QiKHdtR3VyfKzpRbyZHjWNyeyLtIhHCmKOlGUEQ0ZR9nPwKeHhkdZ3sXaTca8GfK2k/pHOhRdCgIoFAiJBQAkFAqMoUejVZoajIpQwxxJRS2x8a8TgKMo2gCAXiyzwZI5McnGceaaIAGyk5ycpO5Pm2zDLFlGmWYBBtgwCD+PABzaAAAAAA6yjhWnhJTk8zb3RrkkcgAAAAokpDVxqNJRRMaF1KJKK01Fo5otMKpFqclBwUntbtq+TOZqYGgAigAIVtiy1LF3Mk4y721TvlRzCtsWYANswAAACoAGNlRhjNJbAx9TGDGEYAGESYzTGRnWAArIAAB7+GZp6HPDW3tjjfL/v8AJHjxbN67y9nil1ZubNLNJN0orlGK6JAfpPBu1unnkhPHqJaXUL1y2v8AyZ6+0PanT4dTk9kaqWeeNuEYKW5pJ9PI/LMblLNjbd80e3jy/wCta/46fznPxlX0vjGtlxjK9XH7mK2vH4wX/KPlHTFklhmpwdNfvKzPHKW7HFxTVuPqfkdMxK4goUEqQbQoFYDaMCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKnBwdOul8mSAAAAAAAAAANoDBRVGpNkHs4Tnx6bUznllti8OSKdeLg0v3s8VFKJQEKLKUUbRSiBJtFUe7BwjX6nEsuHR5smOXSUYNpgeBRNo+l7QcU94an9Wzf6P8U94an9WwPmn1+BaGXE8/secZPTrnKS/E+A5rs/xP3hqf1bP7XsvwTU6Th+6emyRyZJNtOFNeQo9Wg4Xg0WOOLT4lfS6uUj7nEOGavBptPLNpcsIRjtblBpJ23XyH6N9jLslj1ctPlep0uHiGbI1B6rIowhBdbvp48/gP03iHB+AcU0fGMPCOK4pajSZF7Jjq5QitndwUlDnUpbt6VWqXXped0f5A4pwDTapSzwxVmim1GPJTfmfw2d5JZZd6mpp00+VeR+69quAx4bxbJDRJ5dNNKcNj3bfI/L+0PZ7W+2U54dHmlHIlJ7cbpMtH8tRqifT9oeJe8NR+rZvtFxL3hqP1bLR81RNUT6XtFxL3hqP1bPNqNJn0k1DPhnim1aU1ToDhRtGqLZSgBFFKJ0USlEohQLUTaKSAlIpIpIpRNZipopRKUS1EqoUS1EtRRSiUqYwTavki544KbUG3HwbNUSqLBCj5FKJSRqRYsSom7S0ilEo50KOuw3agOaibsOlG0Ucthuw6UKA50ZtOtGUSIhRDiWKsIjaZRdBoiEs2WWJYnkk8a6RvkjnRVGEEtcxXkUCCKMKZjQRgAIAACBjYswADLMLB7+HZdLjlP2RFO1ybVnjyuMsk3BVC+S8iDpmwZMElHJFxbV0/UFcwAKQOmnlijmg80XLEn6Si6bOVixRU3Fyk4pqN8k/UCbAH8gADmoAAANacW01TXgXjWNxyb5SUkvRSXVgcwAAAAA1GACikSaiNY01GArWO2nxxzZoQnkWOMnTk+iMklGUoqSkk6teJzTNCrTNITKTCqTNJAFAyxYGgWbGLkm0rS6iDAAIAFhSp2AAnNzk26t+okDWzDLMbANkthsBAk1swIGM0kIEs1jogzrAAEACqAyjQbRYisP32Hwo+jxrYuOcQ3ptd7Po/Nnz8XLJB+CaPbxqcMvF9bOElKEssmpJ2mrJ+j59CiqNKiKFFgCKMouhQEApoygJowoEWpAaoBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2UVF0pJ/AYAAAAAAAAAAAAAAADaNoCaNopRbKUSCEilEo2gJSSNKUTaAlIpRNFAKBW01RAmi4ynFUpyS9SYNoDe9ye7l8pve5Pdy+UzaVtCne5PykvlP7fsprXm0DwuXp4pdOfRn8Son0uGaiXDMsdU7rooJ1v/kEf6O+xt27zcEng02PVR0mpxZN2LUyqox8V8Pw+s/VONdvtNo+HcUnoMOm4Xk1OReyMscjb1Me7hcH4u3GUr5u5P1u/8maHjel1sItZFjyPrCTp3/yfZ1upjDT6aWTKlDZzcpcvumZg+n2n47Lj3FcmpinDCltxx9SR+WdoNdLUcSybZvbjWxNWfZ4l2iwRUsGC57k4vJF1t+D1n8tkwPHLm7T5qXrKOfeZPdy+U1Tye7l8pqiUolVilP3cvlDTlzbb+Fl7TaAhRKpG0btCMBaiUolEKJaiUolKJVSolpWUolJFEqJaiakUkVWUikjUi1E1glIpRLUSkiqhQKUUVRu0omjaKoUUTRtFCgMoUVRu0BhxxyZIxlNQTf3T8CZRSk0naXivEpoygIoHSjGgiAVtMaAmjGUCCGYUyTLLGYazCDGYa+hj6BEgGNkCzLMsx8wNswBppJtPn0KAMswguUXB1JNPrTRkpym7k2305lZs+TUSUsk3KSSVv1HOwUBlmWBVmWTuM3BF2DnuAH8sADDQam4tNOmjABU5yyScpO5PxJAAAAAAAAAA1M0k1Mi4pM0k1MNNNTMBVqhZNlWFbZVkALV2aRYsCxbV8+pNi/MCgTfmL8wKFkWLAqzLMswFbZgMsI0xswBAAlsIN2AY2E3TqYzX6jAyAFABQRSRWRI2jRQA2jaNoqJoUXQoCaMo6UZQEUKLoygIMoujGgqGiWjoS0QSS0W0YFSACKAAAAAAAAAAAAAB1zxxRmlhlKUaVuSrmcgAAAAAAAAAAAAAAAAAAAAAAADaAwUVRqi2SiaNSPRHSylp557jti1Fpvnz8jmBKiakkUkaogSaol0AMUTTaNUQJNUWVRtAYom0aolKIVNHeGecdNPAlHZOSk248+XmQom7SCFEpRKo0DFE2jVFlKAHTHjjCCy5Faf3MPdfyInKWWblJ22UomqIEKFH0+I29HwxW/vD+nI8O1H0eI/gnDPiH9OQHzFE74pxUe7yc8b+WL9aOZtFRWTE8Uq5NPmmujRBW0pRAijVEtI7ZIYlDG8cpOTXpJrowrgomqJaRVAQoFKJaRqRUSkUkbRSiBiRVGpFKJpWJFpGpUUkVWbSkjUVRoEjaCRSRpWI02itoE0btKSNoCaNo2jaKJo2jQBlCjQEY0S+pTIYHTJnllhji1FKCpUqOTNMkyIwkWYwMZJrZLMoM6afLHDNynijkTi1UvDzORLZBrZDYbJCDZlmN2Y2QaY2LMAFzyzyRjGUm1FUvI52Y2KKMslyJcgi2yXIlsywKcibJszcBdmWQ5GbgOlg57gFfzoAMKAAAAAAAAAAAAAAAA1M0k1MkWqjbaSVs0yE3CSlF00G2223zYarQZZcIqcknJRT8WUTZthqm1d+ZgWqsEgKoEiwKBNiwKBIA2xZgCUAFgoLMswlQAMbEZ3RswAqAAA1Gg1FRqRRiNCNSNSCKSKgkbRqRVATRtGgQZQo0CDKJosAc2iWj04HhjN99CUo06UXXPwODQENGFMlgS0SWyWRUswoki4AAKAADphwyzycYuKaTfN0cwAAAAAAAAABbxNYo5LVN1V8yAAAAAAAAAB0w5I4pNyxxmmmqZzAAAAADaNoDplwxxwxSjljNzVtL8U5UdFjk4uVeivEKJBCRSiUakBKVG0UolUBKid8GWGLHmjLDGbnGlJ/i+ZyNSbAwFKJVASompIqjVEKmjaLUSlEghRNUS6NAlRNoqmUoARRqjZ0USlEUc1ApROiijR9iFEpRRpqiIMBSiVtAij6XEI/1ThnxD+nI8SR9HiCvScN+Jf05FHzFE1RLUSlEghI1ROiibQEKJqiWAMo2jaNSKiaNUSkikiqlRLSNSNSAJFJUEikjQxItIGoqlFJGIpKy4No1A1Uao0Ho1OKOPDppRVOcG5ebtnnBW2aSC4VQMsWVa0GWLBWmNlyni7mKUZd6m7d8qOTYQbMMbolyIKbJbswxsBZjYslsiDZDZrZDkRG2S2Y2S2Qa2S2Y2S2QbYslsxyFRVmNkOTJbJBbkS2S2ZZUVZlkOQjc5KKq2658grWzHIrPilgyzxyabi6uLtHIUinIyzDLRKNBqnDu5Jxe++Tvkc9zBVg535gD4YAMqAAAAAAAAAAAAAAAAAABZtmACgTZtki1VizAFqgSBVqgTYsUUCbFiigSBSqsyzAEpYFmWIVplmAqUAAQAAA1dTDUBpSJKXUrKjUYUUai0iUWgjUAai4CRoKCJBQBUUYU1RjAwlooxkVDRDOj6kASSyjGRcQYzWYwrAARQAAADpLBKOGOVuO2Taq+YHMAAAAAAAAAAAAAAAAG0aoiiTaL2mqPkSqijVE6KJu0ghRNryLoqmBCTqvA1RL2m7UBFCjoo+Ru1gc1E3adNhuwUc0jaOuw3YKOaiaonTabQo57SlEujVFgRRpagUogc1FstRouilElEJFKJQoQAUolKJSI2lKJSRSiKIUTu9NKOCGZuO2TaSvn8hKiUokHNRKUS1E2gJUTaKNoomjTaNSEE0bRe01RAijdrLo2hRCiUolCgMSKoUaUZRptGqJUEjaNSBVDUhRqKrUUiaNKLRpFm2Ue7Vwk9Lo5U9qx03/AO5njPfqdRkjotLhU2sUoW4+t7mfPbKmNBNm2VWgkWBVktmORLdlFNpGORNlZczyyTaSpVyVASZZhSxt45ZE1SddeZKJbMbJciXIVFNkORjZLkRGtktmWS2QaS2GyHIlFNk2Q5EuRBbkS5Etk3ZUU2Y5DLCeJpTTTavmc7FIpyMswyyUaCXIlsC3IxyIciXMC2zNyObbMAtzM3EmWKK3ME2BR8oAGVAAAAAAAAAAALyQUJJKSkqu0QABsYuclGKbk+iRheLLPBkjkxycZxdpoCOgNlJzk5Sbcm7bZgAAAAAAFgAbYswAbYswBa2xZgBW2LMAStswAAAAAN2tRUqe18rMAAAAdo5oR088TxRc5STWTxXkcQANRhqBrUUupJS6lZUikSUVFrqUiEWgNKXQk7abBLUzcIuKaTl6TroUQjTOhoTQABGMw1sJpSW5NxvmkFQYzrmeOWWTxRccd8k2cmTVSyH1LfUhgS+pjNMZFxD6mM19TGNVgAIoAAAAAAAAAAAAAA2jVEUSbRaiWokquaiaonVQKUCUclHyKUTqoFrH5Eo4qPkbtZ3WMpYyVY4KBSh5HoWItYh6I8qgyljPUsRqx+RPSx5VjK7vyPUsfkUsfkT0R5Nnkb3bPX3Xkb3Y9EeTu2b3bPX3Q7oeiPN3YWM9XdeTHdfCPRHm7s3YejuvJjui+iOG0bTv3XkO7FSOG02jv3Y2FI40dnDF3MWpS723ca5JDYbtLSOSiUol7SlEUQkakWolJASolKNFUAhQNSNSAyjaKUSkiiFE3aXRtEolRNoqhQE0bRVG0BNCiqNoomjaNAGUbQBQNRhrVFGlEphMDs8Mo4Y5bjtk6q+ZPUmzLKK6MtVJUvuvnOTZidFF2bZUU87Sivtnzntw8OVJ5Xz9SKbsc9Y/tGi+Kf0meTcfd1eixTwaZU1WOk0/+5ny8+hljdxdw8W/AtTNx54rc+ok1fLp85Mpqqj0+cmy1VNmWbDHPJGcoxbUFbrwOdiqqxZG4zcKKsxyIciXIDo5EORLZLkEXZLkS2TYKpybJbMbJciVFNkuRDkS5EFORDZLkS5AW5IlsmzCUa2ZZlmOREXKTk7bt+ZLkQ2S5FFtkuRDkTYFuZltkn0+HcTwaPTZceTDulLo66+TG6PmAlytslyILszcQ5GNgW5GbiLMsEXuBAA8IAIoAAAAAAAAD18P00NXnljm2ksc58vXGLa+Y8gAAAAAAFOr8Aa5ycVG/RXgBgAAAAAAABSitje5Wn0JAAAAAAAAAAAAAAB0ebJLFHE5N44u1E5gAAAAAAA1dTABRSJNRWVmolHZ4JRwRzNx2ybVXz+QCUWmc0UmVHQdDIy2tNeBeTI8s3N1b9SAxM0kWVFWCbFgVZIAqhLYbMbIMbJYbMbAwlmslkVhjNJZFwAAUAAAAAAXDI4RkklUlTtEAAakWokoiilEtRLUSVUKBSid4YXNSaa9FX1NjjJRyUC1A7RxHWOInpY86xlrEemOI6RxeRn0seaOLyLWI9ccLZ0jgM+ljyLF5FrF5Hsjh8josJneljxLCylgPcsBaweRPax4FhLWHyPesBSwE9LHgWHyNWHyR9BYPJlLB5E9EeJqTxxhUaTvpzJ7k+h3Pkb3PkPR5fP7kdyfQ7nyHc+Q9kfP7ljuWfQ7nyHc+Q9JHz+5ZT001BTaexukz29z5B43SXgvAvsj5/dGd2e/ufIl4vIvojw92zNj9R7u6MeE16SPFs8jNp7Hi8iXjLnSR5dvkK8j0d2Y8ZrNSOFeQo7bDNhakc6NSL2m7TWCVEpI2jQAo1I2gjEi4wcmklbfRIFY8ksU1ODakujQEVRpspOTbbtvqzCwAACAAAAAKAAALAKmhV2TZllF2dI913Mm5S72+SrlRWLV4seNRlpMWRr8aTlb+Rl+zsPvHB8svrKleYyz1ezsPvHB8svrHs7D7xwfLL6ylenhmFbXla59FyP7bst2XfGX7J1O+OhjPY5Q5u/qP5fQavFPTxrS4lXJpOXL95+1/Yq7QaPQY9DnyZc0fY2VxlgwxhKVu6cVNP4efqN85jn3ut7Q/Yqx8P4flyZ9Fm023IsWGUHue5wjNRav/vv/APD8g4pw3NwvW5tHqYrvIOn4po/1Fly4Oz+m49nz8dya/Hr593ixYlCS09whK3ug6irUfRUfuFyr7n/P3bjX4M3G5QhWoeKChLJJ+PWlResxjjdfmurx9xnlFdOqOFn1eJa/AtRt9h4ZNLnbl9Z4nr8PvHB8svrMPRjzrI4ppN0+T8yXI9Ps7D7wwfLL6zPZ+D3hg+WX1lHmciXIrPmjmmpRwwxKqqN1+9nGwVbkiXImzGxSqbMshzIciDo5EuZzcjHIC3IlyIciXIIpyJbJsyyUVZhLkS5kFtkuRzcyXJlR0ciHMkCjW7MMslyILsxshyJbAtyJcibMsCmzLJsxyAoyybMArcZuMAo22DLAo8oBsYuUlFVbdcyKwF5sTwZZY5NNxdcnaIAAAAAAPo8F/C8nxGX6Ej5x9Hgv4Xk+Iy/QkfOL+AACAAAAAA6YFjllgssnHG3zaVsiSipPa243ybMAAGpNukrbE4OEnGSpoDAAAAAAAAdY4ovTzyPLFTi0lDxZyAAAAAAAAAAAAAAXhWOWWKyycYXzaQEA2VKT2tuN8mzALy4nikoyabavk7IAA1FRi5SSirb5JEFJ+KCa65Mc8M3CcXGUeqZhDk5Sbk22+rZqZUWmamSamVFplJnOzbA6WWotwc7VJ11ONm2BViybFgVZjZNmWBrZjZlmNgGzAY2FY2Sa2YQYzDVTkrbS8aKyqCySWNtwvk2RpAAAAAAAaogZRSiWolqJndVKiWolqB0jAg5qB1jjOscfkdo4jO9LHGOM6xxHeOPyO8MRjemsx544vI6xw+R6YYvI7RxeRjemsx5o4fI6xw+R6o4jtHF5GN6WPJHD5HWOE9UcR1jiM701Hkjh8josJ6ljR0jjM+iPIsJawnrWItYl6jPpY8iwopYketYyljJ6WPIsPkb3PkexYzVjHojydyO5Pb3Zvdj0R4e5N7k9vdm92T0R4e5M7k93dju/IvojwdyHh8j3vGZ3a9RfRHz3h8iXh8j6HdeRLxFzpI+e8JDwn0XiJeHyNZ2kfOeHyIeI+i8RDxms6SPnPF5EvEe9416jm8RvOmY8LxkuHke2WOvA5uBvOkjyOI2nocPWiHD1Gs1mONCi2hRqpEg2hRUaACq2jTEzQBjOmHE88nGLimk3zdHJgAAUAAEoDLMsDbMMsyyo2zbJMsCrMbJ3EuRRdiyNxsU5vk6S6t+AH0OG6l4sjhL72+bbfQ/puGcV1PC88dTo8zhOuq5po/iZ5U1tje1fvOmDXZ9PShP0fU+hrNTcr9U1/bnimbTbISx4nqFunKC5+5r9x/HajULGpSlJObtpN85M+fruLZ1ptHW2LnibtL/uZ8bLnnmlunJuXrLvSZyvLlllySnLq2c9xd9/8Z9L+Zxbolad1qJRwSxJR2yabdczjZDkS5Nijo2Y5HOyXIDo5kuRDkS5FVbkS5ENmWSopyMsmzHIUU2Y5HNzJciDo5kOZFmFFORNmWY5EooyyXIlyCLciXIlsywKbJswyxRVmEuRNgW5EuRgAAxsxyCqsxyIsEFbjLJsbkVG2CdwCuYAIAAAFY9m9d5ezxa6okAdM2F4ZU6cXzjJdGjmdsOZKPdZbeJ/LF+tHr0nBNVrMqhjiu7fNZX9y18JYHBfwvJ8Rl+hI+cf3nCOymHT5ZyyZpym8c4+jyVOLR8vW9kJQjKely7q6Qn1+U152JX8udo4Yxxd5lbSkvQiur8/gOr0z0npamDi19zjlycv5HnyZJZZuUnbZhUAqE3CSkqtesxu236wMAAAAADW2223bZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAo1MhMoqKTKs5m2EWbZFm2BVm2TYKkVYskAirMsyzLCxosyybINbMbMAAxsNmEUAAUAKoCTUjUrLUSUSonSMTYotKyKxL1HSMCowO0IGd1cxEYHeGMuGM7wx2Y3prMRDGd4YjpDGd4YznvTWY5wxeR3hiOkMZ3jA5701HKOOjtHGdIwo6xgZ3ViI4/I6KBaiXGJjdWJUS1AtRLSM1UqHkWolKJaVBUqJW1GlIgxIrajTURWKNlbTUiqAlR8itpoAzabt8jbKTq/MCNpu003/ACAnaZsOlL1CkBycEY8Z22jaKOHdkvGelxM2io8jxEPF5HscSXA1mkeGWI5SxeR9CUDnKBrOmY+fLG0c3CmnXNHvlj9Rylj9ZvOkjxZU5zcmlb9RwlA90oNHKULOmdM7jxOPrIlD1HqlCjlKNHTNZ3HnB0lFHM3WWWEwzDTKgSbZRoMsWKNFk2ZZRVmWTZlgVZlktmOQFWZuIcjGwKcjGybMKirMswywNsp5HsUFSXjXicnIyyj0YlicMjySlGSXopK7Zx3EORLkB9LXv+rcP+Jf05Hg3Hq4hL+q8O+Jf05HjhB5IzkmvQVu2Ua5jJlc2m6vxfrOLmY5CjpuJciLMFFtk2TYbAqybJciHMDo5EuRzcjLAtyJcibMsUbYslslyILbJcibMsCnIlsxsywNsyzHIlsCrMciQBtmCzHIo0yyWzCCnIyzLJcioouWWPdRhsSkne7xZxbbMsKpyMtsmzLIKMswAbYMAAAAXPE4RhJtVJWqZB0wSxRyxeeE54/GMJbX8tM9vfcK96ar9ev4QPnA+j33Cvemq/Xr+Ed9wr3pqv16/hLB49Pheoz48Ues5KJ+mcP0C0+LDpMEXJ/cxS5ttn8jwLPwxcUwbdPqISbaTnnTXT80/UOzWXSx43pG4uL3VF5PSSfhy+E6fHjPWv6XgP2PZ6vTvJJ5suoUowniwx549zUefyo+B2k7Kz4LkySwzlmwQdTe3njfqZ+98Pev1nA8WDgGv0en4pi1OL2VJ4nBtPJHZcnJqVScX9zyp+vn/N/ZH1ehyYNa8eTTSxwxKGdQwuLeXxu5yt3+N49fM9fXx5nLlnW1/mLtXw6OXTLVx5ZMdJ8+qP4w/UuJ5dHDh+peTHk2bHf2xK/3H5933Cvemq/Xr+E8Xefbtj5wPo99wr3pqv16/hHfcK96ar9ev4TMV84HvyZeGuElDS6mM65N5k0n8G08BAAAAAAAAAAAAAAAaopptySr95gAAAAXjxzytqEW2lfIgAAAAAAAAAAAAAAAAADY0pLcm4+KRWVweSTxpxhfJNgTZpICRRtk2LKRVizLARtizABtizLMsVWgyxRCFimzTLAVQbFWds+PFGaWGcpRpW5KuYVwo1IuhRBNFJG0UogYkWo0akXGJFYo31OsIGxgd4YzO6sZDGd4QKhA9OPEc91rMRDEeiGMuGM92jw43k+2dDlvTeY80MZ3jjo7zxRWSSh9x4Fxx+oxutZjnHH6ztGBcYUWomN1YlRotRLUC1EzVQoHRRKUSlEglIpIpRKAxI02jVEDEikjVEpRAxI1IpRNoFYjUbQIAAEA3mP8h/kVa22LMs2yQapG2iQIiwQLJFdAc9xW4kG0S0buMbCpaIcS2yWUc5Rs5SidpHOXM1mpHnlCjjOHqPXJHGSN5rLySjZwlGj1zRymuR151jceSSo4zVHpkjhNcjrms7jkyCpHOTN5rO4qzNxzcjNxtHWzbOO7zG4RHWxZy3eY3eZYLcjHIizLApsyzDLCNsEuRLkUXZjkc3IyyC3IlyIsxyKLciXIhyMsC3IyybMKPo8Qf9V4d8S/pyPn2dM2qlmx4ISSrDHYq9Vt/wDJwcgKOmnyxwZoZJ445IxduMujPO5EuYHaeRSnJqKim7peBDkcnIy2UdHMhzJMsUVbMJcjHIgqzHIhyMsC2ybJsywKbMslsxyApsxyIsAa5GWDLA0EuRlgU2S5GGWkBtglyJuwLckiXIyzLA2zLMAG2YAAAAArHjllmoQTcn0SJNjJxaabTXRoBKLi2mqa5NAuWHIsSyuL2SdKXrAHMqElGabipJeDJAGt226ryMLywWOSUZqSpO0QAAAF4cssGWGSDqUGmj9J4brlrdLi1EbjKSuvFM/O8eOOOCy5Vaf3MPdfyKw8R1On1Hf48jjPpy6V6qNc9RNyv3zhHbbU6fTLS5cUcmz01NPa3T3c/X0Pj8d7RanjubdkjHHjXSEfH1X6z+E4N2ry5c04ZcEXJYskri66Qb/4Pk63tTq9TGUMSjhg/VzfynXfk+mfL6najicIYno9rbyR3OS6dT+OO+POmnjzXLHJ3fjF+tEZsLwyp04vnGS6NHHdv21jmACKAAAAALxTWPJGUoqST6PxJk7k2kkn4LwMAAAAAAAAAAAAAk30B9TgCT1uW/e+b/bkB8xScXabT8jAwAAAAHWWeUsEcTUdsW2nXM5AAAAAAAHbJgUckYY5rJaTuJxaadPqAAAAAAAAAAAAAAAABtCjDasDbMspRNUSCas7Rhi7mTcpd7apVyaIo0DKFFJGqIEpGqJdCgMSopRbfI1IpIinduLaapo6xgbGNu31O0IGd1SED0QgbCFnqx4vI57rWYzHjr4T048ZWPGemGM47reYmGOjvDGXDGdoxo5701mJjA6KNlRgd1COxU3uvmqMbrUclAtRKUS1EipUSlEpRKoIxI01KylECUrKUS0ilECFEuMG3SKNSYRO2jSlEpRLBFGqNl0kbQgjYNh0pjaWCNiN2ovaNoiI2ozadNpm1iCNpm06UzCRXNoyjqY0IVzFlOJLRFrAAFoufI2ScZNOrRjJbIVrZLZhIgN2SzWSwrGcpHRnNlxlymuRwkj0s4SR0zU3HlmjhNcj15InmmqZ051jceaRwmz0TXU881zOuazrmzLKyqKfoNtV4nFs6ZrDtOMsbqSp9SdyOTm5O27+EyzSO1izluY3FHWzHI57i5d33UWpPvL5quVAY5GORDZLkBbZjZDkS5FFuRLkSAjXIwy0Y5AUY2iHLzJcgOjkS5eZzczLKLcyXIkywKtlZMjyyTaSpVyRycjHICrMciHIxsC3IlyJswCnIyybMcgKsxsmzAKcjLMFgAYmrVul40bl2rJJY23C+TYGWY5EgDbMMckS5MC7olyJMsCm2zCbAFxSkpNySpdH4kWAAAAAAAAAANgouS3NqN82jAB01EcUc01hk5Yk/RclTZzAA3c3FRt7VzoGADrnlilNPDGUY0uUnfMl5G8ccdKk76cyAAAKcUoKW5W30AkrHKMZpyjuS8L6kgC8mSWWblJ22QAB9Hgv4Xk+Iy/QkfOPo8F/C8nxGX6Ej5xfwDrDNWOWOa3QfNf9r9aOQIAAAAAAAAAAAAvJkeWSbSVKuSIALm/UbJKMmk7S8TCoKLktzaj4tASA6vl0AAA7YO6luhk9Hd0n7l/UBxPq9n/w3L+j5v8AbkfNy4pYZuE1TX7z6fZ+LetytJtex83+3ID5LBrTTpqmd8GCLi8uVtYl6usn6kB5wbNqUm1FRTfJLwMXNgAezVaB6XFCbmpbuTR4wAAAAAAm07TpgAAAAAAAAAAAAAoqjUmBiibtKo2iCKKSKqzdoEmpNlKKRtATtNSSLUTdoEUbtLSN2gQolJHfIsUoY1jjJSS9Jt9WSoEVCidIxKUTrCBN1SEPE9EIWIQvwPVjxnPdazDHjPZhhKKaTpPqMWI9ePFZx66bzE48Z6YY6Lhjo9EcRx3pvMco42dY46O0cfkWoGK1HJRLUDoolbSUc9qNSOiRqVikQolKLL2lJAQolKJRqVlRiRqVlqJqVFRKgUopGlJATRSiUkao2aiVO1GqPkWkVQRz2s3aXtN2lghwrqZtOu1jaIOW0zazrtMoQcqMo6tEuJBzcSaOrVEtCLUGNWU1RhFc2iTq1ZzaIYwllGMioC2p+km15GslkVDMfUpktOrp16wMZDRZLKjk0cpI7s5yRR5pxPPOJ7JROM42bzWdx4ZxPNkie6caPLkidudY3HkkupxkeiapnCaO2axuOTZliRLZ0xFbjdxzHUqLUg5EtOLaaprwMA1yMsxtGbgijG0iHLzJcgOjkS5eZzcy5QSwxn3kXJtpw8UIMciXMkywKtmEuRjkUVZ2z5MDx4VihKM1H023ds8rkY5AW5EuRNmAU5GWTZjkBRlk2YBTkY2YLAAxyJcgLsxyIsAa5GWY2kY5AUY5IixYGuRlmWYBtizAAAAAAAfR4Ljhl1eSM4qSWDK6avmoNo+cfT4F+G5P0fN/tyPmE/V/AAFQAAAAAAAAAAAAAAAAAAAFwwzyRnKEW1BW2vAgAAAPo8F/C8nxGX6Ej5x6NFqvYeaWTbuvHOFXX3UWv+Tzl/AABAAAAAAAAAAAAAAAAAAPoabDw2WGL1Gq1EMvjGGFSS/z3ID54Pq+x+De/dX+zx/jHsfg3v3V/s8f4wPf2b4SuMKXslN6fC1tfRt+q/UfqPZvsvnzYZy0GjXseCeNyVJOTVLr18D4HZbBw+HCtP3WbK4Sk23LEot8/Hmf6b7O6P2LwjG+AcP0Gq4hLLh36eeTdDut8Ns6cUrcqje62m+XisdauY/zNx3srhnqMuDWabudVB02uT/mfmuu0+oWty6ecKlhtKMVySXqP9V/ZS0XCMWzLpnie7J9+hkc8knXpJ3GPR8unLof577W4OFx4nGU9VqMeSWNXswp316vci86a/igfV9j8G9+6v8AZ4/xj2Pwb37q/wBnj/GaR8yWSc0lKTaXRN9C8uCWKGOTcWsitU7L1cNNDIlpcuTJjrm8kFF38CbPOAAAAAAAAAAFAAbRqXqAyhRaj6zUqAhRKUS6NUSCEjaLpG0BKialRSibtQElbSkjdrAmjaLUSlECNpqgdEjUgqFE3adFBlKCIOaRUYHRRKSJRkYnWELEYnoxxM6uKx4/lPZixkYoHsxQOPWumOmLGevHjMxQ6I9mOB5+tdMxkMZ2jjLjA6KJy3W0KJu1F0ZRKNcm4KNKlz6EVZQsAlRSRiZqKjTUjDU2VFJFJEI6FxAJApI1BqRqQKSLjLUikgkUkXASLpXyQSKSNRE7TaKo01BNGUWBERRLidKDRIOLRLR2aIaJuK5tENHRktGRzZDOhDI1jCJFMlmRAD6gRUMllMlkVD6lrM1jcK/zIbJIoS+ZrJZUSyWUyWFc5I4yR2kc2m+is1ia8s0ebIj1ZPE82U686xrx5V4nmn1PVlPLkO3Osa4S6k3RTOUmdcYa5BTcWmuTRzciXNmpqO08ssk3KTtshy8zlbMssHRzJcyTLERVswlsywKsxshstZ2sUsdLbJ3dcwMciXImzAKcjLJsxyAoyybMKPRm7mMMTxTlKbXpprozg2YLAAxyJcgLsxyIsAa5GWY2kY5AUY2kTbMsCnIyybMsCrMswAAAAAAAAAAC8U+7mpbVJLqn0YEA75sMVHvcVvE/li/UzgB9PgX4bk/R83+3I+YfT4F+G5P0fN/tyPmE/V/ABK3S6nplGOlg4ySlnkqafSC+sqPMAAANScmklbZgAAAAAAAAAAAAABqk0mk2k+T8zAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHbBjxy3TyyqEPBdZeSA/pOyXFY6GOTFqZKGnyS9CT90frfZrtbrOG6eeDTTx5ME/tqb58481TXwI/z/nzyzyTaSiuUYrpFH1+zms1GLVZccM+SMO4zPapOr7t8zO4uP0rtD2kjn1WXW8QzwjkyO9q/wCEfk3FtRl1XEM2bMqlN2l5eH7jzZs+TUTc8uSU5vxk7Z1xZY5YLDmdJfcT9z/IuZEeYGzi4ScW02nXJ2jCgAAAAAA2hQGG0Uos1RAlI1RLSO2HTTzQyzi4pY1bt0QcFFI2i1E0CVE1JGmqLYGGpWUoo1ICVEqjVEpRAmjVEtRKoCFEpRKopRYVNGqLZaiWokohQKUS1FI0CdpqVGm0IMKSNSKigLhE9EFzOMEd8fU59NY9OJHtwxPJiPbh8Dz9OmPZiR64I8mJnqg+hw6dMeiJVERZdnLWhmGmASGvAvdUa5UyaNYCVFIxFFZAgauhRcUUYjSo1IpEotGk1qLMSKQRSRaRkUWkbxBFCikjeIxIpIqhRUTQoujKKlRRDOtEtEVzJkjo1RDRnVcpEM6tHNozohnNnVo5yRnWsQyWy2iWjOq5vqGa1RhFRIhnRo5tEVDMKaJAkxlNEtEXEMxnRxshoVXJoiR2cTnJGsZeXIjy5eh7Jo8uRdTpzrOvDkPJk6ntyrkzx5Op35Y155M4SZ2mcJM7YwhtmBslyN1lRjZG4lyA6NkuRDZgFORlslszcEUZZNmAU5GWzDLA7YsUckMkpZIxcVaT/GORO4xyKLsxyIsAa5GWZuRjkBRloixYFORlsyMtsk3FNJ9H4lZ8iy5ZTjBQi3yiuiAmzLMACwbtbi5U9q5WYAAAAAAAAAAAAAAAAB0w5pYZWqcXylF9Gj+g4V2ZjxBQ1MsjjpZq1H8b4D43DdI9brsGCm1KXP4PE/WOF8OnrdTp9Fp405tQikuSRz76jXOV4eFcG0OlnJY9PDnCfOSt/cv1nzNd2Y0OrjJwh3OR9JQ6fIf6Q7K/Yzx59FKK0+CGWOTHB59S+WXdkjH0fg3K66ePgfyHbnsM+HvU6nS6Z4FgfpRXNZF7qP8A2+fRo83PzZvUrrvx7H+cNdoZ8EyKE3GWeSuMl0ivrPlt27fU/Qu0+hWr4bOajeXD6Sfl4n8DhwyzycYtJpN83R6+NuOO5HMAGkVCcsclKLpoxtybbdtmAAAAAAAAAACoTcG2q6VzRIAAAAAAAAAAAAAAAAAAAADYtKSbSaXg/EDAXlmsmSUowUE30XgQAAAAAAanTTavyNySU5ykoqKb6IkACo45TUnFNqPNkmptWk+vUDD6vZ/8Ny/o+b/bkfKPq9n/AMNy/o+b/bkB8pgMAAKNoDDaNSKUQIo7YMssMnKKi2016SslJI2gJ2+s1Ki1E1KgJo1RKNSbAmjSlEqiCNrNUfWXRu0CEkjaLUSlECFEpIpRKoCVE2jTUrAw1RbLUSkiVUqNFJFKJVUBiiaBQQNSNSKSCpSKo1I0UYkUjCkRXSB1xnKJ1h1Oerj142evEzw42evGzj1jpj343TPTCR4oO0j0QlyOPWN49cZHRSPPGR0TOe41jrYsixZmKuzSLYTKOiNMVtXXI1MrIUuhJqZTXRGkxZRUUikQmUiprqjpFJHJPkdIMqOqRSRKZaZvE1SRaiTHmWkaZ1qRtBIpUaqJoyi6QpCo50KS6lksVXJqyXE7NESRndaxxcSJQOzRLRjdXHncSHE9EokOJmq87XkQ0ehxIcTNacWiHE7uJDRKONEtHdozunsc7VJ11JVeZxJcTu4kuJK047TNp0oUSkc6olxs6tGNAedqjnJcj0TXI4zXI1mjy5EeXKup7Mh48r6nXljXhzdGeLKe3Kzw5XzZ6OGNebIzzyO2RnnkztjmiTIdmtktm8RjBnMwqNsltmmWEYDLNnJSdqKXLwAyzHIxowDbMMsltgXZm4guKSg5qaUk+S8QMk2m01TRNieSWSTlJ22SBtizAAAAAAAAAB0WbJHFLEpNY5O3E5mpN20unUwAbGTjJNVa58zABeXK82SU5JJyd8lRAAAAAAAB10+eWmyxywUHKPhOKkvkZ7vb3U/k9J+zY/qPmAkwr6ft7qfyek/Zsf1D291P5PSfs2P6j5gExbr+j4L2gzLiuneTHp9spV6Ongnz86P1PgPFo6Pi2my51FYVKpOK2tJ8rtcz8Kjakq63yP0Pg/GMeoxYsGfLFaxR9KPT/wCs5fJzWuen+sNLq+Ddouz2m4dxHUazS6TS6jHPFmx5sk++3ZEpPa21GouT5Ln8/wDO/ZN7VabPi1DlHNHLDEtPhWTPkn3q6bvSk69e3w6eb/I+Ecf4jo4vBh1M1hUXJQfNJrmqvpzPmcR4pn1uSWo1uolNq25TfJL/AIPJz8M6rtvyfTw8Z4rPS8M1ORwxv0aS7uL5vl6j899vdV+T0n7Nj+o+j2m4r7Pjjjp5qelj1aX43mfzZ7eOZjh1r6ft7qfyek/Zsf1D291P5PSfs2P6j5gNzEuvo5ONajLjlCWPTJSVPbp4J/LR84AsQAAAAAAAAAAAAAAAAAAHXPljlmpRxxxpJKonIAsAACAACwAAIAAJAAAgAAkAAAADaAwG0KAwvHknik5Y5Si2mrTrk+TMSK2gRRqRaijaAlRNUUilEpRAijVE9Gn08tRNxg4ppN+k66HKgMUUaUomqKAiilEqilECEiqLUSlEg5qJW0ujaAhRK2nXZHu4tN775qjFADnRp02FKHkBxopQZ1UDdoHNRSKSLSRtEglR9ZVG7WaolVJqRaiaogQolKJSRW0giiqKUStpBzo3adNo2gc6NSL2gg1FxIRcTOtY9ED0wfQ8sD0QfI5dN49uNnogzyY2eiLOO43j0xZ1TtHBHWLOetOiZVkGpmdVYMs0iqTKTOdlJlR0BKZRUUmWnZyNTKjqapHNSKsqOqZ0jI86ZakUemMzomeVSLUmisvUpUWpnljPrb6FLIaxHq3GqR5lkRveeZqkenehvR5t6N3ipHfcNxw3+Zm8lWOzkQ2c943kqxdmEqfrG6zG6ozGjTGzG60iSIZ0ZzZndVDRDR0bIbCoZLRTMcmotcuZFc2ZXIMMmmJaILbICt2tq65IiRTlSo5ykBEzjkfIuUjhORvMTXHKzxZpHoySPFln1Z25xjXmzSPDlZ6Msjx5JHo5xz1wmzzyds65GcJM7ZjGpdsw1uiHzNo2zG2LM3IDDYQU205KPLqybJYRrdEuQslga2zLJcjLCKsxskAbZgAAAAAAAAAAAAAABUckoKSi2lLkyQAAAAAAAAAAAAAAAErdLqCseSWKanF1JdGB6OWjXr1D/wDh/P5jzKTTu3frMbt2+oA/o+z/ABvXx1GTH7IlKPc5Zelz5qDrqfH1fEtXrW+/zzmnzq+XyHo4F+G5P0fN/tyPmGczKt+nTDmlhlapxfKUX0aLzYYqPe4reJ/LF+pnAuGWWPdtfKSpr1mkQAAAB1wYJaibjFxTSb9J0ByAAAAAAAAAAAAAAAAABqAKNo0qVlCiqFAYCqNoIgUdEhtA57RtOm02grnQ2nTaNoRzobbOm0URW6jBHDNRhljkTincfmOW06bRtA50akXtKog57Qoo6bRRFSom7SgBlG0aotlbaAg1RLo1RAlRo1ItRKUQJxqKknJNx8aN2q+XQvabQEKJVFKLZSgBCRSg2dFDyKUSDmoFqBdUbTAjabSLUSlADnRtHRRKUQOW1mqB1UClAK4qBSidlBG7UQcVA3Ydq8hQHPuy4Y05RT6N0VRWOPpx+FAXrtNHTazPhg2445uKb68mcKPocVj/ANT1fxsvnPHtIIoUdNhu0DnRlHXaNhRyoHRxNtKDjtTbfUiuRa6mUVFGdMdInoxnnid4Pmc+sbx6sVWr6HpizxwZ6oO0cesbzXpi+R1icIPwO0TlreOqNRiLS5Xav1GNXGGmiiKBMUbQGlIxRNSKkamaZRpazCykyTVYotM2zEjaZUUmylIg1Gs0jomVuOSKLUi1I3cc7NTLUjpvG4iwKR03szcQGSkXuCkQLJuq6bjdxLjtjFt/dGWZ3Vx03DcRZLkY3WltkORLkQ5EVTZkZR3Pcm1XgRZLlQGt0c27DdmEUMboxyIbCtsxsmyZSoDWzlKQcjjOZrMCcjzZJlZJ0eXJko6c4zuoyz8DxZZ9TplyHiyzs784xuuWSXieTJKzpknZ5pyO/OOeuc2c2ymzm2dcZYyWGS7KNJBjRYkGybNMaIMfMllBhENGFEsAAd8GGM1KeRyjjS+6ir5+ARwAAA7ajUS1M1OaimoqPoquhxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH0+BfhuT9Hzf7cj5h9TgEXPXZIxTbeDNSX5kj5kouEnGSakuTTJ+r+MABUACpqKfottV4gSAAAAAAAAAAAAAAAAAakagJGpeCNouFxaa5NdGVEuDi2pJprwNo6TlLLNym7k+rMUSolRNUSqNAnabtNo3aCJo2ito2gSKLSY2gRVA6UNoHMHoyLG4Y9kZKSXpNvqzntIrmKOiR0zY8cZpYpOUaVtquZIPOKOmw3bRBzps3adEjaYVzUCkki1E3aQQbtstRNoCVE1RLSZqgBNGpNnRQ8ilEDmoespQOiSRoEqJtJFKJSiBFFKJaiUokEKJqidFEpRA5qJagXRoEqJqikbRtAZRtFJGqJFRRqR0SNoCNpUMe51aXwlAlGODi6aporGvTj8KOsF31Qf3fSL9fkfR0vCPSjLLKufSIV4+Kr/qWr+Ml855KP6DivClk1monjm9zm3T+E+POD00nGS+2fMQcZQ2OnV+K9RJQKMowoxgYSUSwMoIMmyaOiZ1izzqR0jIxuNY9cJHoxyPDCdHeEzl1jWa98JHeMjwwyHohM5bjea9kWdEzzQmdYys5bjeO6KRzUi0zGqoUEUiBQoGotGUbRpvItGJFbUakaKjEqNALUgXDapJy6E8io8+istIrJtcvR6GGWaKkCkTZtlpGm2YpOqvkZfmT0RXMwwWKQsWY2ZZKsabZFmORFW2S5Etk7gLslyJcibINciWzG6JbIqnIhv1kuRLkBTkS2Q5EOYguU6Obl6yHOjlKZrMKuUzjPJRE8h58mU6ZiVs8h5cuQzJlPJkynXnlndMuQ8eSZuTIeaczvzjG63a8snFNLk3zZ5ZM2Ujk5HbGdVKbcVHlS5nJsNkmogACoGNUaCiGjCjGTU1DBrMAxkspmERJu501bp+BgCAAAAAAAAAAAAAAD28P4Xn4lKaxbUoLm5M8uXHLDknjmqlF00BAAA2MXOSjFNt9EioYpTU2qWxW7YxZZ4ckcmOTjOPRoyTcpOUm23zb9YEgoBYyhRoFIyhRoJSJoFApEg2jKCAAA93CuJz4VqXmhFSbi4NeTOGs1L1mpnmcVFyfRHAAAAAAAAAAezWZN+DSrfjlthVRjTXPxPGAAAAAAAAdMOOOXLGEpqEW+cn0REkoyaTUkn1XiBgNSKSNZiVlFJG0UkVGKJdBI2igKNopIolRK2nVRh3cm5PffJUTQhU0bRVG7SxKijaLUTQIpjadKFARtobS9pu0iue0KJ0o7ZoYVjxPFOUpuPppqqZB5topIvabtJBzo3adFEKIiudG0dFC/A3YZHOjVFnVQSN2gTDBOak4xbUVbMUDqk1dN8+ppFQolKKKo1RAk7Rhienm3OSzJrbGuTRKiaogQolKJaiUogRtKUS1EqgIUSlEoUQZRptGpAZRqRqiUkBKRSiabRFZRtGgAdsGlz6nd3OKeTb12q6OJqk49G18BIPV7Va73pm/0M1cL1vvTN/oZ5e8n7qXyjvJ+6l8oV9rhfCdSsssk9PlW3pcWfrP2Pux2l1U48Q4lm0608IuWXHlavFBOnPa36TXuVz9R+N8K1Tx5nCUnU/FvxP1nsF29ycBy49Jq8iWgV7o02siu9k66wfijHVn0uR9Xth2P0Gp4ZpuJ8M1Ol7ruN0ZRaUs0kluThdqnaTa5/AfkHFeFamahkjp8rl0aUWfqvbL7IMtVosPDeHyjHTrCsc8MYtY8TpKTin0cqt+fM/IOMat3HCpO1zfMc39Njze1et96Zv9DM9q9d70zf6GeTvZ+6l8pnez92/lNo759HqdPFSzYcmOLdXKNHCyZZG+sm/hZO4QW5EuRDZlga2ZZhlhFWapUcnIbzKvQsh1hkPGpouM6M7jWa+hHIejHlo+ZHIdoZTl1y1mvqwyepnaOQ+XDL5neGY5by3mvpxyHWMz50cp2jlOe41mveplKR445fM6LKY3Gq9SkVZ51kKUzMHaylI4qZW8fY6qXmVZx3I2wOwOW5m7gOthM57xvKOti/M57huFHWzLI3IzcKjpuG457hvFHTcZuOe8zeKO0k4qL5c1ZNjLL0MX5v8AyyPRSjJtPnzXia6+tTFbiXIhzJcjKx0bJciHIlyCr3GORzciXIDo5EORzcyXMC3IlzOUsiOcsgg6ymc5TOUslHGWXzN5iV2nko4TyHKeWvE888vmbzlN11nlPNkynPJmPLPKdeeWd10yZTy5MhE8h555DtzyxuqnkOEp2TKZzcjrmJWykQ2Y3zMN5iAANIAAAAAMZLKZLIaxklMkiMfQw19DAiQAEAAAAAAAAa4tJNppPoYXPLPJGMZSbUVS8iAAAA9Gk12o0MpPBkcHJU/M4TlKcnKTbk3bb8TAANo1KgFgDaNIsZRtA2iKw6LHF4ZT7yKknW3xZFChRgNoUKMoyiqMoCQUZRUiaMKBUiQAEAAB200cMptZ5yhDa6cVfPwOJu1qKlTp8rMAAAAAAABeJY3J95JpU+i8QIAAGpFUbRVeRpEpFKJqTKoIJGgpIqsSKSNSKSKlZSKSs1RKo0idptFUaogSbRagUogc1EpROiiaolHPbRqj5HTabtIMw4VmzQhKahFunJ9ETLGoyaTUknVrxLo2gOagNh0o2iK57BtOlCiQT3bUVJp7XysbUdnlySxRxOTeOLtIjaZitw5Xgk5RUW2muasiiqN2sQQlfRFODi2pJprqmXFOLUk2mujRc5TzTc5u5PqyQcdpqidVA2gIUTVEvaUokVCiUolUaBiRtF4prHkjJwU0n0fiZKnJukk/BeAEm0abQE0bRSRtEGKJtGgKBKwanRBoMsWEaXiyvFJtJNtVzVnOxYVoJsy0QVYsjcbHI4u11LB2vufjPo/zPbpeL5ccoxyLvFfXxPlOQxv7ZH4UIPvcX4vkWt1OPHFRanJX18T4/e9/ym/tnhJ+PkzpxZ/9T1fxsvnPFZBcri2nya8CbEpuVW7pUTZaKsyyXMlzIOlmORyczHIC3MlyIciXMQXuM3HNsyyjrvNUzhY3GVr1rIdI5PM8KkUpmdxc19GOU7wzHy45fM7RynPeWs19WOXzO0cx8mOU7QzeZz3lrNfWjlOkcvmfLjmO0cxz3lrNfTWUtZfM+dHN5nRZTG8tV9FZSlkR4Fl8y1lMxa96yeZqmeJZSll8yRXt3m7/ADPIspqyCD17hvPN3hvekg9G83eefvEasip2xB33m7zzd55m7xB33jeefvB3iEHfeN5596XToJZKp31NZxu7/wCUuZ/XszS9DD+b/wAs47ic+T7Xg84f8s4vIdPk+PrnfvGees3Pp23mORw7zzJeTzOW5/jTu5kvIcHkIeRiK9DmQ8i9Z53k8yHkLEr0PJ6jnLJ5nB5Sc0njdNp2r5MucldZZDlLKco6hQk24qSpqmeaWb1G85Zr0SynGeY88s3mcJ5jecpXeeY888xwllOE8p0zlnddp5TzzynKeU4yyHXOWd10nkOLkRKZzcuR0zGauUiHK2Rutg3mFUUQmUmaGgAAAAAFkt2AJZrZhNTWMwMAYzGGYyIwABAAAAAAAAAAAAAANSCNC4FJGJGmWg2jUgSgKNSNAyhRtG0FTQoqjKAmgUKCIowqgKJJKDKJJO2N41HIpxbk16LT6M5M0zrAAEW803jWNyeyLtIgAAAAAAAAAAAAPRXkakaCoGpWEi1FmhiRSRqRSj6yolItL1mqJVFHTPDFGaWGUpRpW5KuZCiaky1EqJUSkilEpIqJUStptFKIImjaKopRCo2jaXRu0CKG067TVEg5bRsZ12m7SK5bDdp02m7UQctpuw6UbRBz2m7S6Noiue0qjvgyRwzcp445E01UjnRBNG0abRFYCqFAZQo02gMNo2gASNSCNsgAyxYGgyzNwFAjcLCqsbiLMsC9xm4mzAVVmWYZZBVmWS5GOYF2bjf2yHwo4uZkZ7ZJ+p2B9Di8q4prPjZfOeFzK1mp9larNnrb3knKvVZ53IQdXMlyObmTuEHVyJcjnYsFW5E7idyMchRVmWQ5+ZWFRyyalkjBU3bAbiXLzOblZIg6OaM3nOzNwHXeashxcjN5IPSshayHk3mqZNxXujlOscx89ZC1lMbjVfSjm8z04d2SM5JxqCt2z5EcvmdI5WvExvK5r6kc/mdY5j5Ucx0jnMby1X1o5/M6LMfKjm8zosxneVr6kcxazI+ZHP5lrMY8rX01lXrKWTzPmrN5lrN5k8rX0FkK70+esxSzeZPK17+98ze9PAsxqzE8le7vR3p4u++ArHqXjkpLba9aseSvX3o705+2eT3OL9XH6h7Z5Pc4v1cfqNeM/wBS66rI26Pp8H4PqOMajZhxyeODTySir2r/AJ+A+Rj4nPerWKvi4/Uf2nYrtNj4NxFSy47lKcXBxm8cVJPlucadeZ7/APi45zNeb5919nj32OMmj4fDJp+8nlbUcMd0Zb47Yzd105TXX4D85z454ZThOLjODpp9Uz9y4rxvhvBNFxPU4p6nI9dli9TGWaS57Yy9Cpc/Scvur5V42fivE+KvJm1GdQhGOSTaUopvm/W+p6/+jjnedzXH4t24+c8hLykPieT3OH9XH6iHxTIvDF+qj9R8bzz/AK911bykPMRk4nknFxccVNVyxxX/AAeN5x5/wr2PMc5ZvM8cs3mc5ZvMucleuWY5SzHklmOUsxrOUr1SzeZxlmPNLL5nKWY3nDNeieU4zynLLqnNRTr0VXJHmll8zpnKV3llvxOMshylkOTmbzGa6udnNzOcpkORvMSujmTdkJmmkqjUzAVVG2SmaBQsk2xVrbFmWZYpVGNmCwlDGw2YAMbNJIgSzWzAgAAAAAAAAAAAAAABdQKCBqJrWNNRhRNUKMRpFDaNAAAUCANowEKJooASSyjGBLMKJZcRjKeKaxrI4vY3SZL6Dc9qjbpeBUQDX1MKyAAAAAAAAAAAAAPaoGqJdGqJpEqJqR2y4HgkoyabaT5OyUi4Mo1I1RKUSoxItRKUS0iiVEpI2jaKkZRSRqRSQGJGpFKJSiUTRqiXRtBEqJ0xYJ5ZNQi5NK+RlFRbi7i2n5EWIryNoqhQE0KKoURWUdMmKMI45LJGTkraXgTRtEEUKKBFZRoBBlCiqHRAYACKAADUjSQEUCQRW2LMsywPXqccceHSyiqeTG5S83ua/wCDy2fYx8PevwaT7YoKOL1X+NI+RlxvFknBu3F1aGmMsyzDLIKswzcS5AWZZDkS5AdNxjmc3IlyIro5mOREbnJRim5Pol4kOVOvEo6bjHIzHjyZ5OOOLk0r5HNgW5GbiLRm4C7ZhDmS5gdNyMcjk5kuTZB1c/MlzOdmWBbmZbIciXIDpZm45uRm4o6ORLkRZlgW5E7idxm4CrF+ZFswIvcbu8znZlhXZS8zVM4Wjb8yQelZC1lPJufrNUjMWvaspayngUy1kaJ5WvoLKWs3mfOWUtZTO8rX0lmLWc+asvmUsxnytfTWfzKWfzPmrMUs3mZ8rX01mKWc+YsxSzeZPBX01nNWfzPmLN5ld8yeF9Ppd/5jvz5vfP1m995k8FfR78d+fO74d95jwV9KOVu23UV1Z7MHFYqozTpdGfDnqXLkuUV0Rz746cbvG/8AlnrM6/r+x1nE8UdPpm5ylcLS9fpM+Nn13sp7fuUunM8euy/1bQfFP6cjwPMdPk+Trr61nnnM+3vllcW0+TIebzPJPUqUUpc5Lo/I5PMcvDde15yHmPG8xDzeZc4SvZLN5nOWXzPG8xDylzkr1yzHKWbzPM8nmQ5ms5ZrvLKc5ZTi5kOZrMSurmc3M5uZNm85SrcyXIkFhQAFQKTJAFG2TZoVQMsWBtm2dNRLDKaeGMoxpWpO+ZyKrbFmABYFmWEaY2ZYINScnS5tkt0bGbhJSi6a8TG2223bYGAAIAAAAAAAAAAAAABq6mGoDSl0JKRNaxq6mmI0zqqNRhqCtAAMakaYjrkwZMUYSnBxjNXFvxMq5ho6Rli7mScZd7aqV8qOYEgA0msZhrMAuUsXcRShJZk3cr5NHFnSCg4z3Np1ypdTmxiMJKJNJrGYazCs6AAAdcuKOOGOUckZuStpfinIAAAAAAAAAfVo3aWos3YzaIo1ItQKUQis2WWealJRTSS9FUSkUlRSRRKRVGopRKJSKUSki1ECVEpRNSLotRkIOclGMW5Pokbta6nTDlnp8kcmOTjOLtNCp5snjKc3/m2BCRtHTLhngySx5IuM48mmRQVlGmpG0ESbRVGhU7RSRtmUQAARQyiqD5EpU0aARAxm2SFwAMsitBNgg2xZgA2zDLLVTVLlNfvAkWQ5EuQH09TmniwaJwnKLeJq06/GkfPc/M9Ouf8AVtB8U/pyPBuGj1YsmGMMqyQlKbj6DTqmcHImCc36kurfgZknG6guS8fWQa5FQx5MsZyhFuMFcmvA4OQU5JNJtJ8nXiB3WaKwSx93FybTU/FHFyIMtAVuMslyJc/MDvizT0+SOTHJxnF2miJ5HOTlJtybtt+JxcyXNgdlklF3F0+nIhz8znbMsKtzJcmydxLkBdmWQ5EuQR0cjHI52ZYFuRjkRuRm4C7MbItmAXuRm4mzNyAq2YTuMtgXZm5BwaxqbapuupztAXuMtkbjNzAuzLRFmWB03IzcRZliDpuN3nKxYi169PnjizRnJbkvA6avUxz5d0I0qPDYtkg9Cmap+Z5tx2jqpxwSw1HbJpt1z+UQdFMpZDyqZu8kV61l8yllZ5FPzN3khXrWU1ZTybzd5IV7O+8zVl8zxd4b3gi17e98x33meLf5mqfPqkSFezv/ADHfeZ5JT2yaUk0vEzvPMQr2d6Y8p5smoeV26uq5Ijf5iFfa4hlrS8O88L+nI+c8pWt1UMun0MISuWLE4yXqe6T+Zni3mtxM16nlJeXzPNvMc/Mnkr0PIS8hwcyXMvkru5+ZLmcXNmWzXlK6uZDmQCwrXJswAqAAAAAAAAAAAAADbNskAUCQBQJAFCyQBtmAAAeqfDtTj0sdTLFJYZdJHKOmyS0886j9qhJRk76N3XzMDkAAAAAAAAAAAAAAAAF1AAo1GGomtY0ok1E1VI0koiqBN0UAKc5SSTbajyV+BIBW2YACgBjYGBglsASymSXEH0JNZhcTWPqYAVkAAAAAAAAAAAAAfeUWbRVCjcRlGpFUbtAmjUilEpRKiVEpRLSKoCVEpIUakUKOuF44yfexco06SdcznRSQGUauT5dTaNANynJyk22+rZqRliwKFmUOQCxXrFmAbdCrKnkc4wTS9FUqRDZFbddDDLMsgq6MswywNsWSCDbFmWZZBoJcidwguxZzciXIDo5GORz3GORFW5GbjnuNyQniaU4tNq+YHtjpsupxxmoPdJ0n4SPfpuCx2qWeT3ddqHAsF4nlnb51FPw9bP7vs12afF37I1G+OijLY5Q5u/qOnPFY66j+W1nCtNkwaaO1qoUmn09JnwtZwfLhe7HLdi6tv8VH+hOPfYxhoNBkyZ9Hm0+3IsWKUXue5wjNRa/91n5PxPhuXh2rzaPUxW+HJrqmjffxz+s893+P4LJkTWyHKC/f5nOztxLB7E1eTGrUeseXgeNzOGurpuMczk5smyDq5kuZzszcBbk2ZZDkS5AdLMcjm5GWBbkY5ENk7gL3GWRuZlgW2jNxJloCnJmE7jNzAszciLMtAXuMtkbjHJgXZloizLA6wnBN7k2q8CHJk2YIKb8zLMBRtmAAAAAAAAAAOpsouEnGSaa6piMnCSlF01zTRWXLPNklkyScpy5tsCAAAAAAAAbY3MwAVuY3skEhVb2N7JAgreN5IEWq3sb2SBErdzFswFCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALhjc1Jpr0VfNkAAAAPoZeManNoY6SW3u1SuubSOmD+7+t/SMX0Znyz6mD+7+t/SMX0Zk0fLABQAAAAAADUnJpJW34AYCpwljm4yVSXVEgAAAAAGo0kpBcamaSUZaULJNskF2CTbAqxZNiwqrFk2LA0GWYEGwZZgAMElAxmkmmdAAEACsaUskE+jaAxVavkvE3IoqclBtx8Gz18YwY9LxTWYcUduPHllGK9STPEAAAAA6ZMGTFGEpwcYzVxb8QOYAA/pdo2nSjaNsplilFJyTSl0CiXzdXdIUBNFJGm0BhtGpG0UZRtGgAAbRVLZoBKQAApAGWLFI0WSa4uLppp+ZAswGWCtMbMcjLJRtmWZZjYGtmORNkuSAvcS5EuRLkB1nlc1FNKo8uSGaeOUl3cWo0rt+JwcjLZFW5GORBlpEHsxazFjxqMtJhyNfjScrfyMv2fg94af5Z/WfP3EuRaj6cdbhlJRjw/A5Pok5/WZLiWFv0tBgbXLm5/WfOx6iWDJHJjk4zj0aOc8spycm22+bbFI/t+Ea3Dl0UdumxR2tppOXL95+0/Yx49pNDj0efJkzR9j5HGWHDGEpW7pxUk/XfP1H+dOBa6WDNLHNruZc226UT+z4bxTUcOzR1OjzbZVya5po7fH3Ptz75r/S2XJh4DpuN58/G566Gul3ePFiUJLBcISt7oOoq1Hko/cLl6vwntnrsOXjMowrUd1FQc5ev/ACGu7acTy6bZCUMT1C3TlBc/VX7j+P1erjp4SlKSeRpuMW+cmdPk+S/xnnmPj8e4hp1rdvsLBkcYpNycuX7z5Xtjp/8ADtN/qn/EeHU6meozTyT+6k7fkcXI8u79u2Y+n7Zaf/DtN8s/4jFxHBJpLhunbfnP+I+ZZl14ikerWZVPLywQwbeTjC6+Hm2ebcTKbk23zb8WTuZFXZm5EACtxlslyRm4goWRbMsC9xO4ncjHICrFkNsmwPRhzRxSbljWRNNUzk5MizLApvzMswFG2EnJpJNt+BhUJyxyUoupLxAkGtuTbbtswAAAAAAAAAAAAAAAAAAbKLi6aafXmBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC44pThKcVaj18iC8WWWGanB01+87ZcUcsHmwqkvu4e5/kB5j6mD+7+t/SMX0ZnzsWHJnmoYoSnN+EVbP6TT9n+IvgOqj7HalPNjkk2k6qX1k3R/MA659Nm00tubFPHL1SVFYcMXHvctrEvlk/Uijn3Uu77yvQuk/WQdM2aWaVulFcoxXRI5gAAAAAGtuTbbtvxZgAAAAXDI4KSSXpKuaIAAAACgSbYWqs0kWRaqzbJs0iqsEgQULJAg2zLBlgaZZlgqUAskqUbAAQALxRjOajOW2L/Gq6AgvD99h+chlxSwzcJqmv3jD99h+cgPf2g/tviHx0/nPmn0u0H9t8Q+On858+EJZJKMU3J8kkBIOmbHHFNRU1JpelXRP1HMAa5Skkm20uSvwMO2mwwzzcZ5Y4kot3Lx8gOIAA/rKNo0G2WUKNAAUD369VpeHeeF/TkFeA1RdX4GFrJJRcbe1+BaRgAFIAyynGSSbi0mrTaFGWLMsWBtizLOizRjgljeOLk2mp+KIIFkWY2EXuNyZp5WnOTk0qOVmOQHaWVPFGGxKSd7vFnKyHIxzIL3GORzciXIK6OZLkc9xlgW5GbiTNyIKswhyJcwOm5GORycyXJsDq5+ZDmRZjZFW5Nk2S5EuQF2Vji8kqTSS5tvokcHIp5pPGoKlFc3Xi/MDrlzpx7vHaxr5ZP1s7aXi2q0dLHkez3L5o8DZm4Uf0/Ee0OrWk0OxQjLJibbS6enJf8H89n1OXUZO8y5JSl62+h6eIy/qnDPiH9OR82y7upmPXa1K/9f6f8zzOVE3RWXN3jUpJbq5tePmRWWzCdxlsCrM3E2ZuQFbmZZO4lvzAttIzcRYsCtzMskAbZlgAAAAAAAAAAAAAAAAADtLTyjp4Z247ZNxSvn8hxAAAADrn0+XTTUcsHGTSkk/UzkVKcpu5ScnVW2BIAAAAAXkyzzSUpycmlXMgvJjniaU4tNq+YEAAAAXh++w/OQENU6fUH0u0CrjnEEunfz+c+aAAAAAqUVFRakna5peAEg6xxRennkeWKlFpKHizkAAAAAAAAAAAAAAAAAAOuDPLTzcoqLbTXpK+oHIAAADYxcnSr18wMAAAAAAAAAAAAAAAAAPVo9Bl127u5YY7eveZYw+dgeUH1PaDVfldJ+04/rHtBqvyuk/acf1kuD5Z6+GYM2p1uLFg++Sdc+leNnp9oNV+V0n7Tj+s/peyHA8uDPqM08mByUVFbM8JLn8D8ib1kXMfc0HC9PoIuGnwqMpvnXNtn9Xi7K8XnoZNaLInP01F8pNK75dfFH1ewXBdPqddmzatb+7SUI405U34+j0o/fFw7hGi4tw/s5qMOuzcW1Omm4632PlSTk4OL7vbue1RmqSd2uavl5e/kmuvPNf5J4hw3HqFPT6zBzi+cZKmmfnPHNBm0euyY3H7VFXDb0UL5H+lPsldnsGjyqeKUnqcWWWLLPJCUO868/SqunSj8e7V8N1GTRwlizYoSb2STzRimn8L8jr8fdY6x+bg+p7Qar8rpP2nH9Y9oNV+V0n7Tj+s7XGHywfU9oNV+V0n7Tj+s4avhmbRY1PJPBJN19rzRm/kTFweIAFAAAAAAAAAAAAAAs2zABQJFhaoGWLJCtBlixCtBlmFK2xZeRY1HHslJya9JNdGcwAACAB6tHw/Lrt/dywx29e8yxh87QHlB9X+j+q/K6T9qx/WP6P6r8rpP2rH9YHDRQlr549G4uU5Osckucf5H9jwrsZp8LjLUt58vuVySOXY/gE8WpzZ8stPKcElHbmhKr+Bn+g/sadldJ3T4vqZZciwY5Zc8IYpT+1J09jSaUvN0vB0XMTdfhvH+yOl1mr1E8e7DmlOUt3VPn6j+H1+lnwbJLTNfbmueTwr1I/1r2x7M6DivZ/RcX07z4sT07WFTwyUnKCW/dKtrW66pul19R/nztjwKWpwYc8JYI5Yy23LNCKa+FsbiZr86B9X+j+q/K6T9qx/WP6P6r8rpP2rH9ZGnyge3V8LzaLGp5J4JJuvteaM38iZ4gOuXTywwxTk4tZFap2DkAP6+hRoOiMo2jLFkBnu4h+C8O+Jf05HgPfr/wAF4d8S/pyBXgAAKAWZYRp1nq8s4RhLJJxitqXqRwbJ3BV2ZZNmWEXZlkORLkQdHIlyObkS5FV0cyXIizCUinIxsmzHIUULObkS5og6ORjkcnMy2wOjmS5kWZuFFW2ZZDkS5EV03EuRzcjLAtyMciG0Y5AXZLZNswCnIzcybMcgKFkNmAfT4jL+qcM+If05Hzdx7+JNLScM+If05HzdxdFWZaRDfmZZBe4zcybMAqzLMACwAAAAAAAAAAAAAAADrijhcMryTlGSXoJK7ZyAAAAAAAAAAAAAAAAAAAAAAANcnJ222/MwAAAALw/fYfnIgvD99h+cgPq8Ylhjx/iTzwlOHe5KUXXO3R8mDgpPem1Xgz6HaH+3OIfHz+c+aAAAAAAAAAAAAAAAAAAAAAAdcunlhhjnJxayK1Ts5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAANVWr6AYf0PZHXrS8QeGcqhnVeFbvA+BNRU2oNuPg2dsGJJd9kbjji+VdZP1Im5cH7n2Y7Q5ez+tlkjzxZY7Zr1ep160ft2j+yfgx8LxYlr9PkxxwZIPU5F9vTbxtO+u5d2tvivDwP8lcM7Y453DWxWP1TguVeZ/T4eK6KfDsuVanFs3w5uVVyZ5u/iv8AXTOo/rO1/aifHcsMEcksmnwt1kfJ5H7po/Je2mvU54dJCV7PTmlXXwPZxLthgww26Nd7k91JVFH8prY+yXLVwkpPJ6WSK6wb/wCDrxxGd2vCADqyAAAAAAOuDFHNNxlkjjSTdyOQAAAAAAAAAAAAAAAAAAAAAAAAAAAAdI44vDLI8kVJNJQ8WcwAAAAvHBTk05KKq7ZkISnJRim5N0kvED7vZPiXsLiKxTf2rP6L8n4H7l2M7bZ+zes07yTyZNLhl3mOEae2fVOn1V+HQ/zxOcdJF48bTyvlOa8PJfWfQ4X2k12glDHHIsmO0lHJzouam4/0F2w7eajjG3BgnkxpYo4c75JT2pRXJeS6+J+HdtOJd7nx6OD9DH6UvhJ7S9pddk4jrNPCaxQhllG4cm+frP5/Hmjmj3Wd8vxcj6xf1DdMx5gXlxSwzcJqmv3kEUAAAAAf1wBlnRl2hJSjsn08Jer+RE4OEnGS5kWevRYpa3IsDuvCVfckV5T38Q5aXh3J/eX9OR9vS8MwaaK9BTn4ykvE+nrMClp9Mp47js6NcvumZ9LH8DZcIKt83UF8r8kfc13BsUk8uK47U24JfdfB6j+dy5XOXNUlyS9Rc2pFZMrm76Jckl4EORDZllRdmNohyJcgro5EuRFmCkdsOeWDLHJFJuLtJq0c5zc5OTq275EWY5EooyyHIlzA6ORLkc3NsmyDo5olzZFmOQFWZZLkS5AXuMcjm5GNhVuRLkS5IxyIKsxyRFgCnIyybRjkBRlomzLArcdFnitPPG8UXKTTU/FHncjHJgXZWKDzZI44tJydc3SONmWBcrjJxdWuXIlsmwB6M+rnnx4MckksENka9Vt/8nnsAAAVkxvG0m10vkwJAAAAAAAAAAAHWOeUcEsSUdsmm3XM5AAAAB11GolqZqUlFNJR9FV0OQAAAAAAAAAAAAAAAAAAAD1Y9Hv4fm1e+u7yRhtrrabv9x5T6mD+7+t/SMX0Zk0fLABQAAAAAD18tcvBalf+T+fznkCdO11ANU6fU6YE3mhSb5roff4LwX2/vLlcsfdtKUkvvn8z+50HCdJonCOn08VJcrStv/MD827RRa45xC019vn858w/ZeMcO0+r1OaOowQmnKVbo8+fqP4XjfZ3HweE9ZhvJDdUcbVqHm/WB/PwhHSRWTIk8r5wg/Dzf1HllJzk5SdybttmznLJJyk25Pm2yQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAW8jeOOOlSd9OZAAAAAAAAAAAAAAAAAAAADtghB7p5ZVCPgusvJE5s0s0rdKK5RiuiRzAA+tpouXAdWlVvUYlz+CZ8k+pg/u/rf0jF9GZNHzsuJ4ckoSabi65OxiyywzU4Omv3kAo75445RWXHUU3UoX9y/LyOAAAAAAAAAAAAAAAAAAAAAAKsAAAAAAAAAAAAB1jLD3E04SeZtVK+SRyAAAAAABsZyg7i2n0tGAAXh++w/OQx4p5pOMIuTSvkMP36H5yA9/aD+2+IfHT+c+afS7Qf23xD46fznzQNlOUkk22oqlfgYAABsYuUklVvlzKy43hyShJpuPqYEAAD+t2S9xL5Btn7iXyHf254h78z/62PbniHv3P/rZtHn2z9xL5D+k4DpZY9K8jj6WR/uPhe3PEPfuf/Wz+l4HxbU6jSVLUZHODp3O2zPX8XH6x9jfsLm43LBqYaWOr1OXJtxaaVVKPi/h+H1H6nxnsDptZw/ikNBm03E8mmyL2Rijjaemj3cLm/FU3KNcncX6nX5v9jLtZj0ktPiem0ubiGGbcPZWNShOD63fXx/cfpmv4vwDhej4xm4RwrFHUarIvZMtXGEls7uDk4cqjLdvaqlT6dK5bWn+du0/ApcC4rk00W54mt2OXrTPzfjellg109sHtn6Sqz9Q7VcdjxLi2SeifdaaC2Q2rbfmfnPG+Oax66UMWryxjBbfRyPmzfKa+G4z9xL5DNk/cS+Q9ft1xD37qP1jJfG+Ie/dR+sZusvL3c/cS+QmSceqa+E9T45xH39qP1jPLqdZm1U1PPlnlmlSc3boCXIlyObmybsDo5olzbJslyFFWZZLkS5EFuRjkc3IxsC3IlyJckY5AU2Y5IiwRWuRlmNmOQFGNkWZaQFuRNk7illXdSg4K273eKAxtIxyIsWBTkybMAG2YAAAAAAAAAABU4qLpSUuXgSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHXDh7/AHRjL7Z+LH3X8zk1Tp9QB9TB/d/W/pGL6Mz5Z9TB/d/W/pGL6MyaPlgAoqDippzTcfFIx1brodcmDuscXN1klzUPL1s4p07XUC+5ye4l8g7nJ7iXyHvXaDiqVLiGpr4xj+kPFf8AENT+sYHg7nJ7iXyGrBkbS2S5+R7v6Q8V/wAQ1P6xmrtFxVNP2w1Lr/1GB+k8J0D0Wh0+njCpKKuvF+J/ob7G32N/uc2aOKOnjBT1mtyRtaS/H4Of/L5dPwLh3GM+r0mn1Ec8mpxTrffP1H+h/sd9rOF67A8Gp4fps2g1GNQ10e7j3q8sbfNXz5+p+vmgdrPsd4tdwTh+pwvDn0GXDGuIY49Mu23jXrpt34cmut1/nviPD5QlqdHnhbTljkv3H+i+0faPg3CezvDtLpeHYMXC8WKM25wi8zzOPPn1cW7pXyv1VX+fdfxfNkzajUvK8cJOU6TqMV1A/FtVo8un1GXC4NvHJx5J1yOXc5PcS+Q+rqu0vE82pzZIa7UwjKTaisrpI4/0h4r/AIhqf1jA8Hc5PcS+Qdzk9xL5D3/0h4r/AIhqf1jH9IeK/wCIan9YwPmtNOn1BWTJPNklkyScpyduTdtskAAAAAAAAAAAAAAAAAa04tpqmvBhNxaadNeJs5yyTcpO5PqwJAAAAAAAAAAAAAAAAB1yxxKGN45ScmvSTXRnIAAAABeNwUnvTarwYEAAC4OCjPcm21yp9CAAB9TB/d/W/pGL6Mz5Z9LDlguB6vG5JZJZ8bUb5tJTv5yaPmgAoAAAAAAAAAAAAAAAAAAAAAPo8FV6vJ8Rl+hI+cfR4L+F5PiMv0JHzi/gAAgAAAAAAAAAAAAAAAAAADYycXabT6chGW2SkuqdmBOmB31mqnrdVm1GRJTyyc2l0tnA2UnKTbq36jAAOmPNLHGcUo1NU7VnMAAAOmbJHLJOONQSSVIHMAf0e4zcSDdRu4+hwrVy0OXvpSawvk0vxjxY4R295kdY18sn6kRlzPI7qkuSS6JEH95o9fi1MI5MGTn6rpo+zr+JavUafBHNqss4SjualNtN21fyH5PHLKEk4ycWvFM+nxTW55aLhylmm1LA205Pn6cjPla+9xDjOn027FHJeWSaTjzUX5n8hmc1kl3j9Nu2/X5nBzbOkMqyRWPK6X4svc/yLmREORLmMkJYpOMlTIciirbMshyJcgOjkS5EORNkHTdbq6MyVGTSluS8Uc7RjkBVmOSIsBVORNmWY5AUY2TZlkFORNkuRjkwKtIxyIsWBTbJswAbZgAAAAAAAAAAAAAAAAAAFrI1jcKVN305kAAAAAAAAAAAB27vHN44wk3Jr0rXQjLj7qVXZCdO11NbcnbdsgwAFAAAAAAAAAAAAAAAAAAAE6drqevlrV6tSv8Ayfz+c8h9HgnDnxPXwxW4wXpSa6pImhw7gmr4nJ91CoJ05z5JH9Zg7HSXBtRhlqkpTy45Oo8k0pcv3n9Ro9Hk1OWGDBC5P/7bP7zF9jbU+xVilq4d9ki8noxuKa5Vf/uOfXbecv8AOnEuz2s4bHfOKni91DnR44QjpYrJkSeV84Qfh5v6j9h4nwzNwvUz0+oim4tpSXOMvNH5h2o4Y9Dr3lTbx57kr8H4o1z1Wdx8Sc5ZJOUm3J822HJbUtqv1mA2gAAAB64QjpIrJkSeV84Qfh5v6gP6Ds7xuPB8Xcayc9mRpwiuexetn97w/iLjOGfR6lpvpPHL6j8ZnOWSTlJtyfNtnfR6rNp88HhyzxttL0ZVyA/aOL6/Jk1GV6nUSlDG2l3kuUUj+E4/x/Hr8OTRaLJLvL5yXSa8UmfB7S6vPm41roZM05Rhmmopy5LmfHTp2uoBqnT6g9fLXLwWpX/k/n855GqdPqAC6gAe/XaHFpsGOcMm5y6r1ngFgugACAAAAAAAAC8U1jyRlKCmk/uX4kyacm0kk/BeBgAAAAAAAAAAAClkaxuFKm76EgAAAAAAAAAAAAAAAAAAAAKhJQmpOKkl4MkAa3bbqvIwAAAAAAAAAAAAAAAAAAAAAAA64e7lcMnLd0n7l/UTkxyxTcZKmiD7/AOGLiil7ITeDE+T8b9V+ouZfoeLgkW9XkaTruMv0JHzWmnTVH7LwHs7my4py0WkXcRTg2qXpNUvh8D4vGezeKefJh1WDutTB02uT/mb349jPp+dYcKce9y2sS+WT9SOUmpSbSUU30Xge/iyjjzRwrHLHPEtsk3y6+B885tAAAAAAAAAAAAAAdcuWOSGKMcUYOCptfjHIAdZRwrTwanJ5m3ujXJI5AAAAAAAAAAC04d1JOL7y+TvkQAAAA+5u8zNxytg0jrLK2km20uS8iHMmzLAq2z6PEn/AFPhfxD+nI+W5H0OJv8AqfCviH9ORB48uxSXdttV4+s5ORDkZYHSWSUkk22kqXkQ5EtkuQF2S2S2zAqnIy2zLJcgijLJbZhFU5GWS5IlyZRdkuRNmWQU5MmzABtmAAAAAAAAAAAAABUoqKi1JO1zS8DIxc5KMVbYGAqeOWOW2SpkgACpY5QUXJNKXNASAAAAAAAAAABqq1ateJgArI4OcnBNRvkmSAAANjJxkmqtc+YGAvLkebJKckk5epEAAAAAAGqrV9DZuLm3BNR8EyQAAAAAAAAAPVo8ejnv9l5s2Ovue7xqV/K0eUAfU7jg/v3V/s8f4jtF8Kjp54Fq9Tsk1Jt6aN/LuPigkH1O44P791f7PH+I/qex2n4Yp6qWHUZ5ySirnhSa6/8Acz+CPrdnuJR4bxGM8n3qa2SddCbn0uP9F/Y3xaf2Zq5YlHJm2pfbXtai3zrr5H+hcePVYNdw/QaDh+gn2QnpMizZ1nbjFN4+8+2d2mkpKFva9u581Xo/5E4ZxPPwvUx1Gnm4tqmk63Rfgfpem+ylDHw6MY49Tjw48csT00J/a25NOvgexXy8Eebvnd1156h9lHTaPHjxxjHFjw480o4Him5tw8rUbXTnR+IdrsHDpaHFLNnzRrJSlHEm+nwn9ZxrjWbjOo3z9DBC1ixJ2oL1H5b2t4lHW62ODHzhp7TddZeJ14xjrXi7jg/v3V/s8f4h3HB/fur/AGeP8R8sHWMPqdxwf37q/wBnj/EcNXi0EMael1GfJO+ayYlFV8O5niKhBzkoqrfrEGU1T6X0EpSnJyk25Pq2bOUnUZO9vJElAvD99h+ciC8P32H5yA9/aH+3OIfHz+c+afS7Q/25xD4+fznzQCdO11NlJzk5SbcnzbfiYAAAA1JyaSVt+BhUJyxyUoupLxMbcm23bYGA64ssccMkZY4zclSb/FOQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAe3Bi0EsUXm1Gohk8YwxKSX+e5HTueFe+9V+oX8R84Fo+j3PCvfeq/UL+I/uezmHQx4bg7vLkcZN23jSb5+PM/NT+k7M8SWjjPHqJKGCb9GT90a52amv8AVfAtKtPwvG+CaHRanWvJi3YJ5N0O73x2ypxStypXutpvl4r+P+yPpOF49uTTvH6U+WWM3OcnXpJ3GPR+XI/kuz/abVcPwTw6eUJ4Z/bE3z5rmua+BHxeOcfjm1GXV63NCM8jvav+EenrvN5c85+38n2owcN9sIvJnzwm4K9mFO//AJHxO54V771X6hfxHHiefJqdbly5VUpO0vLwPIeXd+3TH0e54V771X6hfxHk1MdPCaWnyZMkK5ucFF38Fs4gigAIAAAAAAAAAAAAAAAAAAAAAACoQlkmoxVyfRGNOLaaprwAwAAfT3GbiLFmkXuJcibMbAqz6XFH/UuFfo7/ANyR8pyNnlnkUIym2oKopvoiKORnpNNpOlyskrvpRxvGpPY3bQRIJcibCrciXIm0jHIIqy82d5pKUkk0kuSo4tk2FW5Etk2CDbMAAAAAD1abTQzY5ylOmv3HlfUAAAAAAAAAAAAAAFY5vHNSj1RIAvLllmlulX+RAAA1tuk306GFTxyxtKaabV8wJAAAAAAABsdqktybjfNIvO8css3ii442+SbtnMAAdMOSOKTcsammmqZzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB6oQjpYrJkSeV84Qfh5v6jngyQxbpyjumvuU+nws5TnLJJyk25Pm2wPucM7UavQtrK3nxt3U3zXwM/rNN2s0mThGpzyx5I7JwTXLq1Lp8h+bH1MH939b+kYvozM7zi5r28S7W6nWQ7vBHuIeLi/S+U+S37OVv8J/3P5/OeQJ07XUsQap0+oO+bNHPBSkmsy5NrpJet+ZwKAAAAAAXh++w/ORATp2uoH0u0P9ucQ+Pn8580rJknmySyZJOU5O3Ju22SAAAAAAAAAAAAAAAAAANkknyafwAYAAAAAAAAAAAAAAAAAdtTqZ6qanNRTUVH0VXQDiAAOso4Vp4NTk8zb3RrkkcgAB1lglHBHM3HbJtJXz+Q5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOuGEHc8kqhHwXWXkjM2Z5pW6UVyjFdEjmAPr8C1efFqMkIZpxh3OV0pcr2M+XlzZM83PJOU5Pxk7PdwX8LyfEZfoSPnF/B6MeSOSCxZXSX3M/c/yOEo7ZOLptOuTswEAAAAAAAAAAAAAAAAAAAAAAAAAAAam4tNOmvFGAAAAB9DJqJZIwi0qgqVI5bmYC1CwZZjkBbTSTadPxJcg805Y1jcnsTtIgK64sqxyblBTVNUzkzHIluwinJEuTZNmWRXZYZSwSzXHbFpNXzOVmAAAAAAArJJTaaio8q5EgAAAAAAAAAAAAAAAAAdtNmhhm5TxRyJxaqXh5nEAAAAAAAGtuTtuzAAAAAF4cTz5Y44tJydc3SJlFxk4urTrkBhayNY5Y6VN305kAAAAAAAAAAAAAAAtKHdttvffJUQAAAAAAAAAAB2jHC9POUpyWZSW2NcmjiAAAAA7ajTy001Cbi24qXou+oHEAAAAAPqYP7v639IxfRmfLPqYP7v639IxfRmTR8sAFAA2UJQdSTT8wMAAAAAAAAAAAAAAAAAAAAADoskVhlDu4uTd7vFHMAAAAAAAAAAAAAKcUoKW5W30AkAAAAAAAAAAAAAAAAAADpgyRxZYTlBTjF24vozmANk1KUmopJu6XgYdMeWWOM4pKpqnaOYAAAAAAAAAAAAAAAAHR5IvDGHdxUk73eLOYAAAAbGLk0km2/BGFY8ksU1ODakujMlJybbdt9WB0jLF3Ek4yeW1Ur5JHIAAAAAAA+jwX8LyfEZfoSPnFQyTxtuEnFtNWn4PqSAAAAAAAAAAKiotS3Np1ypASAAAAAAAAAAAAAAAAAAAAA64MUcs3GWSONU3cgcgB6WyWzAVIWAYwo3RLdmBgDGzAQAAAAAAAAAAAAAA2NOS3NqPi0YALzKCySWOTlC+TaIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA1JydJWYVDJLG7i2nVEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD24tXCHC9RpWn3mTLCafhSUk/nPEAAAAqEnCSkuqdnXU6l6hx9GkjgAAAAAAAbFqMk2k0n0fiYAOmfJHLlnOMFCMnaivA5gAAAAAAAAAAABWTI8jTaXSuSJAAAAAWoJ4pT3pNOtviyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOmLHHJJqU1BU3bOYAAAAAAAAAAAAAAAAA1JyaSVt9EdM2nyadpZIuN9DnCThKMo8mnaPRq9Vk1Mo769FcqRR5i3BLHGW9Nt1t8UQCAAAAAAAAAAALWNvG52qTrqQAAAAAAAAAAAAAAAAAAAAAAAAAB//9k=";

// --- Audio Engine -------------------------------------------------------------
class AudioEngine {
  constructor() {
    this.ctx = null;
    this.masterMusic = null;
    this.masterSfx = null;
    this.musicVol = 0.6;
    this.sfxVol = 0.8;
    this.musicNodes = [];
    this.musicType = null; // "home" | "game"
    this._homeArpTimer = null;
    this._gameTimer = null;
    // Wire stop-on-close immediately at construction time
    window.addEventListener("beforeunload", () => this.destroy());
    window.addEventListener("pagehide", () => this.destroy());
    document.addEventListener("visibilitychange", () => {
      if (document.hidden) { this._suspendCtx(); } else { this._resumeCtx(); }
    });
  }

  // Create context eagerly so we are ready the moment a gesture fires
  _initCtx() {
    if (this.ctx) return this.ctx;
    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
    this.masterMusic = this.ctx.createGain();
    this.masterSfx   = this.ctx.createGain();
    this.masterMusic.gain.value = this.musicVol;
    this.masterSfx.gain.value   = this.sfxVol;
    this.masterMusic.connect(this.ctx.destination);
    this.masterSfx.connect(this.ctx.destination);
    return this.ctx;
  }

  _ctx() { return this._initCtx(); }

  _suspendCtx() { if (this.ctx && this.ctx.state === "running") this.ctx.suspend().catch(()=>{}); }
  _resumeCtx()  { if (this.ctx && this.ctx.state === "suspended") this.ctx.resume().catch(()=>{}); }

  // Call this inside ANY user-gesture handler to unlock audio
  unlock() {
    const ctx = this._initCtx();
    if (ctx.state === "suspended") {
      ctx.resume().then(() => {
        if (!this.musicType) this.playHomeMusic();
      }).catch(()=>{});
    } else if (ctx.state === "running") {
      if (!this.musicType) this.playHomeMusic();
    }
  }

  destroy() {
    this.stopMusic();
    if (this.ctx) {
      try { this.ctx.close(); } catch(e) {}
      this.ctx = null;
    }
  }

  setMusicVol(v) { // 0..1
    this.musicVol = v;
    if (this.masterMusic) this.masterMusic.gain.setTargetAtTime(v, this._ctx().currentTime, 0.05);
  }

  setSfxVol(v) { // 0..1
    this.sfxVol = v;
    if (this.masterSfx) this.masterSfx.gain.setTargetAtTime(v, this._ctx().currentTime, 0.05);
  }

  stopMusic() {
    if (this._homeArpTimer) { clearTimeout(this._homeArpTimer); this._homeArpTimer = null; }
    if (this._gameTimer)    { clearTimeout(this._gameTimer);    this._gameTimer    = null; }
    this.musicNodes.forEach(n => { try { n.stop(); } catch(e) {} });
    this.musicNodes = [];
    this.musicType = null;
  }

  // Pad + shimmer home screen ambient music
  playHomeMusic() {
    if (this.musicType === "home") return;
    this.stopMusic();
    this.musicType = "home";
    const ctx = this._ctx();
    // Drone chord: D minor feel  D2 F2 A2 C3
    const freqs = [73.4, 87.3, 110, 130.8, 146.8, 174.6, 220, 261.6];
    freqs.forEach((f, i) => {
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      const filt = ctx.createBiquadFilter();
      osc.type = i % 3 === 0 ? "sine" : i % 3 === 1 ? "triangle" : "sine";
      osc.frequency.value = f;
      // slow detune drift
      osc.detune.setValueAtTime(-8 + i * 2, ctx.currentTime);
      osc.detune.linearRampToValueAtTime(8 - i * 2, ctx.currentTime + 12 + i * 3);
      filt.type = "lowpass";
      filt.frequency.value = 900;
      filt.Q.value = 1.2;
      g.gain.setValueAtTime(0, ctx.currentTime);
      g.gain.linearRampToValueAtTime(0.055 - i * 0.004, ctx.currentTime + 2.5 + i * 0.4);
      osc.connect(filt);
      filt.connect(g);
      g.connect(this.masterMusic);
      osc.start();
      this.musicNodes.push(osc);
    });
    // Gentle pulsing arpeggios
    this._scheduleHomeArp();
  }

  _scheduleHomeArp() {
    if (this.musicType !== "home") return;
    const ctx = this._ctx();
    const scale = [293.7, 349.2, 392, 440, 523.3, 587.3]; // D4 F4 G4 A4 C5 D5
    let t = ctx.currentTime + 0.1;
    scale.forEach((f, i) => {
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.type = "sine";
      osc.frequency.value = f;
      g.gain.setValueAtTime(0, t + i * 0.55);
      g.gain.linearRampToValueAtTime(0.038, t + i * 0.55 + 0.08);
      g.gain.exponentialRampToValueAtTime(0.001, t + i * 0.55 + 1.2);
      osc.connect(g);
      g.connect(this.masterMusic);
      osc.start(t + i * 0.55);
      osc.stop(t + i * 0.55 + 1.4);
      this.musicNodes.push(osc);
    });
    const loopDelay = (scale.length * 0.55 + 4.5) * 1000;
    this._homeArpTimer = setTimeout(() => this._scheduleHomeArp(), loopDelay);
  }

  // Pulsing rhythmic game music
  playGameMusic() {
    if (this.musicType === "game") return;
    this.stopMusic();
    this.musicType = "game";
    const ctx = this._ctx();
    // Bass drone
    [55, 82.4, 110].forEach((f, i) => {
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.type = "sawtooth";
      osc.frequency.value = f;
      const filt = ctx.createBiquadFilter();
      filt.type = "lowpass";
      filt.frequency.value = 300 + i * 80;
      filt.Q.value = 2;
      g.gain.value = 0.035 - i * 0.008;
      osc.connect(filt);
      filt.connect(g);
      g.connect(this.masterMusic);
      osc.start();
      this.musicNodes.push(osc);
    });
    // Rhythmic pulse
    this._scheduleGameBeat(ctx.currentTime);
  }

  _scheduleGameBeat(startT) {
    if (this.musicType !== "game") return;
    const ctx = this._ctx();
    const bpm = 108;
    const beat = 60 / bpm;
    const pattern = [220, 0, 293.7, 0, 349.2, 220, 0, 392]; // 0=rest
    for (let i = 0; i < 16; i++) {
      const f = pattern[i % pattern.length];
      if (!f) continue;
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.type = "triangle";
      osc.frequency.value = f * (i > 7 ? 1.5 : 1);
      const t = startT + i * beat;
      g.gain.setValueAtTime(0, t);
      g.gain.linearRampToValueAtTime(0.045, t + 0.02);
      g.gain.exponentialRampToValueAtTime(0.001, t + beat * 0.7);
      osc.connect(g);
      g.connect(this.masterMusic);
      osc.start(t);
      osc.stop(t + beat * 0.9);
      this.musicNodes.push(osc);
    }
    const loopMs = 16 * beat * 1000;
    this._gameTimer = setTimeout(() => {
      if (this.musicType === "game") this._scheduleGameBeat(ctx.currentTime);
    }, loopMs - 100);
  }

  // --- SFX ------------------------------------------------------------------
  _sfx(fn) {
    try { fn(this._ctx(), this.masterSfx); } catch(e) {}
  }

  playDrop() {
    this._sfx((ctx, dest) => {
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.type = "sine";
      osc.frequency.setValueAtTime(520, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(180, ctx.currentTime + 0.18);
      g.gain.setValueAtTime(0.38, ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.22);
      osc.connect(g); g.connect(dest);
      osc.start(); osc.stop(ctx.currentTime + 0.25);
    });
  }

  playHover() {
    this._sfx((ctx, dest) => {
      const osc = ctx.createOscillator();
      const g = ctx.createGain();
      osc.type = "sine";
      osc.frequency.value = 880;
      g.gain.setValueAtTime(0.09, ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.07);
      osc.connect(g); g.connect(dest);
      osc.start(); osc.stop(ctx.currentTime + 0.08);
    });
  }

  playWin() {
    this._sfx((ctx, dest) => {
      const notes = [523.3, 659.3, 784, 1046.5];
      notes.forEach((f, i) => {
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        osc.type = "triangle";
        osc.frequency.value = f;
        const t = ctx.currentTime + i * 0.14;
        g.gain.setValueAtTime(0, t);
        g.gain.linearRampToValueAtTime(0.32, t + 0.04);
        g.gain.exponentialRampToValueAtTime(0.001, t + 0.55);
        osc.connect(g); g.connect(dest);
        osc.start(t); osc.stop(t + 0.6);
      });
    });
  }

  playDraw() {
    this._sfx((ctx, dest) => {
      [392, 370, 349, 330].forEach((f, i) => {
        const osc = ctx.createOscillator();
        const g = ctx.createGain();
        osc.type = "sine";
        osc.frequency.value = f;
        const t = ctx.currentTime + i * 0.12;
        g.gain.setValueAtTime(0.22, t);
        g.gain.exponentialRampToValueAtTime(0.001, t + 0.35);
        osc.connect(g); g.connect(dest);
        osc.start(t); osc.stop(t + 0.4);
      });
    });
  }

  playClick() {
    this._sfx((ctx, dest) => {
      const buf = ctx.createBuffer(1, ctx.sampleRate * 0.04, ctx.sampleRate);
      const d = buf.getChannelData(0);
      for (let i = 0; i < d.length; i++) d[i] = (Math.random() * 2 - 1) * Math.exp(-i / (d.length * 0.3));
      const src = ctx.createBufferSource();
      const g = ctx.createGain();
      const filt = ctx.createBiquadFilter();
      filt.type = "bandpass"; filt.frequency.value = 1800; filt.Q.value = 0.8;
      src.buffer = buf;
      g.gain.value = 0.28;
      src.connect(filt); filt.connect(g); g.connect(dest);
      src.start();
    });
  }

}

const audio = new AudioEngine();

// --- Pre-computed star data ---------------------------------------------------
const BOARD_BG_STARS = Array.from({length:55},(_,i)=>({
  x:(Math.sin(i*7.3)*.5+.5)*96+2, y:(Math.cos(i*5.1)*.5+.5)*96+2,
  r:Math.abs(Math.sin(i*3.7))*.85+.28, op:Math.abs(Math.cos(i*4.1))*.32+.07,
  tw:2+Math.abs(Math.sin(i*2.3))*3, dl:Math.abs(Math.cos(i*6.7))*4,
}));
const STAR_FIELD_DATA = Array.from({length:220},(_,i)=>({
  x:(Math.sin(i*127.1+1.3)*.5+.5)*100, y:(Math.cos(i*311.7+2.1)*.5+.5)*100,
  r:Math.abs(Math.sin(i*73.3))*1.5+.25, op:Math.abs(Math.cos(i*59.9))*.55+.35,
  tw:2.5+Math.abs(Math.sin(i*41.1))*4, dl:Math.abs(Math.cos(i*83.7))*5,
  col:i%14===0?"#ffe8c0":i%19===0?"#c8d8ff":i%23===0?"#ffd0d0":"white",
}));
const BRIGHT_STAR_DATA = Array.from({length:18},(_,i)=>({
  x:(Math.sin(i*223.9+5.1)*.5+.5)*96+2, y:(Math.cos(i*179.3+3.7)*.5+.5)*96+2,
  r:1.4+Math.abs(Math.sin(i*61.1))*.8, op:.7+Math.abs(Math.cos(i*43.3))*.3,
  tw:1.8+Math.abs(Math.sin(i*37.7))*2, dl:Math.abs(Math.cos(i*97.1))*3,
  col:i%3===0?"#fff8e8":i%3===1?"#e8eeff":"white",
}));

// --- Star Field ---------------------------------------------------------------
function StarField() {
  return (
    <svg style={{position:"absolute",inset:0,width:"100%",height:"100%",pointerEvents:"none"}}>
      {STAR_FIELD_DATA.map((s,i)=>(
        <circle key={i} cx={`${s.x}%`} cy={`${s.y}%`} r={s.r} fill={s.col} opacity={s.op}
          style={{animation:`twinkle ${s.tw}s ease-in-out ${s.dl}s infinite alternate`}}/>
      ))}
      {BRIGHT_STAR_DATA.map((s,i)=>(
        <g key={`b${i}`}>
          <circle cx={`${s.x}%`} cy={`${s.y}%`} r={s.r*1.8} fill={s.col} opacity={.12}/>
          <circle cx={`${s.x}%`} cy={`${s.y}%`} r={s.r} fill={s.col} opacity={s.op}
            style={{animation:`twinkle ${s.tw}s ease-in-out ${s.dl}s infinite alternate`}}/>
          <line x1={`${s.x-.5}%`} y1={`${s.y}%`} x2={`${s.x+.5}%`} y2={`${s.y}%`} stroke={s.col} strokeWidth=".5" opacity=".35"/>
          <line x1={`${s.x}%`} y1={`${s.y-.7}%`} x2={`${s.x}%`} y2={`${s.y+.7}%`} stroke={s.col} strokeWidth=".5" opacity=".35"/>
        </g>
      ))}
    </svg>
  );
}

// --- Star Cell ----------------------------------------------------------------
function StarCell({ size, seed }) {
  const pts = useMemo(()=>Array.from({length:8},(_,i)=>({
    x:((Math.sin(seed*7.3+i*31.7)*.5+.5)*86+7),
    y:((Math.cos(seed*5.1+i*23.4)*.5+.5)*86+7),
    r:Math.abs(Math.sin(seed*3.7+i*17.1))*.9+.35,
    op:Math.abs(Math.cos(seed*4.1+i*29.3))*.42+.48,
    tw:2+Math.abs(Math.sin(seed*2.3+i*11.9))*3,
    dl:Math.abs(Math.cos(seed*6.7+i*7.8))*4,
  })),[seed]);
  const ring = useMemo(()=>Array.from({length:22},(_,i)=>{
    const a=(i/22)*Math.PI*2;
    return{bx:size/2+(size/2-2.2)*Math.cos(a),by:size/2+(size/2-2.2)*Math.sin(a),
      r:i%4===0?1.5:i%2===0?.9:.55,op:i%4===0?.95:i%2===0?.65:.38};
  }),[size]);
  return (
    <svg width={size} height={size} viewBox={`0 0 ${size} ${size}`}
      style={{position:"absolute",inset:0,pointerEvents:"none"}}>
      {ring.map((b,i)=><circle key={i} cx={b.bx} cy={b.by} r={b.r} fill="white" opacity={b.op}/>)}
      {pts.map((s,i)=>(
        <circle key={`s${i}`} cx={`${s.x}%`} cy={`${s.y}%`} r={s.r} fill="white" opacity={s.op}
          style={{animation:`twinkle ${s.tw}s ease-in-out ${s.dl}s infinite alternate`}}/>
      ))}
    </svg>
  );
}

// --- Backgrounds & Celestials -------------------------------------------------
function SpaceBackground({ bgKey }) {
  if (bgKey === "Galaxy") return (
    <div style={{position:"absolute",inset:0,overflow:"hidden",background:"#00000a"}}>
      <img src={MILKYWAY_IMG} alt="" style={{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",opacity:.92}}/>
      <div style={{position:"absolute",inset:0,background:"rgba(0,0,8,0.18)"}}/>
      <StarField/>
    </div>
  );
  return (
    <div style={{position:"absolute",inset:0,overflow:"hidden",background:"linear-gradient(160deg,#000008 0%,#03001a 50%,#000008 100%)"}}>
      <StarField/>
      {/* 4 mini astronauts floating at different spots */}
      <MiniAstronaut id="a1" x="12%" y="14%" scale={0.38} rotate={-18} floatDur={7.2} floatDelay={0}   rotateDur={22}/>
      <MiniAstronaut id="a2" x="78%" y="8%"  scale={0.28} rotate={12}  floatDur={9.0} floatDelay={1.5} rotateDur={30}/>
      <MiniAstronaut id="a3" x="82%" y="68%" scale={0.44} rotate={6}   floatDur={8.1} floatDelay={0.8} rotateDur={26}/>
      <MiniAstronaut id="a4" x="6%"  y="72%" scale={0.32} rotate={-8}  floatDur={6.8} floatDelay={2.2} rotateDur={35}/>
      {/* Tether lines between astronauts 1 and 4 */}
      <svg style={{position:"absolute",inset:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"}}>
        <line x1="14%" y1="20%" x2="10%" y2="74%"
          stroke="rgba(200,215,255,0.18)" strokeWidth="1" strokeDasharray="6,8"/>
        <line x1="82%" y1="15%" x2="86%" y2="66%"
          stroke="rgba(200,215,255,0.14)" strokeWidth="1" strokeDasharray="5,9"/>
      </svg>
      {/* Distant Earth bottom-right */}
      <svg viewBox="0 0 400 400" style={{position:"absolute",right:"-8%",bottom:"-18%",width:"clamp(160px,36vw,280px)",height:"clamp(160px,36vw,280px)",pointerEvents:"none",opacity:0.7}}>
        <defs>
          <radialGradient id="mEarth" cx="36%" cy="28%" r="70%">
            <stop offset="0%" stopColor="#8ed4f8"/><stop offset="30%" stopColor="#1a72cc"/>
            <stop offset="70%" stopColor="#0a2888"/><stop offset="100%" stopColor="#040e32"/>
          </radialGradient>
          <radialGradient id="mAtmo" cx="50%" cy="50%" r="50%">
            <stop offset="74%" stopColor="transparent"/>
            <stop offset="90%" stopColor="rgba(90,170,255,0.45)"/>
            <stop offset="100%" stopColor="transparent"/>
          </radialGradient>
          <clipPath id="mEarthClip"><circle cx="200" cy="200" r="165"/></clipPath>
        </defs>
        <circle cx="200" cy="200" r="165" fill="url(#mEarth)"/>
        <g clipPath="url(#mEarthClip)">
          <ellipse cx="155" cy="155" rx="42" ry="32" fill="rgba(30,115,30,0.78)"/>
          <ellipse cx="215" cy="185" rx="30" ry="22" fill="rgba(30,115,30,0.70)"/>
          <ellipse cx="245" cy="225" rx="24" ry="18" fill="rgba(30,115,30,0.64)"/>
          <ellipse cx="160" cy="100" rx="60" ry="14" fill="rgba(255,255,255,0.42)"/>
          <ellipse cx="210" cy="145" rx="48" ry="12" fill="rgba(255,255,255,0.32)"/>
          <ellipse cx="190" cy="240" rx="65" ry="14" fill="rgba(255,255,255,0.28)"/>
        </g>
        <circle cx="200" cy="200" r="165" fill="url(#mAtmo)"/>
        <circle cx="200" cy="200" r="168" fill="none" stroke="rgba(100,185,255,0.30)" strokeWidth="7"/>
      </svg>
      {/* Faint sun-glare top-right */}
      <div style={{position:"absolute",top:"-6%",right:"-4%",width:"clamp(120px,28vw,220px)",height:"clamp(120px,28vw,220px)",
        borderRadius:"50%",background:"radial-gradient(circle,rgba(255,240,180,0.22) 0%,rgba(255,200,80,0.06) 50%,transparent 70%)",
        pointerEvents:"none"}}/>
    </div>
  );
}

// --- Mini Astronaut Component -----------------------------------------------
function MiniAstronaut({ id, x, y, scale, rotate, floatDur, floatDelay, rotateDur }) {
  const animName = `float_${id}`;
  const rotName  = `slowrot_${id}`;
  // Unique keyframes injected inline via a style tag
  const kf = `
    @keyframes ${animName} {
      0%,100%{transform:translate(0px,-10px) rotate(${rotate}deg);}
      50%{transform:translate(4px,10px) rotate(${rotate+4}deg);}
    }
    @keyframes ${rotName} {
      from{transform:rotate(${rotate}deg);}
      to{transform:rotate(${rotate+360}deg);}
    }
  `;
  // viewBox is centred on the astronaut body (roughly 120x200 units)
  const W=120, H=200;
  return (
    <>
      <style>{kf}</style>
      <div style={{
        position:"absolute", left:x, top:y,
        width: W*scale, height: H*scale,
        transform:`rotate(${rotate}deg)`,
        transformOrigin:"center center",
        animation:`${animName} ${floatDur}s ease-in-out ${floatDelay}s infinite`,
        pointerEvents:"none", filter:"drop-shadow(0 0 6px rgba(200,220,255,0.35))",
      }}>
        <svg viewBox={`0 0 ${W} ${H}`} width={W*scale} height={H*scale}
          style={{overflow:"visible"}}>
          <defs>
            <radialGradient id={`s${id}`} cx="35%" cy="25%" r="70%">
              <stop offset="0%" stopColor="#f0f4ff"/>
              <stop offset="45%" stopColor="#c8d0e8"/>
              <stop offset="100%" stopColor="#6a7282"/>
            </radialGradient>
            <radialGradient id={`sh${id}`} cx="50%" cy="50%" r="50%">
              <stop offset="60%" stopColor="transparent"/>
              <stop offset="100%" stopColor="rgba(0,0,20,0.55)"/>
            </radialGradient>
            <radialGradient id={`h${id}`} cx="34%" cy="26%" r="67%">
              <stop offset="0%" stopColor="#f0f4ff"/>
              <stop offset="40%" stopColor="#bcc8e0"/>
              <stop offset="100%" stopColor="#5a6270"/>
            </radialGradient>
            <radialGradient id={`v${id}`} cx="34%" cy="28%" r="67%">
              <stop offset="0%" stopColor="#ffd858"/>
              <stop offset="25%" stopColor="#cc8c08"/>
              <stop offset="55%" stopColor="#6e2c00"/>
              <stop offset="100%" stopColor="#1e0600"/>
            </radialGradient>
            <radialGradient id={`g${id}`} cx="38%" cy="28%" r="67%">
              <stop offset="0%" stopColor="#e2eaff"/>
              <stop offset="52%" stopColor="#9ca4be"/>
              <stop offset="100%" stopColor="#4c5468"/>
            </radialGradient>
            <linearGradient id={`p${id}`} x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stopColor="#d2daf2"/>
              <stop offset="55%" stopColor="#8e98b2"/>
              <stop offset="100%" stopColor="#4e5666"/>
            </linearGradient>
            <clipPath id={`vc${id}`}><ellipse cx="60" cy="54" rx="20" ry="17"/></clipPath>
          </defs>

          {/* PLSS backpack */}
          <rect x="42" y="72" width="36" height="48" rx="5" fill={`url(#p${id})`}/>
          <rect x="44" y="74" width="32" height="44" rx="4" fill="none" stroke="rgba(255,255,255,0.14)" strokeWidth="0.5"/>
          <rect x="46" y="80" width="24" height="4" rx="1.5" fill="rgba(178,188,212,0.55)"/>
          <rect x="46" y="88" width="24" height="4" rx="1.5" fill="rgba(178,188,212,0.45)"/>
          <rect x="42" y="72" width="36" height="48" rx="5" fill={`url(#sh${id})`}/>

          {/* Torso */}
          <ellipse cx="60" cy="120" rx="22" ry="12" fill={`url(#s${id})`}/>
          <ellipse cx="60" cy="120" rx="22" ry="12" fill={`url(#sh${id})`}/>
          {/* Chest plate */}
          <ellipse cx="60" cy="106" rx="26" ry="30" fill={`url(#s${id})`}/>
          <ellipse cx="60" cy="106" rx="26" ry="30" fill={`url(#sh${id})`}/>
          {/* Chest display */}
          <rect x="48" y="95" width="24" height="18" rx="2.5" fill="rgba(28,36,58,0.88)"/>
          <rect x="49" y="96" width="22" height="6" rx="1" fill="rgba(0,195,78,0.65)"/>
          <circle cx="52" cy="107" r="2" fill="rgba(255,75,75,0.85)"/>
          <circle cx="57" cy="107" r="2" fill="rgba(255,198,0,0.85)"/>
          <circle cx="62" cy="107" r="2" fill="rgba(0,198,255,0.85)"/>
          <circle cx="67" cy="107" r="2" fill="rgba(75,255,75,0.85)"/>

          {/* Left arm */}
          <ellipse cx="33" cy="95" rx="8" ry="20" fill={`url(#s${id})`} transform="rotate(-25,33,95)"/>
          <ellipse cx="33" cy="95" rx="8" ry="20" fill={`url(#sh${id})`} transform="rotate(-25,33,95)"/>
          {/* Left glove */}
          <ellipse cx="22" cy="76" rx="7" ry="11" fill={`url(#g${id})`} transform="rotate(-18,22,76)"/>
          <ellipse cx="15" cy="68" rx="3" ry="6" fill={`url(#g${id})`} transform="rotate(-22,15,68)"/>
          <ellipse cx="20" cy="64" rx="3" ry="6" fill={`url(#g${id})`} transform="rotate(-12,20,64)"/>

          {/* Right arm */}
          <ellipse cx="87" cy="95" rx="8" ry="20" fill={`url(#s${id})`} transform="rotate(25,87,95)"/>
          <ellipse cx="87" cy="95" rx="8" ry="20" fill={`url(#sh${id})`} transform="rotate(25,87,95)"/>
          {/* Right glove */}
          <ellipse cx="98" cy="76" rx="7" ry="11" fill={`url(#g${id})`} transform="rotate(18,98,76)"/>
          <ellipse cx="105" cy="68" rx="3" ry="6" fill={`url(#g${id})`} transform="rotate(22,105,68)"/>
          <ellipse cx="100" cy="64" rx="3" ry="6" fill={`url(#g${id})`} transform="rotate(12,100,64)"/>

          {/* Legs */}
          <rect x="44" y="130" width="16" height="32" rx="8" fill={`url(#s${id})`}/>
          <rect x="44" y="130" width="16" height="32" rx="8" fill={`url(#sh${id})`}/>
          <rect x="62" y="130" width="16" height="32" rx="8" fill={`url(#s${id})`}/>
          <rect x="62" y="130" width="16" height="32" rx="8" fill={`url(#sh${id})`}/>
          {/* Boots */}
          <ellipse cx="52" cy="162" rx="10" ry="5" fill="#464c5e"/>
          <ellipse cx="68" cy="162" rx="10" ry="5" fill="#464c5e"/>

          {/* Neck ring */}
          <ellipse cx="60" cy="74" rx="16" ry="6" fill="rgba(145,154,176,0.88)"/>
          <ellipse cx="60" cy="74" rx="14" ry="5" fill="rgba(178,186,210,0.62)"/>

          {/* Helmet */}
          <ellipse cx="60" cy="56" rx="26" ry="24" fill={`url(#h${id})`}/>
          <ellipse cx="60" cy="56" rx="26" ry="24" fill={`url(#sh${id})`}/>
          {/* Helmet stripe */}
          <path d="M 36,64 Q 36,32 60,32 Q 84,32 84,64"
            fill="none" stroke="rgba(255,95,0,0.72)" strokeWidth="2"/>

          {/* Visor */}
          <ellipse cx="60" cy="54" rx="20" ry="17" fill={`url(#v${id})`}/>
          <g clipPath={`url(#vc${id})`}>
            <ellipse cx="60" cy="54" rx="20" ry="17" fill="rgba(70,130,255,0.22)"/>
            <circle cx="52" cy="47" r="2.5" fill="rgba(255,255,255,0.18)"/>
          </g>
          <ellipse cx="60" cy="54" rx="20" ry="17" fill="none"
            stroke="rgba(178,145,78,0.58)" strokeWidth="1.2"/>

          {/* Helmet lights */}
          <ellipse cx="38" cy="55" rx="4" ry="3" fill="rgba(255,242,185,0.7)"/>
          <ellipse cx="82" cy="55" rx="4" ry="3" fill="rgba(255,242,185,0.7)"/>

          {/* Flag patch (left arm) */}
          <rect x="25" y="88" width="9" height="6" rx="1" fill="#b22234"/>
          <rect x="25" y="90" width="9" height="2" fill="white"/>
          <rect x="25" y="92" width="9" height="2" rx=".5" fill="#3c3b6e"/>
          <rect x="25" y="88" width="3.5" height="4" rx=".5" fill="#3c3b6e"/>
          <circle cx="26" cy="89.2" r=".35" fill="white"/>
          <circle cx="27.2" cy="89.2" r=".35" fill="white"/>
          <circle cx="28.4" cy="89.2" r=".35" fill="white"/>
        </svg>
      </div>
    </>
  );
}

const CELESTIAL = {
  Mercury:{color:"#b5b5b5"},Venus:{color:"#e8c97e"},Earth:{color:"#4fa3e0"},
  Mars:{color:"#c1440e"},Jupiter:{color:"#c88b3a"},Saturn:{color:"#e4d191"},
  Uranus:{color:"#7de8e8"},Neptune:{color:"#4b70dd"},Pluto:{color:"#a0785a"},
  Eris:{color:"#c0b0a0"},Ceres:{color:"#bda98a"},Sun:{color:"#ffd700"},Moon:{color:"#e8e8d0"},
};
const CELESTIAL_KEYS = Object.keys(CELESTIAL);

const GRIDS = {
  Nebula:        {label:"Nebula",      color:"rgba(100,45,185,0.42)",border:"rgba(155,75,255,0.82)",type:"normal"},
  Pulsar:        {label:"Pulsar",      color:"rgba(0,165,190,0.28)", border:"rgba(0,220,248,0.82)", type:"normal"},
  "Solar Flare": {label:"Solar Flare",color:"rgba(188,72,0,0.28)",  border:"rgba(248,122,0,0.82)", type:"normal"},
  "Dark Matter": {label:"Dark Matter",color:"rgba(12,12,32,0.72)",  border:"rgba(75,75,152,0.62)", type:"normal"},
  "Star Field":  {label:"Star Field", color:"rgba(2,2,16,0.82)",    border:"stars",               type:"stars"},
};
const GRID_KEYS = Object.keys(GRIDS);
const BG_KEYS = ["Galaxy","Astronauts"];

// --- Planet Token -------------------------------------------------------------
function PlanetToken({ type, size=40, glow=false, showName=false }) {
  const id=`pt${type}${Math.round(size)}`;
  const s=size,c=s/2,r=s*.43;
  const GC={Mercury:"#c8bfb0",Venus:"#e8c97e",Earth:"#4fa3e0",Mars:"#d45a2a",Jupiter:"#c88b3a",Saturn:"#e4d191",Uranus:"#7de8e8",Neptune:"#4b70dd",Pluto:"#b08870",Eris:"#d0c0b0",Ceres:"#c0a880",Sun:"#ffd700",Moon:"#d8d8c0"};
  const gc=GC[type]||"#fff";
  const gf=glow?{filter:`drop-shadow(0 0 ${s*.22}px ${gc}) drop-shadow(0 0 ${s*.08}px ${gc})`}:{};
  return (
    <div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:2,flexShrink:0}}>
      <div style={{width:s,height:s,display:"flex",alignItems:"center",justifyContent:"center",...gf}}>
        <svg width={s} height={s} viewBox={`0 0 ${s} ${s}`} style={{overflow:"visible"}}>
          <defs>
            {type==="Mercury"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#e0d4c4"/><stop offset="35%" stopColor="#a89888"/><stop offset="100%" stopColor="#3e3428"/></radialGradient>}
            {type==="Venus"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#faf0b0"/><stop offset="30%" stopColor="#dca83a"/><stop offset="65%" stopColor="#a86818"/><stop offset="100%" stopColor="#583008"/></radialGradient>}
            {type==="Earth"&&<><radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#90d8f0"/><stop offset="38%" stopColor="#1870c0"/><stop offset="100%" stopColor="#081e48"/></radialGradient><radialGradient id={`${id}at`} cx="50%" cy="50%" r="50%"><stop offset="76%" stopColor="transparent"/><stop offset="100%" stopColor="rgba(80,160,255,0.38)"/></radialGradient></>}
            {type==="Mars"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#f09070"/><stop offset="38%" stopColor="#c84010"/><stop offset="100%" stopColor="#521400"/></radialGradient>}
            {type==="Jupiter"&&<><radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#ecdcb0"/><stop offset="48%" stopColor="#cc9048"/><stop offset="100%" stopColor="#623808"/></radialGradient><clipPath id={`${id}cl`}><circle cx={c} cy={c} r={r}/></clipPath></>}
            {type==="Saturn"&&<><radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#f8f0c0"/><stop offset="42%" stopColor="#caa850"/><stop offset="100%" stopColor="#685010"/></radialGradient><clipPath id={`${id}cl`}><circle cx={c} cy={c} r={r}/></clipPath></>}
            {type==="Uranus"&&<><radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#d0f8f8"/><stop offset="38%" stopColor="#48c8d0"/><stop offset="100%" stopColor="#0c3848"/></radialGradient><radialGradient id={`${id}at`} cx="50%" cy="50%" r="50%"><stop offset="76%" stopColor="transparent"/><stop offset="100%" stopColor="rgba(70,200,220,0.32)"/></radialGradient><clipPath id={`${id}cl`}><circle cx={c} cy={c} r={r}/></clipPath></>}
            {type==="Neptune"&&<><radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#90a0f0"/><stop offset="38%" stopColor="#1840c0"/><stop offset="100%" stopColor="#060820"/></radialGradient><clipPath id={`${id}cl`}><circle cx={c} cy={c} r={r}/></clipPath></>}
            {type==="Pluto"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#dcc8a8"/><stop offset="38%" stopColor="#a87858"/><stop offset="100%" stopColor="#3c2010"/></radialGradient>}
            {type==="Eris"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#eee8e0"/><stop offset="42%" stopColor="#b8b0a0"/><stop offset="100%" stopColor="#3c3830"/></radialGradient>}
            {type==="Ceres"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#d8d0b8"/><stop offset="38%" stopColor="#a89068"/><stop offset="100%" stopColor="#382c18"/></radialGradient>}
            {type==="Sun"&&<><radialGradient id={`${id}g`} cx="38%" cy="32%" r="65%"><stop offset="0%" stopColor="#fffce0"/><stop offset="25%" stopColor="#ffe840"/><stop offset="65%" stopColor="#ff9000"/><stop offset="100%" stopColor="#c84000"/></radialGradient><radialGradient id={`${id}co`} cx="50%" cy="50%" r="50%"><stop offset="74%" stopColor="transparent"/><stop offset="100%" stopColor="rgba(255,180,0,0.3)"/></radialGradient><clipPath id={`${id}cl`}><circle cx={c} cy={c} r={r}/></clipPath></>}
            {type==="Moon"&&<radialGradient id={`${id}g`} cx="32%" cy="25%" r="68%"><stop offset="0%" stopColor="#f4f0e8"/><stop offset="38%" stopColor="#c0b8a8"/><stop offset="100%" stopColor="#484038"/></radialGradient>}
            <radialGradient id={`${id}sp`} cx="28%" cy="20%" r="36%"><stop offset="0%" stopColor="rgba(255,255,255,0.55)"/><stop offset="100%" stopColor="transparent"/></radialGradient>
            <radialGradient id={`${id}li`} cx="50%" cy="50%" r="50%"><stop offset="68%" stopColor="transparent"/><stop offset="100%" stopColor="rgba(0,0,0,0.78)"/></radialGradient>
            <clipPath id={`${id}mc`}><circle cx={c} cy={c} r={r}/></clipPath>
          </defs>
          {type==="Sun"&&<>{[0,22,45,67,90,112,135,157,180,202,225,247,270,292,315,337].map(a=><line key={a} x1={c+(r+1)*Math.cos(a*Math.PI/180)} y1={c+(r+1)*Math.sin(a*Math.PI/180)} x2={c+(r+s*.13)*Math.cos(a*Math.PI/180)} y2={c+(r+s*.13)*Math.sin(a*Math.PI/180)} stroke="#ffcc00" strokeWidth={s*.022} strokeLinecap="round" opacity="0.72"/>)}<circle cx={c} cy={c} r={r+s*.05} fill={`url(#${id}co)`}/></>}
          {type==="Saturn"&&<ellipse cx={c} cy={c+r*.2} rx={r*1.75} ry={r*.37} fill="none" stroke="rgba(180,152,62,0.62)" strokeWidth={r*.3} opacity="0.58"/>}
          <circle cx={c} cy={c} r={r} fill={`url(#${id}g)`}/>
          {type==="Mercury"&&<g clipPath={`url(#${id}mc)`}>{[[.30,.33,.083],[.63,.50,.062],[.44,.65,.052],[.54,.26,.042],[.26,.54,.072],[.70,.70,.048]].map(([ox,oy,cr],i)=><circle key={i} cx={c+(ox-.5)*r*1.75} cy={c+(oy-.5)*r*1.75} r={cr*s} fill="rgba(0,0,0,0.3)"/>)}</g>}
          {type==="Venus"&&<g clipPath={`url(#${id}mc)`}>{[.25,.38,.52,.65,.78].map((y,i)=><ellipse key={i} cx={c} cy={c+(y-.5)*r*2.1} rx={r*.9} ry={r*.1} fill={i%2===0?"rgba(200,138,28,0.36)":"rgba(158,88,8,0.26)"}/>)}</g>}
          {type==="Earth"&&<><g clipPath={`url(#${id}mc)`}><ellipse cx={c-r*.27} cy={c-r*.08} rx={r*.3} ry={r*.4} fill="rgba(30,130,30,0.88)"/><ellipse cx={c+r*.18} cy={c+r*.22} rx={r*.34} ry={r*.28} fill="rgba(30,130,30,0.82)"/><ellipse cx={c+r*.37} cy={c-r*.33} rx={r*.17} ry={r*.22} fill="rgba(30,130,30,0.78)"/><ellipse cx={c} cy={c-r*.85} rx={r*.5} ry={r*.13} fill="rgba(240,250,255,0.92)"/><ellipse cx={c} cy={c+r*.88} rx={r*.39} ry={r*.11} fill="rgba(240,250,255,0.82)"/><ellipse cx={c+r*.1} cy={c-r*.43} rx={r*.39} ry={r*.08} fill="rgba(255,255,255,0.46)"/><ellipse cx={c-r*.19} cy={c+r*.53} rx={r*.33} ry={r*.07} fill="rgba(255,255,255,0.37)"/></g><circle cx={c} cy={c} r={r} fill={`url(#${id}at)`}/></>}
          {type==="Mars"&&<g clipPath={`url(#${id}mc)`}><ellipse cx={c+r*.12} cy={c+r*.18} rx={r*.45} ry={r*.25} fill="rgba(75,18,0,0.42)"/><ellipse cx={c-r*.2} cy={c-r*.23} rx={r*.2} ry={r*.18} fill="rgba(95,28,0,0.35)"/><ellipse cx={c} cy={c-r*.84} rx={r*.37} ry={r*.12} fill="rgba(232,240,255,0.88)"/></g>}
          {type==="Jupiter"&&<g clipPath={`url(#${id}cl)`}>{[[-.58,.115,.32],[-.34,.105,.36],[-.11,.112,.38],[.12,.105,.35],[.35,.112,.34],[.57,.105,.31]].map(([dy,h,op],i)=><ellipse key={i} cx={c} cy={c+dy*r} rx={r} ry={r*h} fill={i%2===0?`rgba(155,75,18,${op})`:`rgba(75,28,5,${op})`}/>)}<ellipse cx={c+r*.27} cy={c+r*.24} rx={r*.23} ry={r*.12} fill="rgba(175,48,18,0.72)"/><ellipse cx={c+r*.27} cy={c+r*.24} rx={r*.13} ry={r*.07} fill="rgba(198,78,28,0.5)"/></g>}
          {type==="Saturn"&&<g clipPath={`url(#${id}cl)`}>{[[-.52,.1,.29],[-.28,.09,.33],[0,.1,.30],[.28,.09,.33],[.52,.1,.29]].map(([dy,h,op],i)=><ellipse key={i} cx={c} cy={c+dy*r} rx={r} ry={r*h} fill={i%2===0?`rgba(178,138,38,${op})`:`rgba(128,98,18,${op})`}/>)}</g>}
          {type==="Uranus"&&<><g clipPath={`url(#${id}cl)`}>{[[-.38,.12,.18],[-.1,.11,.17],[.2,.12,.18],[.5,.11,.17]].map(([dy,h,op],i)=><ellipse key={i} cx={c} cy={c+dy*r} rx={r} ry={r*h} fill={`rgba(75,185,195,${op})`}/>)}</g><circle cx={c} cy={c} r={r} fill={`url(#${id}at)`}/></>}
          {type==="Neptune"&&<g clipPath={`url(#${id}cl)`}>{[[-.38,.12,.37],[-.1,.10,.41],[.22,.12,.37]].map(([dy,h,op],i)=><ellipse key={i} cx={c} cy={c+dy*r} rx={r} ry={r*h} fill={`rgba(38,58,175,${op})`}/>)}<ellipse cx={c-r*.2} cy={c-r*.17} rx={r*.19} ry={r*.11} fill="rgba(8,18,72,0.72)"/></g>}
          {type==="Moon"&&<g clipPath={`url(#${id}mc)`}>{[[.22,.30,.09],[.62,.56,.07],[.36,.67,.05],[.50,.20,.08],[.72,.36,.06],[.26,.53,.07],[.48,.72,.05]].map(([ox,oy,cr],i)=><circle key={i} cx={c+(ox-.5)*r*1.85} cy={c+(oy-.5)*r*1.85} r={cr*s} fill="rgba(0,0,0,0.28)"/>)}</g>}
          {type==="Pluto"&&<g clipPath={`url(#${id}mc)`}><ellipse cx={c+r*.06} cy={c-r*.12} rx={r*.46} ry={r*.38} fill="rgba(198,168,128,0.58)"/><ellipse cx={c} cy={c+r*.62} rx={r*.55} ry={r*.22} fill="rgba(75,38,18,0.4)"/></g>}
          {type==="Eris"&&<g clipPath={`url(#${id}mc)`}><ellipse cx={c} cy={c-r*.52} rx={r*.7} ry={r*.29} fill="rgba(228,218,208,0.5)"/>{[[.30,.34,.06],[.65,.60,.05],[.44,.70,.04]].map(([ox,oy,cr],i)=><circle key={i} cx={c+(ox-.5)*r*1.65} cy={c+(oy-.5)*r*1.65} r={cr*s} fill="rgba(0,0,0,0.2)"/>)}</g>}
          {type==="Ceres"&&<g clipPath={`url(#${id}mc)`}>{[[.34,.40,.07],[.60,.55,.05],[.44,.65,.04],[.54,.30,.06]].map(([ox,oy,cr],i)=><circle key={i} cx={c+(ox-.5)*r*1.65} cy={c+(oy-.5)*r*1.65} r={cr*s} fill="rgba(0,0,0,0.26)"/>)}<circle cx={c+r*.21} cy={c-r*.11} r={r*.072} fill="rgba(255,255,255,0.72)"/></g>}
          {type==="Sun"&&<g clipPath={`url(#${id}cl)`}>{[[.2,.2],[.7,.3],[.4,.7],[.6,.6],[.3,.5],[.8,.7],[.5,.35],[.15,.6]].map(([ox,oy],i)=><circle key={i} cx={c+(ox-.5)*r*1.6} cy={c+(oy-.5)*r*1.6} r={r*.17} fill="rgba(255,198,0,0.22)"/>)}<circle cx={c-r*.23} cy={c+r*.17} r={r*.1} fill="rgba(175,58,0,0.52)"/><circle cx={c+r*.31} cy={c-r*.23} r={r*.07} fill="rgba(175,58,0,0.46)"/></g>}
          <circle cx={c} cy={c} r={r} fill={`url(#${id}li)`}/>
          <circle cx={c} cy={c} r={r} fill={`url(#${id}sp)`}/>
        </svg>
      </div>
      {showName&&<span style={{fontSize:Math.max(8,s*.22),color:"#d0c8e8",fontFamily:"'Exo 2',sans-serif",fontWeight:600,letterSpacing:".05em",textAlign:"center",lineHeight:1,textShadow:"0 1px 4px rgba(0,0,0,0.9)",whiteSpace:"nowrap"}}>{type}</span>}
    </div>
  );
}

// --- Game Logic ---------------------------------------------------------------
const ROWS=6,COLS=7;
const emptyBoard=()=>Array(ROWS).fill(null).map(()=>Array(COLS).fill(null));
function dropPiece(board,col,player){const nb=board.map(r=>[...r]);for(let r=ROWS-1;r>=0;r--){if(!nb[r][col]){nb[r][col]=player;return{board:nb,row:r};}}return null;}
function checkWin(board,player){
  for(let r=0;r<ROWS;r++)for(let c=0;c<=COLS-4;c++)if([0,1,2,3].every(i=>board[r][c+i]===player))return true;
  for(let r=0;r<=ROWS-4;r++)for(let c=0;c<COLS;c++)if([0,1,2,3].every(i=>board[r+i][c]===player))return true;
  for(let r=3;r<ROWS;r++)for(let c=0;c<=COLS-4;c++)if([0,1,2,3].every(i=>board[r-i][c+i]===player))return true;
  for(let r=0;r<=ROWS-4;r++)for(let c=0;c<=COLS-4;c++)if([0,1,2,3].every(i=>board[r+i][c+i]===player))return true;
  return false;
}
function getWinCells(board,player){
  const chk=cells=>cells.every(([r,c])=>board[r]?.[c]===player);
  for(let r=0;r<ROWS;r++)for(let c=0;c<=COLS-4;c++){const cl=[[r,c],[r,c+1],[r,c+2],[r,c+3]];if(chk(cl))return cl;}
  for(let r=0;r<=ROWS-4;r++)for(let c=0;c<COLS;c++){const cl=[[r,c],[r+1,c],[r+2,c],[r+3,c]];if(chk(cl))return cl;}
  for(let r=3;r<ROWS;r++)for(let c=0;c<=COLS-4;c++){const cl=[[r,c],[r-1,c+1],[r-2,c+2],[r-3,c+3]];if(chk(cl))return cl;}
  for(let r=0;r<=ROWS-4;r++)for(let c=0;c<=COLS-4;c++){const cl=[[r,c],[r+1,c+1],[r+2,c+2],[r+3,c+3]];if(chk(cl))return cl;}
  return[];
}
function isFull(board){return board[0].every(c=>c!==null);}
function scoreW(w,p){const o=p===1?2:1,m=w.filter(c=>c===p).length,b=w.filter(c=>c===null).length,t=w.filter(c=>c===o).length;let s=0;if(m===4)s+=100;else if(m===3&&b===1)s+=5;else if(m===2&&b===2)s+=2;if(t===3&&b===1)s-=4;return s;}
function scoreB(board,p){let s=board.map(r=>r[3]).filter(c=>c===p).length*3;for(let r=0;r<ROWS;r++)for(let c=0;c<=COLS-4;c++)s+=scoreW([board[r][c],board[r][c+1],board[r][c+2],board[r][c+3]],p);for(let c=0;c<COLS;c++)for(let r=0;r<=ROWS-4;r++)s+=scoreW([board[r][c],board[r+1][c],board[r+2][c],board[r+3][c]],p);for(let r=3;r<ROWS;r++)for(let c=0;c<=COLS-4;c++)s+=scoreW([board[r][c],board[r-1][c+1],board[r-2][c+2],board[r-3][c+3]],p);for(let r=0;r<=ROWS-4;r++)for(let c=0;c<=COLS-4;c++)s+=scoreW([board[r][c],board[r+1][c+1],board[r+2][c+2],board[r+3][c+3]],p);return s;}
function validCols(board){return Array.from({length:COLS},(_,i)=>i).filter(c=>!board[0][c]);}
function minimax(board,depth,alpha,beta,maxi,aiP){
  const humP=aiP===2?1:2;
  if(checkWin(board,aiP))return{score:10000+depth};
  if(checkWin(board,humP))return{score:-10000-depth};
  const valid=validCols(board);
  if(depth===0||!valid.length)return{score:scoreB(board,aiP)};
  if(maxi){let best={score:-Infinity,col:valid[Math.floor(valid.length/2)]};for(const col of valid){const res=dropPiece(board,col,aiP);if(!res)continue;const{score}=minimax(res.board,depth-1,alpha,beta,false,aiP);if(score>best.score)best={score,col};alpha=Math.max(alpha,score);if(alpha>=beta)break;}return best;}
  else{let best={score:Infinity,col:valid[0]};for(const col of valid){const res=dropPiece(board,col,humP);if(!res)continue;const{score}=minimax(res.board,depth-1,alpha,beta,true,aiP);if(score<best.score)best={score,col};beta=Math.min(beta,score);if(alpha>=beta)break;}return best;}
}
function getAIMove(board,diff){
  const valid=validCols(board);if(!valid.length)return null;
  if(diff==="Easy")return Math.random()<.6?valid[Math.floor(Math.random()*valid.length)]:minimax(board,2,-Infinity,Infinity,true,2).col;
  if(diff==="Medium")return minimax(board,4,-Infinity,Infinity,true,2).col;
  return minimax(board,6,-Infinity,Infinity,true,2).col;
}

// --- Stats helpers ------------------------------------------------------------
const EMPTY_STATS = ()=>({wins:0,losses:0,draws:0});
const DIFFS = ["Easy","Medium","Hard"];
function loadStats(){
  try{ const s=JSON.parse(localStorage.getItem("c4space_stats")||"{}");
    return DIFFS.reduce((a,d)=>({...a,[d]:{wins:s[d]?.wins||0,losses:s[d]?.losses||0,draws:s[d]?.draws||0}}),{});
  }catch{return DIFFS.reduce((a,d)=>({...a,[d]:EMPTY_STATS()}),{});}
}
function saveStats(stats){try{localStorage.setItem("c4space_stats",JSON.stringify(stats));}catch{}}

// --- Responsive Cell Size ----------------------------------------------------
function useCellSize(){
  const calc=()=>{
    const vw=window.innerWidth, vh=window.innerHeight;
    const safeH=vh - (window.screen?.availHeight>0 ? (vh-window.screen.availHeight)*0.5 : 0);
    const hCell=Math.floor((safeH - 220)/(ROWS+1.4));
    const wCell=Math.floor((vw*0.97)/COLS);
    return Math.min(Math.max(Math.min(hCell,wCell),30),72);
  };
  const[cell,setCell]=useState(calc);
  useEffect(()=>{
    const onResize=()=>setCell(calc());
    window.addEventListener("resize",onResize);
    window.addEventListener("orientationchange",()=>setTimeout(onResize,150));
    return()=>{window.removeEventListener("resize",onResize);};
  },[]);
  return cell;
}

// --- Shooting Stars (decorative, only on result screens) ---------------------
function ShootingStars(){
  const stars=useMemo(()=>Array.from({length:7},(_,i)=>({
    top:`${8+i*12}%`, delay:`${i*0.7}s`, dur:`${1.6+i*0.3}s`,
    width:`${60+i*25}px`, opacity:0.6+i*0.05,
  })),[]);
  return(
    <div style={{position:"absolute",inset:0,pointerEvents:"none",overflow:"hidden"}}>
      {stars.map((s,i)=>(
        <div key={i} style={{position:"absolute",top:s.top,left:"-120px",width:s.width,height:"2px",
          background:"linear-gradient(90deg,transparent,rgba(255,255,255,0.9),transparent)",
          borderRadius:"1px",animation:`shootStar ${s.dur} ease-in ${s.delay} infinite`,opacity:s.opacity}}/>
      ))}
    </div>
  );
}

// --- Victory Screen -----------------------------------------------------------
function VictoryScreen({winner,mode,difficulty,p1Token,p2Token,onPlayAgain,onMenu,settings}){
  const isDraw=winner==="draw";
  const winnerName=winner===1?"PLAYER 1":"PLAYER 2";
  const tok=winner===1?p1Token:p2Token;
  const starCount=12;
  const burst=useMemo(()=>Array.from({length:starCount},(_,i)=>{
    const angle=(i/starCount)*Math.PI*2;
    const dist=80+Math.random()*60;
    return{x:50+Math.cos(angle)*dist*0.6,y:50+Math.sin(angle)*dist*0.6,
      r:2+Math.random()*3,del:`${Math.random()*0.4}s`,col:["#f9a8d4","#c084fc","#60a5fa","#fbbf24","#34d399"][i%5]};
  }),[]);

  return(
    <div style={{position:"fixed",inset:0,zIndex:150,display:"flex",alignItems:"center",justifyContent:"center",
      background:"rgba(0,0,12,0.88)",backdropFilter:"blur(14px)",padding:"16px"}}>
      <ShootingStars/>
      <div style={{position:"relative",textAlign:"center",animation:"slideUp 0.7s cubic-bezier(.16,1,.3,1)",
        display:"flex",flexDirection:"column",alignItems:"center",gap:"clamp(10px,2.5vh,22px)",
        maxWidth:"min(92vw,520px)",width:"100%"}}>

        {/* Particle burst (CSS only, drawn as SVG dots) */}
        {!isDraw&&(
          <svg style={{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",
            width:"320px",height:"320px",pointerEvents:"none",overflow:"visible"}} viewBox="0 0 100 100">
            {burst.map((b,i)=>(
              <circle key={i} cx={b.x} cy={b.y} r={b.r} fill={b.col}
                style={{animation:`burstFade 1.4s ease-out ${b.del} infinite`,opacity:0}}/>
            ))}
          </svg>
        )}

        {/* Big planet token */}
        {!isDraw&&(
          <div style={{animation:"victoryBounce 0.9s cubic-bezier(.36,.07,.19,.97) forwards",
            filter:`drop-shadow(0 0 28px ${CELESTIAL[tok]?.color||"#a78bfa"}) drop-shadow(0 0 8px ${CELESTIAL[tok]?.color||"#a78bfa"})`}}>
            <PlanetToken type={tok} size={Math.min(90,window.innerWidth*0.22)} glow={true}/>
          </div>
        )}
        {isDraw&&(
          <div style={{fontSize:"clamp(52px,12vw,90px)",lineHeight:1,filter:"drop-shadow(0 0 20px rgba(148,163,184,0.6))"}}>
            &#9884;
          </div>
        )}

        {/* Title */}
        <div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:6}}>
          {!isDraw&&(
            <div style={{fontFamily:"'Orbitron'",fontWeight:900,
              fontSize:"clamp(13px,3.5vw,22px)",letterSpacing:"clamp(2px,1vw,6px)",
              color:"#c084fc",textShadow:"0 0 20px #c084fc",animation:"shimmer 3s linear infinite",
              background:"linear-gradient(135deg,#e0c7ff,#c084fc,#93c5fd,#e0c7ff)",
              backgroundSize:"200% auto",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}>
              {winnerName}
            </div>
          )}
          <div style={{fontFamily:"'Orbitron'",fontWeight:900,
            fontSize:"clamp(22px,6vw,52px)",letterSpacing:"clamp(1px,0.5vw,3px)",
            color:isDraw?"#94a3b8":"#fff",
            textShadow:isDraw?"0 0 18px rgba(148,163,184,0.7)":"0 0 28px rgba(192,132,252,0.9), 0 0 60px rgba(147,197,253,0.4)",
            lineHeight:1.1,
            animation:isDraw?"none":"winPulse 2s ease-in-out infinite"}}>
            {isDraw?"NO CONQUERORS":"CONQUERS"}
          </div>
          <div style={{fontFamily:"'Orbitron'",fontWeight:700,
            fontSize:"clamp(16px,4.5vw,36px)",letterSpacing:"clamp(2px,1vw,8px)",
            color:isDraw?"#64748b":"#60a5fa",
            textShadow:isDraw?"none":"0 0 16px #60a5fa"}}>
            {isDraw?"TODAY":"SPACE"}
          </div>
          {mode==="1P"&&!isDraw&&(
            <div style={{fontFamily:"'Exo 2'",fontSize:"clamp(9px,2vw,13px)",
              color:"rgba(167,139,250,0.7)",letterSpacing:2,marginTop:4}}>
              {difficulty.toUpperCase()} DIFFICULTY
            </div>
          )}
        </div>

        {/* Action buttons */}
        <div style={{display:"flex",gap:"clamp(8px,2vw,16px)",flexWrap:"wrap",justifyContent:"center",marginTop:4}}>
          <button onClick={onPlayAgain} style={{
            background:"linear-gradient(135deg,#7c3aed,#4c1d95)",border:"none",borderRadius:12,
            padding:"clamp(8px,1.5vh,12px) clamp(18px,4vw,28px)",color:"#fff",
            fontFamily:"'Orbitron'",fontSize:"clamp(10px,2.5vw,13px)",fontWeight:700,letterSpacing:2,
            cursor:"pointer",boxShadow:"0 4px 20px rgba(124,58,237,0.5)",
            touchAction:"manipulation",WebkitTapHighlightColor:"transparent"}}>
            PLAY AGAIN
          </button>
          <button onClick={onMenu} style={{
            background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.2)",borderRadius:12,
            padding:"clamp(8px,1.5vh,12px) clamp(18px,4vw,28px)",color:"#cbd5e1",
            fontFamily:"'Orbitron'",fontSize:"clamp(10px,2.5vw,13px)",fontWeight:700,letterSpacing:2,
            cursor:"pointer",touchAction:"manipulation",WebkitTapHighlightColor:"transparent"}}>
            MENU
          </button>
        </div>
      </div>
    </div>
  );
}

// --- Stats Screen -------------------------------------------------------------
function StatsScreen({stats,onClose,onResetStats}){
  const cols={Easy:{label:"Easy",c1:"#34d399",c2:"rgba(6,95,70,0.4)"},Medium:{label:"Medium",c1:"#fbbf24",c2:"rgba(120,53,15,0.4)"},Hard:{label:"Hard",c1:"#f87171",c2:"rgba(127,29,29,0.4)"}};
  return(
    <div style={{position:"fixed",inset:0,zIndex:200,background:"rgba(0,0,8,.92)",backdropFilter:"blur(14px)",
      display:"flex",alignItems:"center",justifyContent:"center",padding:"clamp(8px,3vw,20px)"}}>
      <div style={{background:"linear-gradient(158deg,#080618 0%,#120830 100%)",border:"1px solid rgba(160,130,250,.25)",
        borderRadius:20,padding:"clamp(16px,4vw,28px)",width:"min(96vw,480px)",maxHeight:"90vh",overflowY:"auto",
        boxShadow:"0 0 60px rgba(110,50,200,.28)"}}>
        <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:20}}>
          <h2 style={{fontFamily:"'Orbitron'",color:"#e0d0ff",fontSize:"clamp(14px,4vw,20px)",fontWeight:700,letterSpacing:3,margin:0}}>1P STATISTICS</h2>
          <button onClick={onClose} style={{background:"rgba(255,255,255,.08)",border:"1px solid rgba(255,255,255,.14)",
            borderRadius:8,padding:"5px 12px",color:"#9ca3af",fontFamily:"'Orbitron'",fontSize:10,letterSpacing:2,cursor:"pointer",
            touchAction:"manipulation"}}>CLOSE</button>
        </div>

        {DIFFS.map(d=>{
          const st=stats[d];
          const total=st.wins+st.losses+st.draws;
          const pct=total>0?Math.round((st.wins/total)*100):0;
          const col=cols[d];
          return(
            <div key={d} style={{background:col.c2,border:`1px solid ${col.c1}33`,borderRadius:14,
              padding:"clamp(10px,3vw,16px)",marginBottom:12}}>
              <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}}>
                <span style={{fontFamily:"'Orbitron'",color:col.c1,fontSize:"clamp(11px,3vw,14px)",fontWeight:700,letterSpacing:2}}>{d.toUpperCase()}</span>
                <span style={{fontFamily:"'Orbitron'",color:"rgba(255,255,255,0.5)",fontSize:"clamp(9px,2vw,11px)"}}>
                  {total} {total===1?"GAME":"GAMES"}
                </span>
              </div>
              <div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:"clamp(4px,2vw,10px)",marginBottom:total>0?10:0}}>
                {[["WINS",st.wins,"#34d399"],["LOSSES",st.losses,"#f87171"],["DRAWS",st.draws,"#94a3b8"]].map(([lbl,val,c])=>(
                  <div key={lbl} style={{background:"rgba(0,0,0,0.3)",borderRadius:10,padding:"clamp(6px,2vw,10px) 4px",textAlign:"center"}}>
                    <div style={{fontFamily:"'Orbitron'",color:c,fontSize:"clamp(18px,5vw,26px)",fontWeight:900,lineHeight:1}}>{val}</div>
                    <div style={{fontFamily:"'Exo 2'",color:"rgba(200,200,220,0.55)",fontSize:"clamp(7px,1.8vw,10px)",letterSpacing:1,marginTop:3}}>{lbl}</div>
                  </div>
                ))}
              </div>
              {total>0&&(
                <div>
                  <div style={{display:"flex",justifyContent:"space-between",marginBottom:4}}>
                    <span style={{fontFamily:"'Exo 2'",color:"rgba(200,200,220,0.5)",fontSize:"clamp(8px,2vw,10px)",letterSpacing:1}}>WIN RATE</span>
                    <span style={{fontFamily:"'Orbitron'",color:col.c1,fontSize:"clamp(9px,2vw,11px)",fontWeight:700}}>{pct}%</span>
                  </div>
                  <div style={{height:6,background:"rgba(0,0,0,0.4)",borderRadius:3,overflow:"hidden"}}>
                    <div style={{height:"100%",width:`${pct}%`,background:`linear-gradient(90deg,${col.c1}88,${col.c1})`,
                      borderRadius:3,transition:"width 0.8s ease",minWidth:pct>0?4:0}}/>
                  </div>
                </div>
              )}
              {total===0&&(
                <div style={{textAlign:"center",color:"rgba(255,255,255,0.2)",fontFamily:"'Exo 2'",fontSize:"clamp(9px,2vw,11px)",letterSpacing:1,paddingTop:2}}>
                  NO GAMES YET
                </div>
              )}
            </div>
          );
        })}

        <button onClick={onResetStats} style={{width:"100%",marginTop:8,background:"rgba(239,68,68,0.12)",
          border:"1px solid rgba(239,68,68,0.3)",borderRadius:10,padding:"clamp(7px,1.5vh,10px)",
          color:"rgba(239,68,68,0.7)",fontFamily:"'Orbitron'",fontSize:"clamp(9px,2vw,11px)",letterSpacing:2,
          cursor:"pointer",touchAction:"manipulation"}}>
          RESET ALL STATS
        </button>
      </div>
    </div>
  );
}

// --- Main App ----------------------------------------------------------------
export default function Connect4Space(){
  const[screen,setScreen]=useState("home");
  const[mode,setMode]=useState(null);
  const[difficulty,setDiff]=useState("Medium");
  const[board,setBoard]=useState(emptyBoard());
  const[curP,setCurP]=useState(1);
  const[winner,setWinner]=useState(null);
  const[winCells,setWinCells]=useState([]);
  const[hoverCol,setHoverCol]=useState(null);
  const[p2Think,setP2Think]=useState(false);
  const[dropAnim,setDropAnim]=useState(null);
  const[settingsOpen,setSettingsOpen]=useState(false);
  const[statsOpen,setStatsOpen]=useState(false);
  const[showVictory,setShowVictory]=useState(false);
  const[pending,setPending]=useState(null);
  const[settings,setSettings]=useState({musicVol:60,sfxVol:80,p1Token:"Earth",p2Token:"Mars",background:"Galaxy",grid:"Nebula"});
  const[stats,setStats]=useState(loadStats);
  const lastHoverCol=useRef(null);
  const statsRecorded=useRef(false);
  const[splashDone,setSplashDone]=useState(false);

  // Splash dismiss: unlock audio immediately on first touch/click
  const dismissSplash=useCallback(()=>{
    if(splashDone)return;
    setSplashDone(true);
    audio.unlock(); // starts home music right now, inside a real user gesture
  },[splashDone]);

  // Apply SFX volume live; music only on save
  useEffect(()=>{ audio.setSfxVol(settings.sfxVol/100); },[settings.sfxVol]);
  useEffect(()=>{ audio.setMusicVol(settings.musicVol/100); },[settings.musicVol]);

  // Music by screen (also starts music after splash unlocks audio)
  useEffect(()=>{
    if(screen==="home"||screen==="mode"||screen==="difficulty"){ audio.playHomeMusic(); }
    else if(screen==="game"){ audio.playGameMusic(); }
  },[screen]);

  const cellSize=useCellSize();
  const tokenSize=Math.max(cellSize-10,22);
  const S=settingsOpen?pending:settings;
  const grid=GRIDS[S.grid];
  const isStarGrid=grid.type==="stars";

  const openSettings=()=>{audio.playClick();setPending({...settings});setSettingsOpen(true);};
  const cancelSettings=()=>{
    audio.playClick();
    // Restore volumes to saved settings on cancel
    audio.setMusicVol(settings.musicVol/100);
    audio.setSfxVol(settings.sfxVol/100);
    setSettingsOpen(false);setPending(null);
  };
  const saveSettings=()=>{
    audio.playClick();
    // Apply both volumes on save
    audio.setMusicVol(pending.musicVol/100);
    audio.setSfxVol(pending.sfxVol/100);
    setSettings({...pending});setSettingsOpen(false);setPending(null);
  };

  useEffect(()=>{
    if(screen!=="game"||mode!=="1P"||curP!==2||winner)return;
    setP2Think(true);
    const t=setTimeout(()=>{
      const col=getAIMove(board,difficulty);
      if(col!=null)handleDrop(col,true);
      setP2Think(false);
    },650);
    return()=>clearTimeout(t);
  },[curP,screen,mode,winner]);

  const handleDrop=useCallback((col,isAI=false)=>{
    if(winner||(p2Think&&!isAI))return;
    const res=dropPiece(board,col,curP);if(!res)return;
    audio.playDrop();
    setDropAnim({row:res.row,col});setTimeout(()=>setDropAnim(null),400);
    setBoard(res.board);
    if(checkWin(res.board,curP)){
      setWinner(curP);setWinCells(getWinCells(res.board,curP));
      setTimeout(()=>{audio.playWin();setShowVictory(true);},420);
    } else if(isFull(res.board)){
      setWinner("draw");
      setTimeout(()=>{audio.playDraw();setShowVictory(true);},420);
    } else setCurP(p=>p===1?2:1);
  },[board,curP,winner,p2Think]);

  // Record 1P stats when victory screen first shows
  useEffect(()=>{
    if(!showVictory||mode!=="1P"||statsRecorded.current)return;
    statsRecorded.current=true;
    setStats(prev=>{
      const next={...prev,[difficulty]:{...prev[difficulty]}};
      if(winner===1)next[difficulty].wins++;
      else if(winner===2)next[difficulty].losses++;
      else next[difficulty].draws++;
      saveStats(next);
      return next;
    });
  },[showVictory]);

  const handleHover=(col)=>{
    if(!canAct)return;
    if(col!==lastHoverCol.current){ audio.playHover(); lastHoverCol.current=col; }
    setHoverCol(col);
  };

  const startGame=(m,diff)=>{
    audio.playClick();setMode(m);if(diff)setDiff(diff);
    setBoard(emptyBoard());setCurP(1);setWinner(null);setWinCells([]);
    setShowVictory(false);statsRecorded.current=false;setScreen("game");
  };
  const resetGame=()=>{
    audio.playClick();setBoard(emptyBoard());setCurP(1);setWinner(null);setWinCells([]);
    setShowVictory(false);statsRecorded.current=false;
  };
  const isWC=(r,c)=>winCells.some(([wr,wc])=>wr===r&&wc===c);
  const canAct=!winner&&!(mode==="1P"&&curP===2);

  const p1Color="#c084fc";
  const p2Color="#38bdf8";
  const p1Bg="rgba(88,28,135,0.55)";
  const p2Bg="rgba(7,89,133,0.55)";

  // Touch handling for board cells
  const handleTouch=(col)=>{ if(canAct){ audio.playDrop(); handleDrop(col); } };

  return(
    <div style={{width:"100dvw",height:"100dvh",position:"relative",overflow:"hidden",display:"flex",
      flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"'Exo 2',sans-serif",
      WebkitUserSelect:"none",userSelect:"none"}}>
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap');
        *{box-sizing:border-box;margin:0;padding:0;}
        html,body{overflow:hidden;touch-action:none;-webkit-tap-highlight-color:transparent;}
        @keyframes twinkle{from{opacity:.18}to{opacity:1}}
        @keyframes dropIn{from{transform:translateY(-60px);opacity:0}to{transform:translateY(0);opacity:1}}
        @keyframes winPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}
        @keyframes slideUp{from{transform:translateY(32px);opacity:0}to{transform:translateY(0);opacity:1}}
        @keyframes shimmer{0%{background-position:-200% center}100%{background-position:200% center}}
        @keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
        @keyframes glowP{0%,100%{opacity:.42}50%{opacity:1}}
        @keyframes shootStar{0%{left:-20%;opacity:0}10%{opacity:1}80%{opacity:0.6}100%{left:110%;opacity:0}}
        @keyframes burstFade{0%{opacity:0;transform:scale(0)}30%{opacity:1}100%{opacity:0;transform:scale(1.5)}}
        @keyframes victoryBounce{0%{transform:scale(0) rotate(-15deg);opacity:0}60%{transform:scale(1.18) rotate(4deg);opacity:1}80%{transform:scale(0.94) rotate(-2deg)}100%{transform:scale(1) rotate(0deg);opacity:1}}
        @keyframes splashOrbit{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
        @keyframes splashRipple{0%{transform:scale(0.6);opacity:1}100%{transform:scale(2.2);opacity:0}}
        button{cursor:pointer;font-family:'Exo 2',sans-serif;touch-action:manipulation;-webkit-tap-highlight-color:transparent;}
        ::-webkit-scrollbar{display:none;}
        input[type=range]{-webkit-appearance:none;width:100%;height:6px;border-radius:3px;background:rgba(255,255,255,0.15);outline:none;touch-action:manipulation;}
        input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:22px;height:22px;border-radius:50%;background:#a78bfa;cursor:pointer;border:2px solid rgba(255,255,255,0.4);box-shadow:0 0 6px rgba(167,139,250,0.7);}
        input[type=range]::-moz-range-thumb{width:22px;height:22px;border-radius:50%;background:#a78bfa;cursor:pointer;border:2px solid rgba(255,255,255,0.4);}
        @media(max-width:400px){.board-cell{cursor:default!important;}}
      `}</style>

      <SpaceBackground bgKey={S.background}/>

      {/* SPLASH INTRO - beautiful cinematic opening that also unlocks Web Audio */}
      {!splashDone&&(
        <div
          onClick={dismissSplash}
          onTouchStart={(e)=>{e.preventDefault();dismissSplash();}}
          style={{position:"fixed",inset:0,zIndex:9999,display:"flex",flexDirection:"column",
            alignItems:"center",justifyContent:"center",cursor:"pointer",
            background:"radial-gradient(ellipse at 50% 60%, rgba(60,20,120,0.55) 0%, rgba(0,0,12,0.96) 70%)",
            WebkitTapHighlightColor:"transparent",touchAction:"manipulation",userSelect:"none"}}>

          {/* Orbiting planet ring */}
          <div style={{position:"absolute",width:"min(72vw,420px)",height:"min(72vw,420px)",
            animation:"splashOrbit 18s linear infinite",pointerEvents:"none"}}>
            {[
              {tok:"Saturn", angle:0},   {tok:"Earth",   angle:60},
              {tok:"Mars",   angle:120},  {tok:"Jupiter", angle:180},
              {tok:"Moon",   angle:240},  {tok:"Sun",     angle:300},
            ].map(({tok,angle})=>{
              const rad=(angle)*Math.PI/180;
              const r=48; // % from center
              const x=50+r*Math.cos(rad);
              const y=50+r*Math.sin(rad);
              return(
                <div key={tok} style={{position:"absolute",
                  left:`${x}%`,top:`${y}%`,transform:"translate(-50%,-50%)",
                  filter:`drop-shadow(0 0 8px ${CELESTIAL[tok]?.color||"#fff"})`,
                  animation:`glowP ${2+angle/60*0.3}s ease-in-out ${angle/360}s infinite`}}>
                  <PlanetToken type={tok} size={Math.min(36,window.innerWidth*0.08)} glow={true}/>
                </div>
              );
            })}
          </div>

          {/* Central content */}
          <div style={{textAlign:"center",position:"relative",zIndex:2,
            padding:"0 clamp(16px,6vw,40px)",animation:"slideUp .9s cubic-bezier(.16,1,.3,1)"}}>

            {/* Title */}
            <div style={{fontFamily:"'Orbitron'",fontWeight:900,
              fontSize:"clamp(32px,9vw,76px)",letterSpacing:"clamp(2px,1.5vw,8px)",
              background:"linear-gradient(135deg,#fff 0%,#c4b5fd 35%,#93c5fd 65%,#fff 100%)",
              backgroundSize:"200% auto",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",
              animation:"shimmer 3.5s linear infinite",lineHeight:1,marginBottom:4}}>
              CONNECT 4
            </div>
            <div style={{fontFamily:"'Orbitron'",color:"#a78bfa",
              letterSpacing:"clamp(8px,4vw,20px)",fontSize:"clamp(13px,3.5vw,24px)",
              fontWeight:400,marginBottom:"clamp(28px,6vh,52px)",
              textShadow:"0 0 20px rgba(167,139,250,0.6)"}}>
              SPACE
            </div>

            {/* Pulsing tap prompt */}
            <div style={{display:"inline-flex",flexDirection:"column",alignItems:"center",gap:12}}>
              {/* Ripple rings */}
              <div style={{position:"relative",width:64,height:64,display:"flex",
                alignItems:"center",justifyContent:"center"}}>
                <div style={{position:"absolute",width:"100%",height:"100%",borderRadius:"50%",
                  border:"2px solid rgba(167,139,250,0.6)",animation:"splashRipple 2s ease-out infinite"}}/>
                <div style={{position:"absolute",width:"100%",height:"100%",borderRadius:"50%",
                  border:"2px solid rgba(167,139,250,0.4)",animation:"splashRipple 2s ease-out .6s infinite"}}/>
                <div style={{position:"absolute",width:"100%",height:"100%",borderRadius:"50%",
                  border:"2px solid rgba(167,139,250,0.2)",animation:"splashRipple 2s ease-out 1.2s infinite"}}/>
                <div style={{width:32,height:32,borderRadius:"50%",
                  background:"radial-gradient(circle, rgba(192,132,252,0.9), rgba(124,58,237,0.7))",
                  boxShadow:"0 0 20px rgba(167,139,250,0.8)",
                  animation:"glowP 1.2s ease-in-out infinite"}}/>
              </div>
              <div style={{fontFamily:"'Orbitron'",color:"rgba(255,255,255,0.7)",
                fontSize:"clamp(10px,2.5vw,14px)",letterSpacing:"clamp(3px,1.5vw,7px)",fontWeight:600,
                animation:"glowP 1.4s ease-in-out infinite"}}>
                TAP TO LAUNCH
              </div>
            </div>
          </div>
        </div>
      )}

      {/* HOME */}
      {screen==="home"&&(
        <div style={{textAlign:"center",animation:"slideUp .6s ease-out",position:"relative",zIndex:10,padding:"0 clamp(10px,4vw,24px)"}}>
          <div style={{display:"flex",justifyContent:"center",gap:"clamp(6px,2vw,14px)",marginBottom:"clamp(10px,2vh,20px)"}}>
            {["Sun","Earth","Saturn","Moon","Jupiter"].map((p,i)=>(
              <div key={p} style={{animation:`glowP ${1.8+i*.25}s ease-in-out ${i*.15}s infinite`}}>
                <PlanetToken type={p} size={Math.min(44,Math.floor(cellSize*.85))}/>
              </div>
            ))}
          </div>
          <h1 style={{fontFamily:"'Orbitron'",fontWeight:900,fontSize:"clamp(28px,7vw,70px)",letterSpacing:"clamp(2px,1vw,6px)",
            margin:0,background:"linear-gradient(135deg,#fff 0%,#c4b5fd 35%,#93c5fd 65%,#fff 100%)",
            backgroundSize:"200% auto",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",
            animation:"shimmer 4s linear infinite"}}>CONNECT 4</h1>
          <h2 style={{fontFamily:"'Orbitron'",color:"#c4b5fd",letterSpacing:"clamp(6px,3vw,14px)",
            fontSize:"clamp(11px,3vw,22px)",fontWeight:600,margin:"4px 0 clamp(16px,3vh,32px)",
            textShadow:"0 2px 16px rgba(0,0,0,0.95), 0 0 20px rgba(0,0,0,0.8)",
            background:"rgba(0,0,0,0.35)",borderRadius:8,padding:"2px 12px",
            display:"inline-block"}}>SPACE</h2>
          <div style={{display:"flex",flexDirection:"column",gap:"clamp(8px,1.5vh,14px)",alignItems:"center"}}>
            <button onClick={()=>{audio.playClick();setScreen("mode");}} style={btnSty("#7c3aed","#4c1d95")}>PLAY</button>
            <div style={{display:"flex",gap:"clamp(6px,2vw,12px)"}}>
              <button onClick={openSettings} style={bkSty}>SETTINGS</button>
              <button onClick={()=>{audio.playClick();setStatsOpen(true);}} style={bkSty}>STATS</button>
            </div>
          </div>
        </div>
      )}

      {/* MODE */}
      {screen==="mode"&&(
        <div style={{textAlign:"center",animation:"slideUp .5s ease-out",position:"relative",zIndex:10,padding:"0 16px"}}>
          <h2 style={hSty}>SELECT MODE</h2>
          <div style={{display:"flex",gap:"clamp(10px,3vw,20px)",marginBottom:"clamp(16px,3vh,28px)",justifyContent:"center",flexWrap:"wrap"}}>
            <ModeCard icon="1P" label="1 Player"  onClick={()=>{audio.playClick();setScreen("difficulty");}}/>
            <ModeCard icon="2P" label="2 Players" onClick={()=>startGame("2P",null)}/>
          </div>
          <button onClick={()=>{audio.playClick();setScreen("home");}} style={bkSty}>BACK</button>
        </div>
      )}

      {/* DIFFICULTY */}
      {screen==="difficulty"&&(
        <div style={{textAlign:"center",animation:"slideUp .5s ease-out",position:"relative",zIndex:10,padding:"0 16px"}}>
          <h2 style={hSty}>DIFFICULTY</h2>
          <div style={{display:"flex",gap:"clamp(8px,2vw,16px)",marginBottom:"clamp(16px,3vh,28px)",flexWrap:"wrap",justifyContent:"center"}}>
            {["Easy","Medium","Hard"].map(d=>(
              <button key={d} onClick={()=>startGame("1P",d)}
                style={{...btnSty(d==="Easy"?"#065f46":d==="Medium"?"#92400e":"#7f1d1d",
                  d==="Easy"?"#022c22":d==="Medium"?"#451a03":"#3b0000"),
                  minWidth:"clamp(80px,22vw,120px)",fontSize:"clamp(10px,2.5vw,14px)"}}>
                {d.toUpperCase()}
              </button>
            ))}
          </div>
          <button onClick={()=>{audio.playClick();setScreen("mode");}} style={bkSty}>BACK</button>
        </div>
      )}

      {/* GAME */}
      {screen==="game"&&(
        <div style={{display:"flex",flexDirection:"column",alignItems:"center",position:"relative",zIndex:10,
          width:"100%",gap:Math.max(3,cellSize*.08),padding:"clamp(2px,1vh,6px) clamp(4px,2vw,10px)"}}>

          {/* Top bar */}
          <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",
            maxWidth:cellSize*COLS+32,gap:4}}>
            <button onClick={()=>{audio.playClick();setScreen("home");}} style={bkSty}>MENU</button>
            <span style={{fontFamily:"'Orbitron'",fontSize:"clamp(8px,2vw,11px)",color:"#a78bfa",letterSpacing:2}}>
              {mode==="1P"?difficulty.toUpperCase():"2 PLAYER"}
            </span>
            <button onClick={resetGame} style={bkSty}>RESET</button>
          </div>

          {/* Player indicators */}
          <div style={{display:"flex",gap:"clamp(6px,2vw,12px)",alignItems:"center",
            background:"rgba(2,2,16,0.88)",backdropFilter:"blur(12px)",
            borderRadius:40,padding:"clamp(3px,0.8vh,6px) clamp(8px,2vw,14px)",
            border:"1px solid rgba(255,255,255,0.22)",
            boxShadow:"0 2px 16px rgba(0,0,0,0.7)"}}>
            {[1,2].map(p=>{
              const tok=p===1?S.p1Token:S.p2Token;
              const active=curP===p&&!winner;
              const col=p===1?p1Color:p2Color;
              const bg=p===1?p1Bg:p2Bg;
              return(
                <div key={p} style={{display:"flex",alignItems:"center",gap:"clamp(4px,1.2vw,8px)",
                  padding:"clamp(3px,0.8vh,5px) clamp(8px,2vw,14px) clamp(3px,0.8vh,5px) clamp(5px,1.5vw,9px)",
                  borderRadius:28,background:active?bg:"rgba(255,255,255,0.04)",
                  border:`2px solid ${active?col:"rgba(255,255,255,0.12)"}`,transition:"all .3s",
                  boxShadow:active?`0 0 14px ${col}88,inset 0 0 8px rgba(0,0,0,0.3)`:"none"}}>
                  <PlanetToken type={tok} size={Math.min(28,Math.floor(cellSize*.5))} glow={active}/>
                  <div style={{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:1}}>
                    <span style={{color:active?col:"rgba(200,200,220,0.7)",fontFamily:"'Orbitron'",
                      fontSize:"clamp(9px,2.2vw,13px)",fontWeight:700,letterSpacing:1,
                      textShadow:active?`0 0 8px ${col}`:"none",transition:"all .3s"}}>P{p}</span>
                    <span style={{color:active?col:"rgba(140,140,160,0.6)",fontSize:"clamp(7px,1.6vw,10px)",
                      fontFamily:"'Exo 2'",fontWeight:600,letterSpacing:.5,
                      textShadow:active?`0 0 6px ${col}`:"none",transition:"all .3s"}}>
                      {active?"TURN":"WAIT"}
                    </span>
                  </div>
                  {active&&!winner&&<span style={{color:col,fontSize:"clamp(6px,1.5vw,9px)",marginLeft:2,animation:"glowP 0.8s ease-in-out infinite"}}>&#9654;</span>}
                </div>
              );
            })}
          </div>

          {/* P2 thinking */}
          <div style={{minHeight:"clamp(18px,3vh,28px)",display:"flex",alignItems:"center",justifyContent:"center"}}>
            {p2Think&&!winner&&(
              <span style={{color:"#a78bfa",fontFamily:"'Orbitron'",fontSize:"clamp(8px,2vw,11px)",letterSpacing:2,
                background:"rgba(0,0,12,0.6)",padding:"3px 10px",borderRadius:8}}>
                <span style={{display:"inline-block",animation:"spin 1s linear infinite",marginRight:5}}>*</span>
                P2 THINKING...
              </span>
            )}
          </div>

          {/* Board */}
          <div style={{background:isStarGrid?"rgba(2,2,14,.92)":grid.color,
            border:isStarGrid?"2px solid rgba(255,255,255,.15)":`2px solid ${grid.border}`,
            borderRadius:16,padding:`${Math.max(3,Math.floor(cellSize*.07))}px`,
            boxShadow:isStarGrid?"0 0 40px rgba(255,255,255,.05),inset 0 0 24px rgba(0,0,20,.6)":`0 0 32px ${grid.border}55,inset 0 0 18px rgba(0,0,0,.4)`,
            backdropFilter:"blur(6px)",position:"relative"}}>
            {isStarGrid&&(
              <div style={{position:"absolute",inset:0,borderRadius:14,overflow:"hidden",pointerEvents:"none"}}>
                <svg style={{width:"100%",height:"100%"}}>
                  {BOARD_BG_STARS.map((s,i)=>(
                    <circle key={i} cx={`${s.x}%`} cy={`${s.y}%`} r={s.r} fill="white" opacity={s.op}
                      style={{animation:`twinkle ${s.tw}s ease-in-out ${s.dl}s infinite alternate`}}/>
                  ))}
                </svg>
              </div>
            )}
            {/* Hover row */}
            <div style={{display:"flex",marginBottom:2}}>
              {Array(COLS).fill(null).map((_,c)=>(
                <div key={c} style={{width:cellSize,height:Math.floor(cellSize*.36),display:"flex",justifyContent:"center",alignItems:"center"}}>
                  {hoverCol===c&&canAct&&<PlanetToken type={curP===1?S.p1Token:S.p2Token} size={Math.floor(tokenSize*.52)}/>}
                </div>
              ))}
            </div>
            {/* Cells */}
            {board.map((row,r)=>(
              <div key={r} style={{display:"flex"}}>
                {row.map((cell,c)=>{
                  const isWin=isWC(r,c);
                  const isDrop=dropAnim?.row===r&&dropAnim?.col===c;
                  const tok=cell===1?S.p1Token:S.p2Token;
                  return(
                    <div key={c} className="board-cell"
                      onMouseEnter={()=>handleHover(c)}
                      onMouseLeave={()=>{setHoverCol(null);lastHoverCol.current=null;}}
                      onClick={()=>canAct&&handleDrop(c)}
                      onTouchEnd={(e)=>{e.preventDefault();handleTouch(c);}}
                      style={{width:cellSize,height:cellSize,display:"flex",alignItems:"center",
                        justifyContent:"center",cursor:canAct?"pointer":"default",touchAction:"manipulation"}}>
                      <div style={{width:tokenSize,height:tokenSize,borderRadius:"50%",
                        background:cell?"transparent":isStarGrid?"rgba(0,0,10,.72)":"rgba(0,0,0,.62)",
                        border:isStarGrid?"none":`1px solid ${grid.border}44`,
                        display:"flex",alignItems:"center",justifyContent:"center",
                        position:"relative",overflow:isStarGrid&&!cell?"hidden":"visible",
                        transition:"background .2s",
                        animation:isWin?"winPulse .55s ease-in-out infinite":isDrop?"dropIn .35s ease-out":"none",
                        boxShadow:isWin?`0 0 22px ${CELESTIAL[tok]?.color},0 0 8px ${CELESTIAL[tok]?.color}`:"none"}}>
                        {isStarGrid&&!cell&&<StarCell size={tokenSize} seed={r*COLS+c}/>}
                        {cell&&<PlanetToken type={tok} size={tokenSize} glow={isWin}/>}
                      </div>
                    </div>
                  );
                })}
              </div>
            ))}
          </div>
          <button onClick={openSettings} style={bkSty}>SETTINGS</button>
        </div>
      )}

      {/* VICTORY / DRAW OVERLAY */}
      {showVictory&&(
        <VictoryScreen
          winner={winner} mode={mode} difficulty={difficulty}
          p1Token={settings.p1Token} p2Token={settings.p2Token}
          onPlayAgain={()=>{setShowVictory(false);resetGame();}}
          onMenu={()=>{setShowVictory(false);audio.playHomeMusic();setScreen("home");}}
          settings={settings}
        />
      )}

      {/* SETTINGS MODAL */}
      {settingsOpen&&pending&&(
        <div style={{position:"fixed",inset:0,zIndex:200,background:"rgba(0,0,8,.9)",backdropFilter:"blur(12px)",
          display:"flex",alignItems:"center",justifyContent:"center",padding:"clamp(8px,3vw,16px)"}}>
          <div style={{background:"linear-gradient(158deg,#0c0820 0%,#160a34 100%)",
            border:"1px solid rgba(160,130,250,.22)",borderRadius:20,
            padding:"clamp(14px,3vw,22px) clamp(14px,3vw,22px) clamp(16px,3vh,26px)",
            width:"min(98vw,500px)",maxHeight:"92vh",overflowY:"auto",
            boxShadow:"0 0 60px rgba(110,50,200,.22)"}}>
            <h2 style={{...hSty,marginTop:0,fontSize:"clamp(13px,3.5vw,18px)"}}>SETTINGS</h2>
            <Sec label="AUDIO">
              <Sli label="Music" value={pending.musicVol}
                onChange={v=>setPending(p=>({...p,musicVol:v}))}
                muted={pending.musicVol===0}/>
              <Sli label="Sounds" value={pending.sfxVol}
                onChange={v=>setPending(p=>({...p,sfxVol:v}))}
                muted={pending.sfxVol===0}/>
            </Sec>
            <Sec label="BACKGROUND">
              <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
                {BG_KEYS.map(k=>(
                  <button key={k} onClick={()=>setPending(p=>({...p,background:k}))} style={optSty(pending.background===k)}>
                    {k}
                  </button>
                ))}
              </div>
            </Sec>
            <Sec label="GRID">
              <div style={{display:"flex",gap:8,flexWrap:"wrap"}}>
                {GRID_KEYS.map(k=>(
                  <button key={k} onClick={()=>setPending(p=>({...p,grid:k}))}
                    style={{...optSty(pending.grid===k),borderColor:GRIDS[k].type==="stars"?"rgba(255,255,255,.55)":GRIDS[k].border}}>
                    {k}
                  </button>
                ))}
              </div>
            </Sec>
            <Sec label="PLAYER 1 TOKEN">
              <TokPick selected={pending.p1Token} blocked={pending.p2Token} onSelect={t=>setPending(p=>({...p,p1Token:t}))}/>
            </Sec>
            <Sec label="PLAYER 2 TOKEN">
              <TokPick selected={pending.p2Token} blocked={pending.p1Token} onSelect={t=>setPending(p=>({...p,p2Token:t}))}/>
            </Sec>
            <div style={{display:"flex",gap:10,justifyContent:"center",marginTop:"clamp(12px,2.5vh,20px)"}}>
              <button onClick={cancelSettings} style={btnSty("rgba(255,255,255,.1)","rgba(0,0,0,.2)",true)}>CANCEL</button>
              <button onClick={saveSettings} style={btnSty("#7c3aed","#4c1d95")}>DONE</button>
            </div>
          </div>
        </div>
      )}

      {/* STATS MODAL */}
      {statsOpen&&(
        <StatsScreen
          stats={stats}
          onClose={()=>{audio.playClick();setStatsOpen(false);}}
          onResetStats={()=>{
            const fresh=DIFFS.reduce((a,d)=>({...a,[d]:EMPTY_STATS()}),{});
            setStats(fresh);saveStats(fresh);audio.playClick();
          }}
        />
      )}
    </div>
  );
}

// --- Sub-components ----------------------------------------------------------
function ModeCard({icon,label,onClick}){
  return(<button onClick={onClick} style={{background:"rgba(255,255,255,.06)",border:"1px solid rgba(160,130,250,.35)",
    borderRadius:14,padding:"clamp(12px,3vh,20px) clamp(16px,4vw,24px)",
    display:"flex",flexDirection:"column",alignItems:"center",gap:8,color:"#fff",transition:"all .25s",
    minWidth:"clamp(90px,24vw,120px)",touchAction:"manipulation"}}
    onMouseEnter={e=>{e.currentTarget.style.background="rgba(112,50,190,.22)";e.currentTarget.style.borderColor="#a78bfa";}}
    onMouseLeave={e=>{e.currentTarget.style.background="rgba(255,255,255,.06)";e.currentTarget.style.borderColor="rgba(160,130,250,.35)";}}>
    <span style={{fontSize:"clamp(18px,5vw,24px)",fontFamily:"monospace",fontWeight:700}}>{icon}</span>
    <span style={{fontFamily:"'Orbitron'",fontSize:"clamp(9px,2.2vw,12px)",letterSpacing:2}}>{label.toUpperCase()}</span>
  </button>);
}

function Sec({label,children}){
  return(
    <div style={{marginBottom:14}}>
      <div style={{color:"#a78bfa",fontFamily:"'Orbitron'",fontSize:"clamp(8px,2vw,10px)",letterSpacing:3,marginBottom:8}}>
        {label}
      </div>
      {children}
    </div>
  );
}

function Sli({label,value,onChange,muted}){
  const volIcon=value===0?"0":value<40?"L":value<75?"M":"H";
  return(
    <div style={{display:"flex",alignItems:"center",gap:10,marginBottom:12}}>
      <span style={{color:"#d1d5db",fontSize:"clamp(10px,2.5vw,12px)",width:54,fontFamily:"'Exo 2'",flexShrink:0}}>{label}</span>
      <div style={{flex:1,position:"relative"}}>
        <input type="range" min={0} max={100} value={value}
          onChange={e=>onChange(Number(e.target.value))}
          style={{accentColor:muted?"#6b7280":"#a78bfa"}}/>
      </div>
      <div style={{display:"flex",alignItems:"center",gap:5,flexShrink:0}}>
        <span style={{color:muted?"#6b7280":"#9ca3af",fontSize:"clamp(9px,2vw,11px)",width:28,textAlign:"right",fontVariantNumeric:"tabular-nums"}}>{value}%</span>
        <div style={{width:20,height:20,borderRadius:4,background:muted?"rgba(107,114,128,0.3)":"rgba(167,139,250,0.2)",
          border:`1px solid ${muted?"rgba(107,114,128,0.4)":"rgba(167,139,250,0.4)"}`,
          display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>
          <span style={{fontSize:8,fontWeight:700,color:muted?"#6b7280":"#a78bfa",fontFamily:"monospace"}}>{volIcon}</span>
        </div>
      </div>
    </div>
  );
}

function TokPick({selected,blocked,onSelect}){
  return(
    <div style={{display:"flex",flexWrap:"wrap",gap:"clamp(4px,1.5vw,8px)"}}>
      {CELESTIAL_KEYS.map(key=>{
        const isSel=selected===key,isBlk=blocked===key;
        return(
          <button key={key} onClick={()=>!isBlk&&onSelect(key)} title={key}
            style={{display:"flex",flexDirection:"column",alignItems:"center",gap:3,
              padding:"clamp(4px,1.2vw,7px) clamp(3px,1vw,5px)",borderRadius:10,
              minWidth:"clamp(44px,12vw,56px)",
              border:`1.5px solid ${isSel?CELESTIAL[key].color:"rgba(255,255,255,.1)"}`,
              background:isSel?"rgba(255,255,255,.08)":"rgba(0,0,0,.35)",
              cursor:isBlk?"not-allowed":"pointer",opacity:isBlk?.22:1,transition:"all .2s",
              boxShadow:isSel?`0 0 12px ${CELESTIAL[key].color}`:"none",
              touchAction:"manipulation"}}>
            <PlanetToken type={key} size={Math.min(38,Math.floor(window.innerWidth/8))} glow={isSel} showName={true}/>
          </button>
        );
      })}
    </div>
  );
}

const hSty={fontFamily:"'Orbitron'",color:"#e0d0ff",fontSize:"clamp(14px,4vw,20px)",fontWeight:700,letterSpacing:"clamp(2px,1vw,5px)",marginBottom:"clamp(12px,2.5vh,20px)"};
function btnSty(bg,bg2,outlined=false){return{background:outlined?bg:`linear-gradient(135deg,${bg},${bg2})`,border:outlined?"1px solid rgba(255,255,255,.17)":"none",borderRadius:10,padding:"clamp(8px,1.8vh,12px) clamp(18px,5vw,30px)",color:"#fff",fontFamily:"'Orbitron'",fontSize:"clamp(10px,2.5vw,13px)",fontWeight:700,letterSpacing:2,transition:"all .25s",boxShadow:outlined?"none":`0 4px 20px ${bg}50`,touchAction:"manipulation",WebkitTapHighlightColor:"transparent"};}
const bkSty={background:"rgba(4,4,20,0.72)",border:"1px solid rgba(255,255,255,.22)",borderRadius:8,padding:"clamp(4px,1vh,6px) clamp(10px,3vw,16px)",color:"#d1d5db",fontFamily:"'Orbitron'",fontSize:"clamp(8px,2vw,10px)",letterSpacing:2,touchAction:"manipulation",WebkitTapHighlightColor:"transparent",backdropFilter:"blur(8px)",textShadow:"0 1px 4px rgba(0,0,0,0.9)"};
function optSty(active){return{background:active?"rgba(112,50,190,.3)":"rgba(255,255,255,.05)",border:`1px solid ${active?"#a78bfa":"rgba(255,255,255,.12)"}`,borderRadius:8,padding:"clamp(4px,1vh,6px) clamp(8px,2.5vw,14px)",color:active?"#e0d0ff":"#9ca3af",fontFamily:"'Exo 2'",fontSize:"clamp(10px,2.5vw,13px)",cursor:"pointer",transition:"all .2s",touchAction:"manipulation"};}
